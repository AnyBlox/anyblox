[{"totalTime":44455,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#172 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#182,toprettystring(revenue)#183,toprettystring(o_orderdate)#184,toprettystring(o_shippriority)#185])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":15022}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14986},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14934},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13860}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":91},{"metricName":"peak memory","value":1270874112},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=1198]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2924425},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":77576394},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3187815},{"metricName":"local bytes read","value":34945755},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":68},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":93581600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2542}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2924425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1068]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":70},{"metricName":"time to build","value":142},{"metricName":"time to collect","value":25203},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=956]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":600888},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":36369418},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":9614208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":548}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":600888}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":83},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=975]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16094558},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":373569791},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14577240},{"metricName":"local bytes read","value":223228463},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":643782320},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":228337560}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4792}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16094558}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":33123552},{"metricName":"number of input batches","value":8224}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":572},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":33123552}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1023}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1962},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=1005]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":66110260},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1408455626},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":70070557},{"metricName":"local bytes read","value":954368919},{"metricName":"fetch wait time","value":6},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":697},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2115528320},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":18512}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":66110261}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":122633453},{"metricName":"number of input batches","value":30234}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5365},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":122633453}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":42970,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#272 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#282,toprettystring(revenue)#283,toprettystring(o_orderdate)#284,toprettystring(o_shippriority)#285])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14791}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14748},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14692},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13469}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":97},{"metricName":"peak memory","value":1277165568},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=2850]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2924425},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":75943482},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3333926},{"metricName":"local bytes read","value":36546709},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":68},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":93581600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2504}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2924425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2720]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":67},{"metricName":"time to build","value":146},{"metricName":"time to collect","value":24415},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2608]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":717981},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":39864691},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":11487696},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":411}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":717982}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3587891},{"metricName":"number of input batches","value":892}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":41},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3587891}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=2627]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14577240},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":362585716},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14577240},{"metricName":"local bytes read","value":223228463},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":583089600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4316}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14577240}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":462},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1148}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1950},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=2657]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":65667020},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1429517938},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":70025020},{"metricName":"local bytes read","value":998165021},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":697},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2101344672},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":17912}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":65667021}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":121813567},{"metricName":"number of input batches","value":30028}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5005},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":121813567}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":42357,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#247 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#257,toprettystring(revenue)#258,toprettystring(o_orderdate)#259,toprettystring(o_shippriority)#260])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14567}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14521},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14470},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13377}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":71},{"metricName":"peak memory","value":1126170624},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=2437]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2924425},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":77820507},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2924425},{"metricName":"local bytes read","value":32058651},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":60},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":93581600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2448}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2924425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2307]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":67},{"metricName":"time to build","value":127},{"metricName":"time to collect","value":24140},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2195]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":600888},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":41174067},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":9614208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":345}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":600888}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":14},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=2214]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":15965268},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":369930978},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14577240},{"metricName":"local bytes read","value":223228463},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":638610720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4048}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":15965269}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":32858099},{"metricName":"number of input batches","value":8158}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":463},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":32858099}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1011}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1961},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=2244]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":65327931},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1379633297},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":64688156},{"metricName":"local bytes read","value":875545516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":615},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2090493856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":17894}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":65327933}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":121184898},{"metricName":"number of input batches","value":29874}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4985},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":121184898}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":43043,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#222 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#232,toprettystring(revenue)#233,toprettystring(o_orderdate)#234,toprettystring(o_shippriority)#235])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14694}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14656},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14599},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13515}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":91},{"metricName":"peak memory","value":1201668096},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=2024]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3645223},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":80645906},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3129257},{"metricName":"local bytes read","value":34304896},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":64},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":116647136},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2548}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3645223}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1894]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":71},{"metricName":"time to build","value":164},{"metricName":"time to collect","value":24440},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=1782]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":600888},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22026926},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":9614208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":360}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":600888}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":45},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=1801]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14577240},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":352056554},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18171510},{"metricName":"local bytes read","value":293629066},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":13},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":583089600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4143}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14577240}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":479},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1012}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1948},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=1831]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":66864942},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1416519920},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":68212957},{"metricName":"local bytes read","value":936817490},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":656},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2139678144},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":18048}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":66864942}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":124029042},{"metricName":"number of input batches","value":30581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5198},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":124029042}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":43522,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#197 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#207,toprettystring(revenue)#208,toprettystring(o_orderdate)#209,toprettystring(o_shippriority)#210])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14822}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14781},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14718},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13635}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":95},{"metricName":"peak memory","value":1277165568},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=1611]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2924425},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":75814408},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3334951},{"metricName":"local bytes read","value":36559460},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":68},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":93581600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2476}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2924425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1481]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":69},{"metricName":"time to build","value":126},{"metricName":"time to collect","value":24878},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=1369]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":600888},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":40887246},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":9614208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":397}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":600888}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":49},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=1388]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14577240},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":350176579},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14577240},{"metricName":"local bytes read","value":223228463},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":583089600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4120}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14577240}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":460},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1015}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1950},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=1418]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":66059612},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1410744015},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":68709545},{"metricName":"local bytes read","value":998206722},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":697},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2113907648},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":18499}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":66059614}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":122542289},{"metricName":"number of input batches","value":30207}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5306},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":122542289}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]