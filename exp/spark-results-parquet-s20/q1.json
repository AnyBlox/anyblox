[{"totalTime":27323,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#376,toprettystring(l_linestatus)#377,toprettystring(sum_qty)#378,toprettystring(sum_base_price)#379,toprettystring(sum_disc_price)#380,toprettystring(sum_charge)#381,toprettystring(avg_qty)#382,toprettystring(avg_price)#383,toprettystring(avg_disc)#384,toprettystring(count_order)#385])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":34}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":12},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=197]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":113933245},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":26555}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":26110},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":122542716}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":124295521},{"metricName":"number of input batches","value":30638}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8341},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":124295521}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":23240,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#812,toprettystring(l_linestatus)#813,toprettystring(sum_qty)#814,toprettystring(sum_base_price)#815,toprettystring(sum_disc_price)#816,toprettystring(sum_charge)#817,toprettystring(avg_qty)#818,toprettystring(avg_price)#819,toprettystring(avg_disc)#820,toprettystring(count_order)#821])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":34}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":15},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=461]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":87475668},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":22649}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":22368},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":119001502}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":120700723},{"metricName":"number of input batches","value":29754}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6571},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":120700723}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":23656,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#703,toprettystring(l_linestatus)#704,toprettystring(sum_qty)#705,toprettystring(sum_base_price)#706,toprettystring(sum_disc_price)#707,toprettystring(sum_charge)#708,toprettystring(avg_qty)#709,toprettystring(avg_price)#710,toprettystring(avg_disc)#711,toprettystring(count_order)#712])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":24}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=395]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":101511181},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":23044}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":22725},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":124790246}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":126575805},{"metricName":"number of input batches","value":31205}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6988},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":126575805}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":23829,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#594,toprettystring(l_linestatus)#595,toprettystring(sum_qty)#596,toprettystring(sum_base_price)#597,toprettystring(sum_disc_price)#598,toprettystring(sum_charge)#599,toprettystring(avg_qty)#600,toprettystring(avg_price)#601,toprettystring(avg_disc)#602,toprettystring(count_order)#603])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":30}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=329]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":168},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":95136986},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21504},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":23064}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":23706}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":23386},{"metricName":"peak memory","value":11010048},{"metricName":"number of output rows","value":168},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":123616757}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":125382828},{"metricName":"number of input batches","value":30906}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6950},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":125382828}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":24310,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#485,toprettystring(l_linestatus)#486,toprettystring(sum_qty)#487,toprettystring(sum_base_price)#488,toprettystring(sum_disc_price)#489,toprettystring(sum_charge)#490,toprettystring(avg_qty)#491,toprettystring(avg_price)#492,toprettystring(avg_disc)#493,toprettystring(count_order)#494])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":30}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=263]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":109440247},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":23596}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":23241},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":123217286}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":124977352},{"metricName":"number of input batches","value":30811}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7115},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":124977352}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]