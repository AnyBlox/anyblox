[{"totalTime":11960,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=645]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":732347},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":136},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":136}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1627}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1626},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, p_type#78]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_partkey#17], [p_partkey#74], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1496983},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1623}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#17 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":28},{"metricName":"peak memory","value":184549376},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":25829979},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=534]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1519632},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":461290485},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1496983},{"metricName":"local bytes read","value":24629850},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":82},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48628224},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":24629850}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":7631}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-09-01)) AND (l_shipdate#26 < 1995-10-01)) AND isnotnull(l_partkey#17))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1519633}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":121796887},{"metricName":"number of input batches","value":30024}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01..., ReadSchema: struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01), IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull(l_partkey#17)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4893},{"metricName":"metadata time","value":4},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":121796887}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":86},{"metricName":"peak memory","value":536870912},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":73731883},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=553]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":96607212},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4000000},{"metricName":"local bytes read","value":69106977},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":191783584},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":69106977}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1237}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(p_partkey#74)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_type#78] Batched: true, DataFilters: [isnotnull(p_partkey#74)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":23},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":10896,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1509]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":970143},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":136},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":136}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1703}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1703},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, p_type#78]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_partkey#17], [p_partkey#74], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1496983},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1697}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#17 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":47},{"metricName":"peak memory","value":285212672},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":25829979},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=1398]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1496983},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":420704203},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2498444},{"metricName":"local bytes read","value":41108546},{"metricName":"fetch wait time","value":6},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":123},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":47903456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":24629850}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":6684}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-09-01)) AND (l_shipdate#26 < 1995-10-01)) AND isnotnull(l_partkey#17))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1496983}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01..., ReadSchema: struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01), IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull(l_partkey#17)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4094},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":85},{"metricName":"peak memory","value":536870912},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":73731883},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=1417]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":98047537},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":6031313},{"metricName":"local bytes read","value":115372931},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":6},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":191783584},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":69106977}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1299}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(p_partkey#74)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_type#78] Batched: true, DataFilters: [isnotnull(p_partkey#74)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":18},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":11491,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1293]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":423276},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":136},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":136}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2126}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2126},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, p_type#78]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_partkey#17], [p_partkey#74], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1496983},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":2120}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#17 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":59},{"metricName":"peak memory","value":268435456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":25829979},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=1182]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1503359},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":418154027},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1992505},{"metricName":"local bytes read","value":32781004},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":123},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48107488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":24629850}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":6784}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-09-01)) AND (l_shipdate#26 < 1995-10-01)) AND isnotnull(l_partkey#17))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1503359}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":120502927},{"metricName":"number of input batches","value":29706}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01..., ReadSchema: struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01), IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull(l_partkey#17)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4244},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":120502927}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":91},{"metricName":"peak memory","value":536870912},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":73731883},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=1201]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":113217002},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5321894},{"metricName":"local bytes read","value":91948000},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":6},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":191783584},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":69106977}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1303}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(p_partkey#74)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_type#78] Batched: true, DataFilters: [isnotnull(p_partkey#74)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":23},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":11177,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1077]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":422394},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":136},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":136}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1654}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1653},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, p_type#78]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_partkey#17], [p_partkey#74], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1496983},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1642}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#17 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":29},{"metricName":"peak memory","value":184549376},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":25829979},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=966]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1504567},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":432088823},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1496983},{"metricName":"local bytes read","value":24629850},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":82},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48146176},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":24629850}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":7014}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-09-01)) AND (l_shipdate#26 < 1995-10-01)) AND isnotnull(l_partkey#17))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1504568}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":120613093},{"metricName":"number of input batches","value":29733}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01..., ReadSchema: struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01), IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull(l_partkey#17)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4347},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":120613093}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":85},{"metricName":"peak memory","value":536870912},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":73731883},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=985]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":100033696},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4000000},{"metricName":"local bytes read","value":69106977},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":191783584},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":69106977}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1250}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(p_partkey#74)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_type#78] Batched: true, DataFilters: [isnotnull(p_partkey#74)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":18},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":11374,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=861]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":418882},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":136},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":136}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1732}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(CASE WHEN StartsWith(p_type#78, PROMO) THEN (l_extendedprice#21 * (1.0 - l_discount#22)) ELSE 0.0 END), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1731},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, p_type#78]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_partkey#17], [p_partkey#74], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1496983},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1733}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#17 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":29},{"metricName":"peak memory","value":184549376},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":25829979},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=750]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1508299},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":427863669},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1496983},{"metricName":"local bytes read","value":24629850},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":82},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":48265568},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":24629850}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":7058}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-09-01)) AND (l_shipdate#26 < 1995-10-01)) AND isnotnull(l_partkey#17))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1508299}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":120908917},{"metricName":"number of input batches","value":29806}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01..., ReadSchema: struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-09-01), LessThan(l_shipdate,1995-10-01), IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-09-01), (l_shipdate#26 < 1995-10-01), isnotnull(l_partkey#17)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4486},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":120908917}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":86},{"metricName":"peak memory","value":536870912},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":73731883},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=769]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":94331645},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4000000},{"metricName":"local bytes read","value":69106977},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":191783584},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":69106977}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1254}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(p_partkey#74)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_type#78] Batched: true, DataFilters: [isnotnull(p_partkey#74)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":29},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]