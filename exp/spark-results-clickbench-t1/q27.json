[{"totalTime":70966,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[EventTime#4 ASC NULLS FIRST,SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#407])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25872}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, EventTime#4]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5469}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3366},{"metricName":"peak memory","value":7650410496},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":1190342158},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=679]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102383817},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1914504665},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":105547262},{"metricName":"local bytes read","value":1217115564},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2077},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2457211632},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1155709808}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":30222}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102383819}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102387433},{"metricName":"number of input batches","value":25017}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11472},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102387433}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":46002}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":342},{"metricName":"peak memory","value":2432696320},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=727]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16529737},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":900070808},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":686722963},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":124},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1384918336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2511}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3828079}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":33914880},{"metricName":"number of input batches","value":276}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":33914880},{"metricName":"time spent in job init","value":18556512},{"metricName":"time spent in decode_batch","value":801229952},{"metricName":"time spent loading native vectors","value":17096353}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3373}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2536991},{"metricName":"time spent in decode_batch","value":848334977},{"metricName":"time spent loading native vectors","value":34758457}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2926}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":4705844},{"metricName":"time spent in decode_batch","value":839117681},{"metricName":"time spent loading native vectors","value":19075816}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2911}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":5409334}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":40769337},{"metricName":"number of input batches","value":332}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":40769337},{"metricName":"time spent in job init","value":5465858},{"metricName":"time spent in decode_batch","value":1242890730},{"metricName":"time spent loading native vectors","value":29113118}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":71902,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[EventTime#4 ASC NULLS FIRST,SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#393])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":26429}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, EventTime#4]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5542}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3368},{"metricName":"peak memory","value":7650410496},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":1190342158},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=483]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100937865},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1913619996},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106134621},{"metricName":"local bytes read","value":1256921426},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2144},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2422508784},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1137492358}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29899}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100937867}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100943673},{"metricName":"number of input batches","value":24664}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11772},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100943673}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":47079}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":343},{"metricName":"peak memory","value":2432696320},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=531]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13452770},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":809779186},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":709146796},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":128},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1122685952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2664}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":7781760},{"metricName":"time spent in decode_batch","value":830512445},{"metricName":"time spent loading native vectors","value":32486569}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3332}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4300797}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26296320},{"metricName":"number of input batches","value":214}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":26296320},{"metricName":"time spent in job init","value":4930514},{"metricName":"time spent in decode_batch","value":842157032},{"metricName":"time spent loading native vectors","value":20341415}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2924}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2473431},{"metricName":"time spent in decode_batch","value":824719256},{"metricName":"time spent loading native vectors","value":18804798}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2897}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":3665472},{"metricName":"time spent in decode_batch","value":811684383},{"metricName":"time spent loading native vectors","value":17085914}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":69638,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[EventTime#4 ASC NULLS FIRST,SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#449])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25740}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, EventTime#4]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5417}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3602},{"metricName":"peak memory","value":8187281408},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":1190342158},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1267]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101629816},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1906836335},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106998857},{"metricName":"local bytes read","value":1217135664},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2077},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2439115608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1154237607}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29071}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101629817}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101631801},{"metricName":"number of input batches","value":24832}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10645},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101631801}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":45759}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":344},{"metricName":"peak memory","value":2432696320},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1315]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14902771},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":887215013},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13631729},{"metricName":"local bytes read","value":686633656},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":124},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1247383408},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2496}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3099892}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27893760},{"metricName":"number of input batches","value":227}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":27893760},{"metricName":"time spent in job init","value":19180374},{"metricName":"time spent in decode_batch","value":789338298},{"metricName":"time spent loading native vectors","value":16290055}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3369}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2475835},{"metricName":"time spent in decode_batch","value":850056450},{"metricName":"time spent loading native vectors","value":15583336}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3015}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2559814},{"metricName":"time spent in decode_batch","value":835062688},{"metricName":"time spent loading native vectors","value":24085231}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2926}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4510554}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":34133817},{"metricName":"number of input batches","value":278}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":34133817},{"metricName":"time spent in job init","value":12902424},{"metricName":"time spent in decode_batch","value":837154231},{"metricName":"time spent loading native vectors","value":16768476}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":69742,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[EventTime#4 ASC NULLS FIRST,SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#435])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25853}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, EventTime#4]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5406}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3369},{"metricName":"peak memory","value":7650410496},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":1190342158},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1071]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102754902},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1898434704},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106998857},{"metricName":"local bytes read","value":1217135664},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2077},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2466117672},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1137492358}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28827}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102754904}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102758201},{"metricName":"number of input batches","value":25107}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10957},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102758201}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":46005}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":343},{"metricName":"peak memory","value":2432696320},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1119]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14426750},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":831746146},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":686633656},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":124},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1206086312},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2502}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2717111}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26664960},{"metricName":"number of input batches","value":217}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":26664960},{"metricName":"time spent in job init","value":8611828},{"metricName":"time spent in decode_batch","value":802289506},{"metricName":"time spent loading native vectors","value":16473091}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3314}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2571984},{"metricName":"time spent in decode_batch","value":837659550},{"metricName":"time spent loading native vectors","value":15492635}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2906}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":5668421},{"metricName":"time spent in decode_batch","value":821803013},{"metricName":"time spent loading native vectors","value":17058871}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2892}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4417315}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":33150777},{"metricName":"number of input batches","value":270}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":33150777},{"metricName":"time spent in job init","value":5058230},{"metricName":"time spent in decode_batch","value":818051728},{"metricName":"time spent loading native vectors","value":15644245}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":70651,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[EventTime#4 ASC NULLS FIRST,SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#421])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":26149}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, EventTime#4]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5432}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3481},{"metricName":"peak memory","value":7918845952},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":1190342158},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=875]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101685355},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1912405936},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106998857},{"metricName":"local bytes read","value":1217135664},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2077},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2440448520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1137492358}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29134}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101685355}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101688104},{"metricName":"number of input batches","value":24847}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10718},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101688104}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":46593}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":344},{"metricName":"peak memory","value":2432696320},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":29},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":29}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=923]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":15267110},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":864864786},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13360360},{"metricName":"local bytes read","value":686633656},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":124},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1276856848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2515}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3275090}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28753920},{"metricName":"number of input batches","value":234}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":28753920},{"metricName":"time spent in job init","value":15341688},{"metricName":"time spent in decode_batch","value":790190280},{"metricName":"time spent loading native vectors","value":18729064}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3352}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2554060},{"metricName":"time spent in decode_batch","value":854226552},{"metricName":"time spent loading native vectors","value":20640257}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3009}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":6498943},{"metricName":"time spent in decode_batch","value":851466250},{"metricName":"time spent loading native vectors","value":15783106}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2902}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4699695}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":36345657},{"metricName":"number of input batches","value":296}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":36345657},{"metricName":"time spent in job init","value":14522238},{"metricName":"time spent in decode_batch","value":816960628},{"metricName":"time spent loading native vectors","value":19037875}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]