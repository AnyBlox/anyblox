[{"totalTime":235558,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#474L DESC NULLS LAST], output=[toprettystring(UserID)#483,toprettystring(m)#484,toprettystring(SearchPhrase)#485,toprettystring(count(1))#486])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":43062}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#491, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38627},{"metricName":"peak memory","value":6744440832},{"metricName":"number of output rows","value":56384822},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":476}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#491, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=946]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100715078},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2925862461},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":104985698},{"metricName":"local bytes read","value":2471784239},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2613},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4833883616},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2166628630}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":127187}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#491, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":100292},{"metricName":"peak memory","value":13992198144},{"metricName":"number of output rows","value":100715080},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1120}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#491]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":109014245},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":100426}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3603},{"metricName":"peak memory","value":10435428352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=834]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101518685},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3017962977},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":117177350},{"metricName":"local bytes read","value":2471719033},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5293},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3248597984},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2094561885}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":32831}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101518688}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101529401},{"metricName":"number of input batches","value":24807}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11015},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101529401}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":100315}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3559},{"metricName":"peak memory","value":10166992896},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1297115000},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=849]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":156560739},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1874586161},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":114746910},{"metricName":"local bytes read","value":1485315354},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":316},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4942998088},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1878313350}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":26295}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":156768057},{"metricName":"number of input batches","value":1276}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":49889280},{"metricName":"time spent in job init","value":15966414},{"metricName":"time spent in decode_batch","value":1570384781},{"metricName":"time spent loading native vectors","value":35626283}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2479958},{"metricName":"time spent in decode_batch","value":839966959},{"metricName":"time spent loading native vectors","value":30040367}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":35020800},{"metricName":"time spent in job init","value":4988750},{"metricName":"time spent in decode_batch","value":829123173},{"metricName":"time spent loading native vectors","value":18779691}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":46790457},{"metricName":"time spent in job init","value":5184260},{"metricName":"time spent in decode_batch","value":1217023610},{"metricName":"time spent loading native vectors","value":25919864}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":238150,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#438L DESC NULLS LAST], output=[toprettystring(UserID)#447,toprettystring(m)#448,toprettystring(SearchPhrase)#449,toprettystring(count(1))#450])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":43570}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#455, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":39129},{"metricName":"peak memory","value":6744440832},{"metricName":"number of output rows","value":56384822},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":476}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#455, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=706]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":99848034},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2925275660},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":105374241},{"metricName":"local bytes read","value":2407126028},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4792665272},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2149229269}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":125948}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#455, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":100805},{"metricName":"peak memory","value":13992198144},{"metricName":"number of output rows","value":99848037},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1120}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#455]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":109200449},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":101033}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3662},{"metricName":"peak memory","value":10435428352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=594]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103658996},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3038695903},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":117022301},{"metricName":"local bytes read","value":2502940658},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3317087936},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2118852997}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":34396}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":103658999}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":103664795},{"metricName":"number of input batches","value":25331}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11680},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":103664795}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":100916}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3554},{"metricName":"peak memory","value":10166992896},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1297115000},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=609]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":147401228},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1868240137},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":114579565},{"metricName":"local bytes read","value":1504076646},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4743549344},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1828042271}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":26563}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":147552057},{"metricName":"number of input batches","value":1201}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":37724160},{"metricName":"time spent in job init","value":16582496},{"metricName":"time spent in decode_batch","value":1263285539},{"metricName":"time spent loading native vectors","value":54262037}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":49397760},{"metricName":"time spent in job init","value":5441246},{"metricName":"time spent in decode_batch","value":1230137692},{"metricName":"time spent loading native vectors","value":40464957}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2767966},{"metricName":"time spent in decode_batch","value":843484673},{"metricName":"time spent loading native vectors","value":19291763}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":35362617},{"metricName":"time spent in job init","value":5141630},{"metricName":"time spent in decode_batch","value":816814995},{"metricName":"time spent loading native vectors","value":19629216}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":237359,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#582L DESC NULLS LAST], output=[toprettystring(UserID)#591,toprettystring(m)#592,toprettystring(SearchPhrase)#593,toprettystring(count(1))#594])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":43004}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#599, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38592},{"metricName":"peak memory","value":6744440832},{"metricName":"number of output rows","value":56384822},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":476}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#599, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1666]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101728085},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3217173410},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106604093},{"metricName":"local bytes read","value":2471608709},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2613},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4882216880},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2149229269}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":127273}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#599, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":103007},{"metricName":"peak memory","value":14193524736},{"metricName":"number of output rows","value":101728089},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1136}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#599]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":110011288},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":103131}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3652},{"metricName":"peak memory","value":10435428352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1554]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102365511},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3106167611},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":117428419},{"metricName":"local bytes read","value":2502878541},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3275696416},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2094561885}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":32725}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102365513}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102372136},{"metricName":"number of input batches","value":25014}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10865},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102372136}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":103011}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3607},{"metricName":"peak memory","value":10166992896},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1297115000},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1569]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":131176186},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1680081209},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":115388477},{"metricName":"local bytes read","value":1504055951},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4154822184},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1602163179}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":26409}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":131331897},{"metricName":"number of input batches","value":1069}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":4674111},{"metricName":"time spent in decode_batch","value":790111752},{"metricName":"time spent loading native vectors","value":22118999}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":35880960},{"metricName":"time spent in job init","value":5028728},{"metricName":"time spent in decode_batch","value":838199692},{"metricName":"time spent loading native vectors","value":23266487}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":45588480},{"metricName":"time spent in job init","value":5004564},{"metricName":"time spent in decode_batch","value":1244556596},{"metricName":"time spent loading native vectors","value":53956696}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2553546},{"metricName":"time spent in decode_batch","value":818217971},{"metricName":"time spent loading native vectors","value":22100180}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":235629,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#546L DESC NULLS LAST], output=[toprettystring(UserID)#555,toprettystring(m)#556,toprettystring(SearchPhrase)#557,toprettystring(count(1))#558])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":43436}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#563, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38982},{"metricName":"peak memory","value":6744440832},{"metricName":"number of output rows","value":56384822},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":476}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#563, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1426]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101976393},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2944636599},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":104478805},{"metricName":"local bytes read","value":2407154854},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4894404752},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2181481964}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":126949}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#563, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":101503},{"metricName":"peak memory","value":14193524736},{"metricName":"number of output rows","value":101976396},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1136}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#563]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":110410157},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":101606}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3635},{"metricName":"peak memory","value":10536091648},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1314]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100913246},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3087572980},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118235343},{"metricName":"local bytes read","value":2492486502},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3229223872},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2094561885}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":32892}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100913247}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100915789},{"metricName":"number of input batches","value":24658}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10890},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100915789}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":101518}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3551},{"metricName":"peak memory","value":10166992896},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1297115000},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1329]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":138222414},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1739966055},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":115500212},{"metricName":"local bytes read","value":1497856899},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4387876960},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1655277767}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":26262}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":138336057},{"metricName":"number of input batches","value":1126}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":43008000},{"metricName":"time spent in job init","value":28142328},{"metricName":"time spent in decode_batch","value":1215982627},{"metricName":"time spent loading native vectors","value":25298281}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2468423},{"metricName":"time spent in decode_batch","value":839778162},{"metricName":"time spent loading native vectors","value":16142043}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":29245440},{"metricName":"time spent in job init","value":5107844},{"metricName":"time spent in decode_batch","value":828383685},{"metricName":"time spent loading native vectors","value":17879486}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":41015097},{"metricName":"time spent in job init","value":5133448},{"metricName":"time spent in decode_batch","value":1213172387},{"metricName":"time spent loading native vectors","value":27246227}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":235559,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#510L DESC NULLS LAST], output=[toprettystring(UserID)#519,toprettystring(m)#520,toprettystring(SearchPhrase)#521,toprettystring(count(1))#522])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":43104}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#527, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38692},{"metricName":"peak memory","value":6744440832},{"metricName":"number of output rows","value":56384822},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":476}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#527, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1186]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100653384},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2932125270},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":102741787},{"metricName":"local bytes read","value":2407231547},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4831728976},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2181464115}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":127063}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#527, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":101623},{"metricName":"peak memory","value":14193524736},{"metricName":"number of output rows","value":100653387},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1136}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#527]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":111258504},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":101734}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3645},{"metricName":"peak memory","value":10569646080},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1074]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":99997497},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2964483807},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118447344},{"metricName":"local bytes read","value":2502904623},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3199919904},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2094561885}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":32805}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":99997497}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":99997497},{"metricName":"number of input batches","value":24433}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10596},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":99997497}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":101639}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3603},{"metricName":"peak memory","value":10301210624},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1297115000},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1089]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":142888005},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1948907973},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":116693040},{"metricName":"local bytes read","value":1504174766},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4511451376},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1706643413}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":33309}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":143005497},{"metricName":"number of input batches","value":1164}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":26910720},{"metricName":"time spent in job init","value":10059668},{"metricName":"time spent in decode_batch","value":802325219},{"metricName":"time spent loading native vectors","value":27050125}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":41164800},{"metricName":"time spent in job init","value":13039360},{"metricName":"time spent in decode_batch","value":1212622247},{"metricName":"time spent loading native vectors","value":29132568}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":50135040},{"metricName":"time spent in job init","value":5223056},{"metricName":"time spent in decode_batch","value":1657889094},{"metricName":"time spent loading native vectors","value":32478674}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2557865},{"metricName":"time spent in decode_batch","value":813652690},{"metricName":"time spent loading native vectors","value":19399701}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]