[{"totalTime":64168,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#407])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25275}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13528638},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":4165}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3675},{"metricName":"peak memory","value":7751073792},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=679]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102043160},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1206058167},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106829751},{"metricName":"local bytes read","value":564054199},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1474},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1632690576},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":506540236}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24728}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102043161}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102046678},{"metricName":"number of input batches","value":24934}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8931},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102046678}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":46114}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":412},{"metricName":"peak memory","value":1988100096},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=727]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14889103},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":851267129},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13895928},{"metricName":"local bytes read","value":718716647},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":88},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1243936528},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2506}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":3398640},{"metricName":"time spent in decode_batch","value":786251621},{"metricName":"time spent loading native vectors","value":19757383}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3304}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2582735},{"metricName":"time spent in decode_batch","value":848272627},{"metricName":"time spent loading native vectors","value":29547418}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2887}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4988620}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":40304640},{"metricName":"number of input batches","value":328}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":40304640},{"metricName":"time spent in job init","value":5190734},{"metricName":"time spent in decode_batch","value":1231946567},{"metricName":"time spent loading native vectors","value":40276303}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2875}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2953732},{"metricName":"time spent in decode_batch","value":821237371},{"metricName":"time spent loading native vectors","value":22323977}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":65166,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#393])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25429}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":4203}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3451},{"metricName":"peak memory","value":7348420608},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=483]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101293682},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1207081339},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":100926674},{"metricName":"local bytes read","value":559028096},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1407},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1620698912},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24890}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101293683}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101295929},{"metricName":"number of input batches","value":24750}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9338},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101295929}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":46379}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":391},{"metricName":"peak memory","value":1887436800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=531]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":15582441},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":874624939},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":677093357},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":80},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1305474752},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2595}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":5018669}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":45834240},{"metricName":"number of input batches","value":373}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":45834240},{"metricName":"time spent in job init","value":5295088},{"metricName":"time spent in decode_batch","value":1269287664},{"metricName":"time spent loading native vectors","value":43263685}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3271}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2446951},{"metricName":"time spent in decode_batch","value":832592353},{"metricName":"time spent loading native vectors","value":17239259}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2905}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2692402},{"metricName":"time spent in decode_batch","value":838145158},{"metricName":"time spent loading native vectors","value":26390616}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2879}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":3356170},{"metricName":"time spent in decode_batch","value":826079582},{"metricName":"time spent loading native vectors","value":19287918}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":63652,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#449])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25094}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":4131}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3643},{"metricName":"peak memory","value":7751073792},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1267]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102058089},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1218615223},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":113926076},{"metricName":"local bytes read","value":586753642},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1474},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1632929456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":23995}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102058092}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102061881},{"metricName":"number of input batches","value":24937}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8968},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102061881}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":45751}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":389},{"metricName":"peak memory","value":1887436800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1315]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16737406},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":966791514},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13183015},{"metricName":"local bytes read","value":747598794},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":88},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1400453664},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":795017392}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2568}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":8184011},{"metricName":"time spent in decode_batch","value":830156915},{"metricName":"time spent loading native vectors","value":31132475}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3285}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":7585433}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":44851200},{"metricName":"number of input batches","value":365}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":44851200},{"metricName":"time spent in job init","value":4920474},{"metricName":"time spent in decode_batch","value":1218420386},{"metricName":"time spent loading native vectors","value":31321066}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2927}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":3115242},{"metricName":"time spent in decode_batch","value":831957794},{"metricName":"time spent loading native vectors","value":29155307}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2955}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":6469043},{"metricName":"time spent in decode_batch","value":830838894},{"metricName":"time spent loading native vectors","value":19521942}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":63888,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#435])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25090}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":4180}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3452},{"metricName":"peak memory","value":7348420608},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1071]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101560855},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1230802829},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":102520513},{"metricName":"local bytes read","value":559038326},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1407},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1624973680},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":510097930}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24799}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101560856}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101563466},{"metricName":"number of input batches","value":24816}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9023},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101563466}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":45723}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":392},{"metricName":"peak memory","value":1887436800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1119]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13213408},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":805315058},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":712268881},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":84},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1104510840},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2457}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":7247687},{"metricName":"time spent in decode_batch","value":785693391},{"metricName":"time spent loading native vectors","value":16081714}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3266}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2518765},{"metricName":"time spent in decode_batch","value":833854909},{"metricName":"time spent loading native vectors","value":17158544}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2865}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2536063},{"metricName":"time spent in decode_batch","value":822014399},{"metricName":"time spent loading native vectors","value":15417712}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2859}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3312463}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26269497},{"metricName":"number of input batches","value":214}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":26269497},{"metricName":"time spent in job init","value":5170184},{"metricName":"time spent in decode_batch","value":816899236},{"metricName":"time spent loading native vectors","value":17494782}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":63988,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[SearchPhrase#203 ASC NULLS FIRST], output=[toprettystring(SearchPhrase)#421])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25302}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":14267292},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":4180}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3831},{"metricName":"peak memory","value":8153726976},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=875]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101596703},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1187625364},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":112372164},{"metricName":"local bytes read","value":586721067},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1474},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1625547248},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24137}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101596704}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101599033},{"metricName":"number of input batches","value":24824}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8854},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101599033}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":46137}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":434},{"metricName":"peak memory","value":2088763392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":19},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":19}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=923]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14223523},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":830639833},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14620934},{"metricName":"local bytes read","value":747601459},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":88},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1183551016},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2458}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2820714},{"metricName":"time spent in decode_batch","value":784642914},{"metricName":"time spent loading native vectors","value":18972464}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3295}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":5071550}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":35758080},{"metricName":"number of input batches","value":291}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":35758080},{"metricName":"time spent in job init","value":5054850},{"metricName":"time spent in decode_batch","value":852330308},{"metricName":"time spent loading native vectors","value":20132015}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2972}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271908}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":3323619},{"metricName":"time spent in decode_batch","value":850803912},{"metricName":"time spent loading native vectors","value":19644699}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2880}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2469178},{"metricName":"time spent in decode_batch","value":810215748},{"metricName":"time spent loading native vectors","value":18754198}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]