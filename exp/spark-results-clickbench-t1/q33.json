[{"totalTime":217641,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#522L DESC NULLS LAST], output=[toprettystring(WatchID)#538,toprettystring(ClientIP)#539,toprettystring(c)#540,toprettystring(sum(IsRefresh))#541,toprettystring(avg(ResolutionWidth))#542])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":46394}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":39300},{"metricName":"peak memory","value":13455327232},{"metricName":"number of output rows","value":99997493},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":544}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2038751197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=946]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102260379},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2722520565},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106131357},{"metricName":"local bytes read","value":2270622083},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1950},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5726581224},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1974449349}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":112469}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":90712},{"metricName":"peak memory","value":13958643712},{"metricName":"number of output rows","value":102260381},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":832}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":108749577},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":90833}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3911},{"metricName":"peak memory","value":11878268928},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=834]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102357177},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3234482414},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119395706},{"metricName":"local bytes read","value":2869106559},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4020},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4913144592},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2390900872}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":36323}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102357180}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102360889},{"metricName":"number of input batches","value":25010}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11162},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102360889}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":90754}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3802},{"metricName":"peak memory","value":7784628224},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":541309230},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=849]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":115569712},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":694707350},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":116330909},{"metricName":"local bytes read","value":603762406},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":240},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1849115408},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":562431559}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":15673}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":115603257},{"metricName":"number of input batches","value":941}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2961970},{"metricName":"time spent in decode_batch","value":50662413},{"metricName":"time spent loading native vectors","value":12679998}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":27033600},{"metricName":"time spent in job init","value":4867768},{"metricName":"time spent in decode_batch","value":51875347},{"metricName":"time spent loading native vectors","value":50640219}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2440029},{"metricName":"time spent in decode_batch","value":50243903},{"metricName":"time spent loading native vectors","value":11840914}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":38434617},{"metricName":"time spent in job init","value":6678874},{"metricName":"time spent in decode_batch","value":74071153},{"metricName":"time spent loading native vectors","value":18177437}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":216193,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#469L DESC NULLS LAST], output=[toprettystring(WatchID)#485,toprettystring(ClientIP)#486,toprettystring(c)#487,toprettystring(sum(IsRefresh))#488,toprettystring(avg(ResolutionWidth))#489])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":46601}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":40673},{"metricName":"peak memory","value":13857980416},{"metricName":"number of output rows","value":101671141},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2038751197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=706]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103152143},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2614303280},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":110782628},{"metricName":"local bytes read","value":2270534464},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1950},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5776520120},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2013925839}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":112648}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":90917},{"metricName":"peak memory","value":14227079168},{"metricName":"number of output rows","value":103152145},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":848}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":110750111},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":91050}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3793},{"metricName":"peak memory","value":11878268928},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=594]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100527486},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3309619707},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":120296164},{"metricName":"local bytes read","value":2916947110},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4087},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4825319376},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2390900872}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":36624}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100527487}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100529977},{"metricName":"number of input batches","value":24563}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11091},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100529977}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":90967}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3609},{"metricName":"peak memory","value":7650410496},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":541309230},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=609]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":116265697},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":726410585},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":115881011},{"metricName":"local bytes read","value":613830659},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":244},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1860251152},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":562430240}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":15585}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":116463417},{"metricName":"number of input batches","value":948}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":26787840},{"metricName":"time spent in job init","value":23063666},{"metricName":"time spent in decode_batch","value":57383909},{"metricName":"time spent loading native vectors","value":19856182}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2670001},{"metricName":"time spent in decode_batch","value":55745798},{"metricName":"time spent loading native vectors","value":15273491}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":39813120},{"metricName":"time spent in job init","value":5623180},{"metricName":"time spent in decode_batch","value":83674395},{"metricName":"time spent loading native vectors","value":21316411}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":6396065},{"metricName":"time spent in decode_batch","value":49041298},{"metricName":"time spent loading native vectors","value":13217996}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":214213,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#681L DESC NULLS LAST], output=[toprettystring(WatchID)#697,toprettystring(ClientIP)#698,toprettystring(c)#699,toprettystring(sum(IsRefresh))#700,toprettystring(avg(ResolutionWidth))#701])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":46308}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":39219},{"metricName":"peak memory","value":13455327232},{"metricName":"number of output rows","value":99997493},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":544}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2038751197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=1666]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101822958},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2572178823},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":108392056},{"metricName":"local bytes read","value":2211335184},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1900},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5702085648},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1974449349}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":109821}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":88685},{"metricName":"peak memory","value":13958643712},{"metricName":"number of output rows","value":101822959},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":832}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":110469749},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":88737}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3783},{"metricName":"peak memory","value":11878268928},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1554]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101789572},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3204975468},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":121464894},{"metricName":"local bytes read","value":2964768753},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4154},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4885899552},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2390900872}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":36109}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101789575}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101795948},{"metricName":"number of input batches","value":24873}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11168},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101795948}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":88664}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3666},{"metricName":"peak memory","value":7784628224},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":541309230},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1569]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":120828482},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":668271090},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":117161151},{"metricName":"local bytes read","value":623895025},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":248},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1933255728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":597023179}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":15452}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":120887097},{"metricName":"number of input batches","value":984}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":14546274},{"metricName":"time spent in decode_batch","value":50252719},{"metricName":"time spent loading native vectors","value":11943031}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":45957120},{"metricName":"time spent in job init","value":4808336},{"metricName":"time spent in decode_batch","value":75528567},{"metricName":"time spent loading native vectors","value":16732630}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2473068},{"metricName":"time spent in decode_batch","value":50734557},{"metricName":"time spent loading native vectors","value":19368305}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2439018},{"metricName":"time spent in decode_batch","value":48913319},{"metricName":"time spent loading native vectors","value":10867340}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":214160,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#628L DESC NULLS LAST], output=[toprettystring(WatchID)#644,toprettystring(ClientIP)#645,toprettystring(c)#646,toprettystring(sum(IsRefresh))#647,toprettystring(avg(ResolutionWidth))#648])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":46268}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":40354},{"metricName":"peak memory","value":13857980416},{"metricName":"number of output rows","value":101879736},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2038751197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=1426]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103235335},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2765295068},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":110992948},{"metricName":"local bytes read","value":2270622083},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1950},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5781178816},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1974449349}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":109824}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":90290},{"metricName":"peak memory","value":14227079168},{"metricName":"number of output rows","value":103235337},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":848}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":110988249},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":90357}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3784},{"metricName":"peak memory","value":11878268928},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1314]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102169457},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3215105094},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":120371479},{"metricName":"local bytes read","value":2916794667},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4087},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4904134080},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2390900872}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":35944}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102169460}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102176569},{"metricName":"number of input batches","value":24965}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11045},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102176569}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":90285}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3658},{"metricName":"peak memory","value":7784628224},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":541309230},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1329]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":135221295},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":732536638},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":117042535},{"metricName":"local bytes read","value":613799420},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":244},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2163540720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":656687135}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":15363}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":135386937},{"metricName":"number of input batches","value":1102}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":35880960},{"metricName":"time spent in job init","value":9500834},{"metricName":"time spent in decode_batch","value":50573757},{"metricName":"time spent loading native vectors","value":12001346}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2399007},{"metricName":"time spent in decode_batch","value":50100647},{"metricName":"time spent loading native vectors","value":11306975}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":49643520},{"metricName":"time spent in job init","value":4890742},{"metricName":"time spent in decode_batch","value":75581828},{"metricName":"time spent loading native vectors","value":20011585}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2463245},{"metricName":"time spent in decode_batch","value":48492322},{"metricName":"time spent loading native vectors","value":11871601}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":215047,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#575L DESC NULLS LAST], output=[toprettystring(WatchID)#591,toprettystring(ClientIP)#592,toprettystring(c)#593,toprettystring(sum(IsRefresh))#594,toprettystring(avg(ResolutionWidth))#595])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":46433}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":40502},{"metricName":"peak memory","value":13857980416},{"metricName":"number of output rows","value":100965948},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2038751197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=1186]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102150555},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2569302541},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":110159318},{"metricName":"local bytes read","value":2211450345},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1900},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5720431136},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1974449349}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":110054}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":88868},{"metricName":"peak memory","value":13958643712},{"metricName":"number of output rows","value":102150557},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":832}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":109012134},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":88932}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3715},{"metricName":"peak memory","value":11676942336},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1074]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102322555},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3237820061},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119722309},{"metricName":"local bytes read","value":2964830658},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4154},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4911482736},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2395071074}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":36587}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102322558}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102328121},{"metricName":"number of input batches","value":25002}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11224},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102328121}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":88865}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3598},{"metricName":"peak memory","value":7650410496},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":541309230},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1089]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":116192148},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":689610551},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":114489333},{"metricName":"local bytes read","value":623907692},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":248},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1859074384},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":562431398}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":15684}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":116217657},{"metricName":"number of input batches","value":946}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":11626214},{"metricName":"time spent in decode_batch","value":50557055},{"metricName":"time spent loading native vectors","value":12090244}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":41287680},{"metricName":"time spent in job init","value":5021662},{"metricName":"time spent in decode_batch","value":74775271},{"metricName":"time spent loading native vectors","value":20218973}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2458003},{"metricName":"time spent in decode_batch","value":51060516},{"metricName":"time spent loading native vectors","value":13456990}],"children":[]},{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2374552},{"metricName":"time spent in decode_batch","value":49287082},{"metricName":"time spent loading native vectors","value":12519022}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]