[{"totalTime":110531,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#465L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#471,toprettystring(u)#472])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4639}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3953},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1534]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7739678},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":538014700},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8264759},{"metricName":"local bytes read","value":452301446},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":96},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":694071488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18616}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14175},{"metricName":"peak memory","value":1913651200},{"metricName":"number of output rows","value":7739678},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":180}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":10004},{"metricName":"peak memory","value":2082471936},{"metricName":"number of output rows","value":11101483},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1489]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13237325},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1158226635},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":15154725},{"metricName":"local bytes read","value":822912323},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1108132656},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40989}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":34361},{"metricName":"peak memory","value":2923429888},{"metricName":"number of output rows","value":13237326},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13680565},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":8094}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3541},{"metricName":"peak memory","value":9495904256},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1297]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100969869},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2206098460},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":109056160},{"metricName":"local bytes read","value":1567896821},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2423276856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28538}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100969871}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100972345},{"metricName":"number of input batches","value":24671}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10270},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100972345}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":60395}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":387},{"metricName":"peak memory","value":3011510272},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1334]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13441820},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":814980610},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13962727},{"metricName":"local bytes read","value":718774514},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":152},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1124599344},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2484}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":13866938},{"metricName":"time spent in decode_batch","value":802146220},{"metricName":"time spent loading native vectors","value":16863438}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3343}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2512833},{"metricName":"time spent in decode_batch","value":866198591},{"metricName":"time spent loading native vectors","value":27086287}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2870}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3541336}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27770880},{"metricName":"number of input batches","value":226}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":27770880},{"metricName":"time spent in job init","value":5062130},{"metricName":"time spent in decode_batch","value":828885852},{"metricName":"time spent loading native vectors","value":24998743}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2875}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2566054},{"metricName":"time spent in decode_batch","value":817696065},{"metricName":"time spent loading native vectors","value":20578705}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":111680,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#431L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#437,toprettystring(u)#438])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4642}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3956},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1150]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":8328656},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":551263375},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8073627},{"metricName":"local bytes read","value":452301178},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":96},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":746771496},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18849}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":15669},{"metricName":"peak memory","value":2081423360},{"metricName":"number of output rows","value":8328657},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":10012},{"metricName":"peak memory","value":2082471936},{"metricName":"number of output rows","value":11642910},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1105]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13396725},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1066845047},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14576305},{"metricName":"local bytes read","value":822871698},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1121442872},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":701846577}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":42386}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":34697},{"metricName":"peak memory","value":2923429888},{"metricName":"number of output rows","value":13396725},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13856693},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":6957}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3651},{"metricName":"peak memory","value":9764339712},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=913]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":104100651},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2249615203},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":111996292},{"metricName":"local bytes read","value":1567871930},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2498415696},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28890}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":104100654}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":104106092},{"metricName":"number of input batches","value":25437}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10774},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":104106092}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":62236}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":386},{"metricName":"peak memory","value":3011510272},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=950]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14847321},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":948266389},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14352894},{"metricName":"local bytes read","value":718803097},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":152},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1240533384},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2698}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":12835142},{"metricName":"time spent in decode_batch","value":837500100},{"metricName":"time spent loading native vectors","value":29886484}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3307}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":6672123},{"metricName":"time spent in decode_batch","value":852128246},{"metricName":"time spent loading native vectors","value":19572654}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2871}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4946837}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":39936000},{"metricName":"number of input batches","value":325}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":39936000},{"metricName":"time spent in job init","value":5131254},{"metricName":"time spent in decode_batch","value":1227843852},{"metricName":"time spent loading native vectors","value":28148594}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2861}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2700168},{"metricName":"time spent in decode_batch","value":824890179},{"metricName":"time spent loading native vectors","value":17087788}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":109299,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#567L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#573,toprettystring(u)#574])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4542}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3863},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2686]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7739678},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":537835602},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7999425},{"metricName":"local bytes read","value":452232544},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":96},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":694071488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18342}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":13925},{"metricName":"peak memory","value":1913651200},{"metricName":"number of output rows","value":7739678},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":180}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8745},{"metricName":"peak memory","value":1914699776},{"metricName":"number of output rows","value":10681408},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":180}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2641]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13007148},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1061896722},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14185254},{"metricName":"local bytes read","value":822839223},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1088796776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40687}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":33243},{"metricName":"peak memory","value":2839543808},{"metricName":"number of output rows","value":13007148},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":544}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13366519},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":6966}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3543},{"metricName":"peak memory","value":9495904256},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2449]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102804675},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2285941388},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":111342315},{"metricName":"local bytes read","value":1567871930},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2467312248},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28181}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102804678}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102812237},{"metricName":"number of input batches","value":25121}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10273},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102812237}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":59236}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":386},{"metricName":"peak memory","value":3011510272},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=2486]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14210619},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":831308013},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13962320},{"metricName":"local bytes read","value":718803097},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":152},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1189241632},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2463}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":8140888},{"metricName":"time spent in decode_batch","value":790005009},{"metricName":"time spent loading native vectors","value":15849010}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3298}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2459488},{"metricName":"time spent in decode_batch","value":838154257},{"metricName":"time spent loading native vectors","value":19267295}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2930}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4310136}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":33669120},{"metricName":"number of input batches","value":274}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":33669120},{"metricName":"time spent in job init","value":13010494},{"metricName":"time spent in decode_batch","value":851539718},{"metricName":"time spent loading native vectors","value":29613796}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2891}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2610303},{"metricName":"time spent in decode_batch","value":818889754},{"metricName":"time spent loading native vectors","value":29839860}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":109147,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#533L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#539,toprettystring(u)#540])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4550}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3865},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2302]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":8107793},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":546607000},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8486812},{"metricName":"local bytes read","value":452301178},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":96},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":726791584},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18391}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":15238},{"metricName":"peak memory","value":2081423360},{"metricName":"number of output rows","value":8107794},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9572},{"metricName":"peak memory","value":2082471936},{"metricName":"number of output rows","value":11642910},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2257]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13374199},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1070184892},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14266522},{"metricName":"local bytes read","value":822871698},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1119508656},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40582}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":34136},{"metricName":"peak memory","value":2923429888},{"metricName":"number of output rows","value":13374200},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13567177},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":6948}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3540},{"metricName":"peak memory","value":9495904256},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2065]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101579442},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2218411122},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":108921746},{"metricName":"local bytes read","value":1567897367},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2437906608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":27957}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101579443}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101580152},{"metricName":"number of input batches","value":24820}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9835},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101580152}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":61005}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":375},{"metricName":"peak memory","value":2927624192},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=2102]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13794527},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1008648945},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13609270},{"metricName":"local bytes read","value":718764708},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":152},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1151153160},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2454}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":8474681},{"metricName":"time spent in decode_batch","value":785339416},{"metricName":"time spent loading native vectors","value":15018234}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3265}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2467059},{"metricName":"time spent in decode_batch","value":835461703},{"metricName":"time spent loading native vectors","value":15993989}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3058}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3894044}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30965760},{"metricName":"number of input batches","value":252}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":30965760},{"metricName":"time spent in job init","value":5003022},{"metricName":"time spent in decode_batch","value":827685644},{"metricName":"time spent loading native vectors","value":16460339}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2844}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2510673},{"metricName":"time spent in decode_batch","value":810426329},{"metricName":"time spent loading native vectors","value":18940570}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":109551,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#499L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#505,toprettystring(u)#506])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4605}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3918},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1918]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7739678},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":538075619},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8619553},{"metricName":"local bytes read","value":452301446},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":96},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":694071488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18435}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14001},{"metricName":"peak memory","value":1913651200},{"metricName":"number of output rows","value":7739678},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":180}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":10382},{"metricName":"peak memory","value":2250244096},{"metricName":"number of output rows","value":11792009},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":210}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1873]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13319682},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1075956919},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":15347850},{"metricName":"local bytes read","value":822912323},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1114945544},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40851}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":34372},{"metricName":"peak memory","value":2923429888},{"metricName":"number of output rows","value":13319683},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [rid#202L], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13796296},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":8113}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3654},{"metricName":"peak memory","value":9764339712},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1681]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101084563},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2202898053},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":109575251},{"metricName":"local bytes read","value":1567874109},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2426029536},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1408274891}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28398}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101084564}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101087113},{"metricName":"number of input batches","value":24701}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10001},{"metricName":"metadata time","value":3},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101087113}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":60372}],"children":[{"nodeName":"Sort","description":"Sort [rid#202L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":391},{"metricName":"peak memory","value":3011510272},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":669356190},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1718]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13283735},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":826681195},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14357722},{"metricName":"local bytes read","value":718712286},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":152},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1111283848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":641756237}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2468}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#203 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":2608619}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":5436747},{"metricName":"time spent in decode_batch","value":787470442},{"metricName":"time spent loading native vectors","value":16210543}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3276}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#215 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020418}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":2486940},{"metricName":"time spent in decode_batch","value":835844684},{"metricName":"time spent loading native vectors","value":19671303}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2890}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#227 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3383251}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26173440},{"metricName":"number of input batches","value":213}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":26173440},{"metricName":"time spent in job init","value":5284008},{"metricName":"time spent in decode_batch","value":831039988},{"metricName":"time spent loading native vectors","value":16974133}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2842}],"children":[{"nodeName":"Filter","description":"Filter NOT (SearchPhrase#239 = )","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271447}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":2521510},{"metricName":"time spent in decode_batch","value":811139026},{"metricName":"time spent loading native vectors","value":17083811}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]