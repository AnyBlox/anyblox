[{"totalTime":79469,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#705L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#723,toprettystring(min(URL))#724,toprettystring(min(Title))#725,toprettystring(c)#726,toprettystring(count(DISTINCT UserID))#727])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1897]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":21306672},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":57}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1853]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":182881886},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10863}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [rid#202L], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7175}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1581]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102073104},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2232291787},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":101787380},{"metricName":"local bytes read","value":1470602076},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2449754520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29644}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102073107}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102078265},{"metricName":"number of input batches","value":24941}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10264},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102078265}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false]),false), [plan_id=1769]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":25},{"metricName":"time to build","value":12},{"metricName":"time to collect","value":78},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1618]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":12377},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":46078918},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":1748313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4320184},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1748313}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":9065}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#206, Google) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2772}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":37601280},{"metricName":"number of input batches","value":306}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203, URL#205, Title#206] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":37601280},{"metricName":"time spent in job init","value":24974968},{"metricName":"time spent in decode_batch","value":5748975966},{"metricName":"time spent loading native vectors","value":28612652}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8176}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#218, Google) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3169}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":42147840},{"metricName":"number of input batches","value":343}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215, URL#217, Title#218] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":42147840},{"metricName":"time spent in job init","value":6220142},{"metricName":"time spent in decode_batch","value":5592963170},{"metricName":"time spent loading native vectors","value":31401313}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":9346}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#230, Google) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2807}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":45834240},{"metricName":"number of input batches","value":373}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227, URL#229, Title#230] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":45834240},{"metricName":"time spent in job init","value":6476136},{"metricName":"time spent in decode_batch","value":6661749926},{"metricName":"time spent loading native vectors","value":39228350}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":8653}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#242, Google) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3629}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":48510777},{"metricName":"number of input batches","value":395}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239, URL#241, Title#242] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":48510777},{"metricName":"time spent in job init","value":10042184},{"metricName":"time spent in decode_batch","value":5998088007},{"metricName":"time spent loading native vectors","value":35304484}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":79933,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#591L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#609,toprettystring(min(URL))#610,toprettystring(min(Title))#611,toprettystring(c)#612,toprettystring(count(DISTINCT UserID))#613])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":28}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1421]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24196093},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":78}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1377]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":180290855},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10890}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [rid#202L], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7419}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1105]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101991373},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2228691843},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":103815553},{"metricName":"local bytes read","value":1458579680},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2447793000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29730}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101991376}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102000441},{"metricName":"number of input batches","value":24922}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10546},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102000441}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false]),false), [plan_id=1293]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":22},{"metricName":"time to build","value":17},{"metricName":"time to collect","value":87},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=1142]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":12254},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":121982065},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":1748313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4279008},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1748313}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":9134}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#206, Google) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2772}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":37478400},{"metricName":"number of input batches","value":305}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203, URL#205, Title#206] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":37478400},{"metricName":"time spent in job init","value":15939164},{"metricName":"time spent in decode_batch","value":5750785273},{"metricName":"time spent loading native vectors","value":63821631}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8253}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#218, Google) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3078}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":41902080},{"metricName":"number of input batches","value":341}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215, URL#217, Title#218] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":41902080},{"metricName":"time spent in job init","value":5382650},{"metricName":"time spent in decode_batch","value":5723198231},{"metricName":"time spent loading native vectors","value":30629153}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":9330}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#230, Google) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2796}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":45465600},{"metricName":"number of input batches","value":370}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227, URL#229, Title#230] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":45465600},{"metricName":"time spent in job init","value":6320938},{"metricName":"time spent in decode_batch","value":6671937377},{"metricName":"time spent loading native vectors","value":29254173}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":8631}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#242, Google) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3608}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":48019257},{"metricName":"number of input batches","value":391}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239, URL#241, Title#242] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":48019257},{"metricName":"time spent in job init","value":6844970},{"metricName":"time spent in decode_batch","value":5977959238},{"metricName":"time spent loading native vectors","value":28800202}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":78574,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#1047L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#1065,toprettystring(min(URL))#1066,toprettystring(min(Title))#1067,toprettystring(c)#1068,toprettystring(count(DISTINCT UserID))#1069])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":26}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=3325]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12321968},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":58}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":5},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=3281]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":156022415},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10821}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [rid#202L], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7128}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=3009]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100292472},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2194493371},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":100095959},{"metricName":"local bytes read","value":1459678613},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2407019352},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28911}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100292473}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100296505},{"metricName":"number of input batches","value":24506}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9759},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100296505}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false]),false), [plan_id=3197]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":22},{"metricName":"time to build","value":10},{"metricName":"time to collect","value":51},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=3046]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9032},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":51527078},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":1748313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3170592},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1748313}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":9042}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#206, Google) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3202}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":46080000},{"metricName":"number of input batches","value":375}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203, URL#205, Title#206] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":46080000},{"metricName":"time spent in job init","value":25631134},{"metricName":"time spent in decode_batch","value":5708829153},{"metricName":"time spent loading native vectors","value":26006011}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8173}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#218, Google) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2148}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215, URL#217, Title#218] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":3436120},{"metricName":"time spent in decode_batch","value":3793828587},{"metricName":"time spent loading native vectors","value":20005945}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":9434}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#230, Google) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1536}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26542080},{"metricName":"number of input batches","value":216}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227, URL#229, Title#230] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":26542080},{"metricName":"time spent in job init","value":10155316},{"metricName":"time spent in decode_batch","value":4378437620},{"metricName":"time spent loading native vectors","value":33016644}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":8718}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#242, Google) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2146}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28481337},{"metricName":"number of input batches","value":232}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239, URL#241, Title#242] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":28481337},{"metricName":"time spent in job init","value":6396668},{"metricName":"time spent in decode_batch","value":4145977463},{"metricName":"time spent loading native vectors","value":24959616}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":78843,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#933L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#951,toprettystring(min(URL))#952,toprettystring(min(Title))#953,toprettystring(c)#954,toprettystring(count(DISTINCT UserID))#955])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":31}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2849]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":10058543},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":71}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":6},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2805]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":188078789},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10959}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1612185600},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [rid#202L], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7237}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2533]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101427005},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2235079337},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":102190128},{"metricName":"local bytes read","value":1498177296},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":72},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2434248144},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29095}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101427008}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101431097},{"metricName":"number of input batches","value":24783}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10090},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101431097}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false]),false), [plan_id=2721]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":21},{"metricName":"time to build","value":16},{"metricName":"time to collect","value":61},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=2570]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":10525},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":42885909},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":1748313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3697480},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1748313}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":9045}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#206, Google) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2872}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":41902080},{"metricName":"number of input batches","value":341}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203, URL#205, Title#206] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":41902080},{"metricName":"time spent in job init","value":30695016},{"metricName":"time spent in decode_batch","value":5718136706},{"metricName":"time spent loading native vectors","value":26150149}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8163}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#218, Google) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4288}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":47923200},{"metricName":"number of input batches","value":390}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215, URL#217, Title#218] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":47923200},{"metricName":"time spent in job init","value":8121054},{"metricName":"time spent in decode_batch","value":5567062305},{"metricName":"time spent loading native vectors","value":39677829}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":9340}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#230, Google) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1520}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"number of input batches","value":204}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227, URL#229, Title#230] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25067520},{"metricName":"time spent in job init","value":7278049},{"metricName":"time spent in decode_batch","value":4333473412},{"metricName":"time spent loading native vectors","value":19444776}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":8637}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#242, Google) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1845}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25286457},{"metricName":"number of input batches","value":206}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239, URL#241, Title#242] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":25286457},{"metricName":"time spent in job init","value":7126782},{"metricName":"time spent in decode_batch","value":4087076910},{"metricName":"time spent loading native vectors","value":22317590}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":78898,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#819L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#837,toprettystring(min(URL))#838,toprettystring(min(Title))#839,toprettystring(c)#840,toprettystring(count(DISTINCT UserID))#841])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":24}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2373]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":13390900},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":59}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2329]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":184243311},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10910}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [rid#202L], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7634}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2057]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":99998371},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2195541656},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":103224658},{"metricName":"local bytes read","value":1527021186},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":73},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2399960904},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28957}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":99998373}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100005689},{"metricName":"number of input batches","value":24435}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9957},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100005689}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(input[0, bigint, false]),false), [plan_id=2245]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":13},{"metricName":"time to build","value":14},{"metricName":"time to collect","value":68},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#202L, 200), ENSURE_REQUIREMENTS, [plan_id=2094]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":11440},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":43718385},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":1748313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3990544},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1748313}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":9058}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#206, Google) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2782}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":39936000},{"metricName":"number of input batches","value":325}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-0.any)[rid#202L, SearchPhrase#203, URL#205, Title#206] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":39936000},{"metricName":"time spent in job init","value":17378496},{"metricName":"time spent in decode_batch","value":5696470645},{"metricName":"time spent loading native vectors","value":30110462}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8270}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#218, Google) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3936}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":44482560},{"metricName":"number of input batches","value":362}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-1.any)[rid#214L, SearchPhrase#215, URL#217, Title#218] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":44482560},{"metricName":"time spent in job init","value":10051934},{"metricName":"time spent in decode_batch","value":5629430865},{"metricName":"time spent loading native vectors","value":27499197}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":9464}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#230, Google) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2877}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":48168960},{"metricName":"number of input batches","value":392}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-2.any)[rid#226L, SearchPhrase#227, URL#229, Title#230] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":48168960},{"metricName":"time spent in job init","value":6768372},{"metricName":"time spent in decode_batch","value":6757773827},{"metricName":"time spent loading native vectors","value":35635092}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":8647}],"children":[{"nodeName":"Filter","description":"Filter ((Contains(Title#242, Google) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = ))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1845}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"number of input batches","value":202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)","description":"BatchScan anyblox-sc(/data/ClickBench/hits-strings-3.any)[rid#238L, SearchPhrase#239, URL#241, Title#242] class org.anyblox.spark.AnyBloxScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":24794937},{"metricName":"time spent in job init","value":3820848},{"metricName":"time spent in decode_batch","value":4083721861},{"metricName":"time spent loading native vectors","value":19793141}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]