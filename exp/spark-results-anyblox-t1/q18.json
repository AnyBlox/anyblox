[{"totalTime":99113,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_totalprice#27 DESC NULLS LAST,o_orderdate#28 ASC NULLS FIRST], output=[toprettystring(c_name)#289,toprettystring(c_custkey)#290,toprettystring(o_orderkey)#291,toprettystring(o_orderdate)#292,toprettystring(o_totalprice)#293,toprettystring(sum(l_quantity))#294])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":32479}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, o_totalprice#27], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32443},{"metricName":"peak memory","value":1145307136},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":170}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, knownfloatingpointnormalized(normalizenanandzero(o_totalprice#27)) AS o_totalprice#27], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32393},{"metricName":"peak memory","value":4456448},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [o_orderkey#24], [l_orderkey#90], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":8967}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[2, int, true] as bigint)),false), [plan_id=2774]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":30},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=2715]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":9546832},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":68718},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":92232},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":68718}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":320}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#25], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2126]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":57558919},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":32713248},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":144000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32713248}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":885}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(c_custkey#0)","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1] Batched: true, DataFilters: [isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":77},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=2636]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":8},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":46},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=2480]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":74835650},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":93393},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":16},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":51240},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":93393}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":16367}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#259], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":967},{"metricName":"peak memory","value":3321888768},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":730856198},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=2143]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30788738},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":994398954},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32556234},{"metricName":"local bytes read","value":746426944},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":180},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1231549560},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":684773624}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8394}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_custkey#25) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30788739}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30791205},{"metricName":"number of input batches","value":7645}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_totalprice#27,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_custkey#25), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_custkey), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":924},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30791205}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":32576}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#259 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1074790400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#259]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#258) AND (sum(l_quantity#94)#258 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#259], functions=[sum(l_quantity#263)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8914},{"metricName":"peak memory","value":3120562176},{"metricName":"number of output rows","value":30000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":256}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#259, 200), ENSURE_REQUIREMENTS, [plan_id=2160]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30991305},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":286509411},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":62917120},{"metricName":"local bytes read","value":558159610},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":38},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":743791320},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":245890453}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20447}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#259], functions=[partial_sum(l_quantity#263)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29638},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":30991306},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":281089216},{"metricName":"number of input batches","value":2811}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#259, l_quantity#263] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":281089216},{"metricName":"time spent in job init","value":7265907},{"metricName":"time spent in decode_batch","value":1195097234},{"metricName":"time spent loading native vectors","value":196981619}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#259], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":8967},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4168},{"metricName":"peak memory","value":10133438464},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":839188600},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=2186]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":247244118},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1351313611},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":141585964},{"metricName":"local bytes read","value":906409509},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":20},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5933858832},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1545731587}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":17523}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":247394608},{"metricName":"number of input batches","value":2474}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_quantity#94] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":247394608},{"metricName":"time spent in job init","value":46987065},{"metricName":"time spent in decode_batch","value":1044380421},{"metricName":"time spent loading native vectors","value":156220519}],"children":[]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":64286}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#259 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1141964800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#259]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#258) AND (sum(l_quantity#94)#258 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#259], functions=[sum(l_quantity#263)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9108},{"metricName":"peak memory","value":3355443200},{"metricName":"number of output rows","value":30000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":272}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [l_orderkey#259, sum#308], Exchange hashpartitioning(l_orderkey#259, 200), ENSURE_REQUIREMENTS, [plan_id=2160]","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#259, 200), ENSURE_REQUIREMENTS, [plan_id=2160]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30991305},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":286509411},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":62917120},{"metricName":"local bytes read","value":558159610},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":38},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":743791320},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":245890453}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20447}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#259], functions=[partial_sum(l_quantity#263)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29638},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":30991306},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":281089216},{"metricName":"number of input batches","value":2811}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#259, l_quantity#263] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":281089216},{"metricName":"time spent in job init","value":7265907},{"metricName":"time spent in decode_batch","value":1195097234},{"metricName":"time spent loading native vectors","value":196981619}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":98073,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_totalprice#27 DESC NULLS LAST,o_orderdate#28 ASC NULLS FIRST], output=[toprettystring(c_name)#553,toprettystring(c_custkey)#554,toprettystring(o_orderkey)#555,toprettystring(o_orderdate)#556,toprettystring(o_totalprice)#557,toprettystring(sum(l_quantity))#558])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":32323}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, o_totalprice#27], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32297},{"metricName":"peak memory","value":1145307136},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":170}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, knownfloatingpointnormalized(normalizenanandzero(o_totalprice#27)) AS o_totalprice#27], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32269},{"metricName":"peak memory","value":4456448},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [o_orderkey#24], [l_orderkey#90], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":8967}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[2, int, true] as bigint)),false), [plan_id=6561]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":6},{"metricName":"time to collect","value":26},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=6502]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12649499},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":68718},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":92232},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":68718}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":328}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#25], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=5860]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3523718},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":67087023},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":32713248},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":169138512},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32713248}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":996}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(c_custkey#0)","metadata":{},"metrics":[{"metricName":"number of output rows","value":3523719}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3526451},{"metricName":"number of input batches","value":877}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1] Batched: true, DataFilters: [isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":172},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3526451}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=6423]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":7},{"metricName":"time to collect","value":38},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=6214]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":76210201},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":93393},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":16},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":51240},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":93393}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":16041}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#523], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":966},{"metricName":"peak memory","value":3321888768},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":730856198},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=5877]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":903648294},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32476373},{"metricName":"local bytes read","value":773868445},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":180},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1200000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":684773624}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8106}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_custkey#25) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_totalprice#27,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_custkey#25), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_custkey), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":780},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":31919}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#523 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1074790400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#523]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#522) AND (sum(l_quantity#94)#522 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#523], functions=[sum(l_quantity#527)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8882},{"metricName":"peak memory","value":3120562176},{"metricName":"number of output rows","value":30000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":256}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#523, 200), ENSURE_REQUIREMENTS, [plan_id=5894]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":60000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":410535417},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":62199139},{"metricName":"local bytes read","value":568054227},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":38},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1440000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":491780906}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":40566}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#523], functions=[partial_sum(l_quantity#527)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29488},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":60000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":325889216},{"metricName":"number of input batches","value":3259}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#523, l_quantity#527] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":325889216},{"metricName":"time spent in job init","value":9747928},{"metricName":"time spent in decode_batch","value":1335609025},{"metricName":"time spent loading native vectors","value":170455649}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#523], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":8967},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4161},{"metricName":"peak memory","value":10133438464},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":839188600},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=5920]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":186594608},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1172975773},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":141404142},{"metricName":"local bytes read","value":906523911},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":20},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4478270592},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1181846358}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":17693}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":186594608},{"metricName":"number of input batches","value":1866}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_quantity#94] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":186594608},{"metricName":"time spent in job init","value":26911688},{"metricName":"time spent in decode_batch","value":813630072},{"metricName":"time spent loading native vectors","value":114600130}],"children":[]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":63996}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#523 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1141964800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#523]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#522) AND (sum(l_quantity#94)#522 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#523], functions=[sum(l_quantity#527)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8989},{"metricName":"peak memory","value":3355443200},{"metricName":"number of output rows","value":30000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":272}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [l_orderkey#523, sum#572], Exchange hashpartitioning(l_orderkey#523, 200), ENSURE_REQUIREMENTS, [plan_id=5894]","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#523, 200), ENSURE_REQUIREMENTS, [plan_id=5894]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":60000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":410535417},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":62199139},{"metricName":"local bytes read","value":568054227},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":38},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1440000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":491780906}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":40566}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#523], functions=[partial_sum(l_quantity#527)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29488},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":60000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":325889216},{"metricName":"number of input batches","value":3259}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#523, l_quantity#527] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":325889216},{"metricName":"time spent in job init","value":9747928},{"metricName":"time spent in decode_batch","value":1335609025},{"metricName":"time spent loading native vectors","value":170455649}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":97917,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_totalprice#27 DESC NULLS LAST,o_orderdate#28 ASC NULLS FIRST], output=[toprettystring(c_name)#487,toprettystring(c_custkey)#488,toprettystring(o_orderkey)#489,toprettystring(o_orderdate)#490,toprettystring(o_totalprice)#491,toprettystring(sum(l_quantity))#492])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":32282}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, o_totalprice#27], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32254},{"metricName":"peak memory","value":1145307136},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":170}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, knownfloatingpointnormalized(normalizenanandzero(o_totalprice#27)) AS o_totalprice#27], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32216},{"metricName":"peak memory","value":4456448},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [o_orderkey#24], [l_orderkey#90], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":8967}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[2, int, true] as bigint)),false), [plan_id=5601]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":8},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":32},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=5542]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12378294},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":68718},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":92232},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":68718}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":321}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#25], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=4900]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":58125111},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":32713248},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":144000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32713248}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":796}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(c_custkey#0)","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1] Batched: true, DataFilters: [isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":74},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=5463]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":2},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":28},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=5254]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":72413172},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":93393},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":16},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":51240},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":93393}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":16168}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#457], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":966},{"metricName":"peak memory","value":3321888768},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":730856198},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=4917]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30623233},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":913184017},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32624284},{"metricName":"local bytes read","value":773817917},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":180},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1224929360},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":684773624}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8219}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_custkey#25) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30623234}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30624295},{"metricName":"number of input batches","value":7604}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_totalprice#27,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_custkey#25), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_custkey), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":832},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30624295}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":32157}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#457 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1074790400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#457]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#456) AND (sum(l_quantity#94)#456 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#457], functions=[sum(l_quantity#461)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8979},{"metricName":"peak memory","value":3120562176},{"metricName":"number of output rows","value":30000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":256}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#457, 200), ENSURE_REQUIREMENTS, [plan_id=4934]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":50508143},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":365274049},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":62880196},{"metricName":"local bytes read","value":568038903},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":38},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1212195456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":401333604}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20353}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#457], functions=[partial_sum(l_quantity#461)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29518},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":50508144},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":307289216},{"metricName":"number of input batches","value":3073}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#457, l_quantity#461] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":307289216},{"metricName":"time spent in job init","value":35060193},{"metricName":"time spent in decode_batch","value":1242312510},{"metricName":"time spent loading native vectors","value":169979885}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#457], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":8967},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4165},{"metricName":"peak memory","value":10133438464},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":839188600},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=4960]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":174998354},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1083470886},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":141600729},{"metricName":"local bytes read","value":906515594},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":20},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4199960520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1098078851}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":17436}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":175094608},{"metricName":"number of input batches","value":1751}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_quantity#94] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":175094608},{"metricName":"time spent in job init","value":26871364},{"metricName":"time spent in decode_batch","value":771021761},{"metricName":"time spent loading native vectors","value":100913214}],"children":[]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":63892}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#457 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1141964800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#457]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#456) AND (sum(l_quantity#94)#456 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#457], functions=[sum(l_quantity#461)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9034},{"metricName":"peak memory","value":3355443200},{"metricName":"number of output rows","value":30000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":272}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [l_orderkey#457, sum#506], Exchange hashpartitioning(l_orderkey#457, 200), ENSURE_REQUIREMENTS, [plan_id=4934]","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#457, 200), ENSURE_REQUIREMENTS, [plan_id=4934]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":50508143},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":365274049},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":62880196},{"metricName":"local bytes read","value":568038903},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":38},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1212195456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":401333604}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20353}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#457], functions=[partial_sum(l_quantity#461)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29518},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":50508144},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":307289216},{"metricName":"number of input batches","value":3073}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#457, l_quantity#461] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":307289216},{"metricName":"time spent in job init","value":35060193},{"metricName":"time spent in decode_batch","value":1242312510},{"metricName":"time spent loading native vectors","value":169979885}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":98417,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_totalprice#27 DESC NULLS LAST,o_orderdate#28 ASC NULLS FIRST], output=[toprettystring(c_name)#421,toprettystring(c_custkey)#422,toprettystring(o_orderkey)#423,toprettystring(o_orderdate)#424,toprettystring(o_totalprice)#425,toprettystring(sum(l_quantity))#426])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":32361}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, o_totalprice#27], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32337},{"metricName":"peak memory","value":1145307136},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":170}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, knownfloatingpointnormalized(normalizenanandzero(o_totalprice#27)) AS o_totalprice#27], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32292},{"metricName":"peak memory","value":4456448},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [o_orderkey#24], [l_orderkey#90], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":9443}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[2, int, true] as bigint)),false), [plan_id=4641]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":6},{"metricName":"time to collect","value":37},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=4582]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":14517711},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":68718},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":92232},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":68718}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":408}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#25], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3993]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":60047689},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":32713248},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":144000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32713248}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":840}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(c_custkey#0)","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1] Batched: true, DataFilters: [isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":68},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=4503]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":5},{"metricName":"time to collect","value":28},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=4347]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":76011346},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":93393},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":16},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":51240},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":93393}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":16204}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#391], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":966},{"metricName":"peak memory","value":3321888768},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":730856198},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=4010]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":31259139},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":933104118},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":31950024},{"metricName":"local bytes read","value":729283047},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":170},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1250365600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":684773624}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8254}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_custkey#25) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":31259140}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":31263016},{"metricName":"number of input batches","value":7762}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_totalprice#27,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_custkey#25), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_custkey), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":836},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":31263016}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":32223}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#391 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1074790400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#391]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#390) AND (sum(l_quantity#94)#390 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1364}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#391], functions=[sum(l_quantity#395)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9532},{"metricName":"peak memory","value":3321888768},{"metricName":"number of output rows","value":31845241},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":272}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#391, 200), ENSURE_REQUIREMENTS, [plan_id=4027]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":42390717},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":332760809},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":65505962},{"metricName":"local bytes read","value":561858669},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":38},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1017377208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":320838569}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20465}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#391], functions=[partial_sum(l_quantity#395)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29556},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":42390717},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":299689216},{"metricName":"number of input batches","value":2997}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#391, l_quantity#395] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":299689216},{"metricName":"time spent in job init","value":15612411},{"metricName":"time spent in decode_batch","value":1208210776},{"metricName":"time spent loading native vectors","value":165529873}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#391], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":9443},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4371},{"metricName":"peak memory","value":10670309376},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":839188600},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=4053]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":277063307},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1461429050},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":141957331},{"metricName":"local bytes read","value":937197935},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":21},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6649519416},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1745295830}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":17470}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":277094608},{"metricName":"number of input batches","value":2771}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_quantity#94] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":277094608},{"metricName":"time spent in job init","value":14889633},{"metricName":"time spent in decode_batch","value":1220317300},{"metricName":"time spent loading native vectors","value":162483837}],"children":[]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":64056}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#391 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1209139200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#391]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#390) AND (sum(l_quantity#94)#390 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1364}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#391], functions=[sum(l_quantity#395)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9535},{"metricName":"peak memory","value":3556769792},{"metricName":"number of output rows","value":31800212},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":288}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [l_orderkey#391, sum#440], Exchange hashpartitioning(l_orderkey#391, 200), ENSURE_REQUIREMENTS, [plan_id=4027]","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#391, 200), ENSURE_REQUIREMENTS, [plan_id=4027]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":42390717},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":332760809},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":65505962},{"metricName":"local bytes read","value":561858669},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":38},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1017377208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":320838569}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20465}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#391], functions=[partial_sum(l_quantity#395)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29556},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":42390717},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":299689216},{"metricName":"number of input batches","value":2997}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#391, l_quantity#395] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":299689216},{"metricName":"time spent in job init","value":15612411},{"metricName":"time spent in decode_batch","value":1208210776},{"metricName":"time spent loading native vectors","value":165529873}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":98671,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_totalprice#27 DESC NULLS LAST,o_orderdate#28 ASC NULLS FIRST], output=[toprettystring(c_name)#355,toprettystring(c_custkey)#356,toprettystring(o_orderkey)#357,toprettystring(o_orderdate)#358,toprettystring(o_totalprice)#359,toprettystring(sum(l_quantity))#360])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":32267}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, o_totalprice#27], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32240},{"metricName":"peak memory","value":1145307136},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":170}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_name#1, c_custkey#0, o_orderkey#24, o_orderdate#28, knownfloatingpointnormalized(normalizenanandzero(o_totalprice#27)) AS o_totalprice#27], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32197},{"metricName":"peak memory","value":4456448},{"metricName":"number of output rows","value":1281},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [o_orderkey#24], [l_orderkey#90], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":8967}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[2, int, true] as bigint)),false), [plan_id=3734]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":3},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":41},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=3675]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":14302097},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":68718},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":92232},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":68718}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":325}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, o_orderkey#24, o_totalprice#27, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#25], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3033]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":66297907},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":32713248},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":144000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32713248}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":930}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(c_custkey#0)","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1] Batched: true, DataFilters: [isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":59},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=3596]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":38},{"metricName":"number of output rows","value":1281},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=3387]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1281},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":75938130},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1281},{"metricName":"local bytes read","value":93393},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":16},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":51240},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":93393}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":16096}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#325], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":966},{"metricName":"peak memory","value":3321888768},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":730856198},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=3050]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30076434},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":973910545},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":31949763},{"metricName":"local bytes read","value":729274554},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":170},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1203057360},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":684773624}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8538}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_custkey#25) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30076435}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30077824},{"metricName":"number of input batches","value":7468}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_totalprice#27,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_custkey#25), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_custkey), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_totalprice:double,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":922},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30077824}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":32040}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#325 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1074790400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#325]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#324) AND (sum(l_quantity#94)#324 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#325], functions=[sum(l_quantity#329)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8909},{"metricName":"peak memory","value":3120562176},{"metricName":"number of output rows","value":30000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":256}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":16},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":16}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#325, 200), ENSURE_REQUIREMENTS, [plan_id=3067]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":34235035},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":301881340},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":60500395},{"metricName":"local bytes read","value":552008869},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":37},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":821640864},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":269038795}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20375}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#325], functions=[partial_sum(l_quantity#329)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29506},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":34235036},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":285989216},{"metricName":"number of input batches","value":2860}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#325, l_quantity#329] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":285989216},{"metricName":"time spent in job init","value":51969447},{"metricName":"time spent in decode_batch","value":1165826407},{"metricName":"time spent loading native vectors","value":147577756}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#325], LeftSemi","metadata":{},"metrics":[{"metricName":"number of output rows","value":8967},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3714},{"metricName":"peak memory","value":9059696640},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":839188600},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=3093]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":255040170},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1373099989},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":128097274},{"metricName":"local bytes read","value":906429073},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":20},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6120964104},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1615838651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":17581}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":255094608},{"metricName":"number of input batches","value":2551}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_quantity#94] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":255094608},{"metricName":"time spent in job init","value":14443395},{"metricName":"time spent in decode_batch","value":1153311502},{"metricName":"time spent loading native vectors","value":159727570}],"children":[]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":63902}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#325 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1141964800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#325]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum(l_quantity#94)#324) AND (sum(l_quantity#94)#324 > 300.0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1281}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#325], functions=[sum(l_quantity#329)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8976},{"metricName":"peak memory","value":3355443200},{"metricName":"number of output rows","value":30000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":272}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":17},{"metricName":"partition data size","value":267391200},{"metricName":"number of coalesced partitions","value":17}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [l_orderkey#325, sum#374], Exchange hashpartitioning(l_orderkey#325, 200), ENSURE_REQUIREMENTS, [plan_id=3067]","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#325, 200), ENSURE_REQUIREMENTS, [plan_id=3067]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":34235035},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":301881340},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":60500395},{"metricName":"local bytes read","value":552008869},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":37},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":821640864},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":269038795}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20375}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#325], functions=[partial_sum(l_quantity#329)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29506},{"metricName":"peak memory","value":5100273664},{"metricName":"number of output rows","value":34235036},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":285989216},{"metricName":"number of input batches","value":2860}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#325, l_quantity#329] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":285989216},{"metricName":"time spent in job init","value":51969447},{"metricName":"time spent in decode_batch","value":1165826407},{"metricName":"time spent loading native vectors","value":147577756}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]