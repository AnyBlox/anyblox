[{"totalTime":31493,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=20, orderBy=[revenue#230 DESC NULLS LAST], output=[toprettystring(c_custkey)#248,toprettystring(c_name)#249,toprettystring(revenue)#250,toprettystring(c_acctbal)#251,toprettystring(n_name)#252,toprettystring(c_address)#253,toprettystring(c_phone)#254,toprettystring(c_comment)#255])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":1042}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":851},{"metricName":"peak memory","value":301989888},{"metricName":"number of output rows","value":763483},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":30}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":133555803},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7, 200), ENSURE_REQUIREMENTS, [plan_id=1814]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1017111},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":222956323},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":954152},{"metricName":"local bytes read","value":127320121},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":18},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":230136776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":127320121}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":9963}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, knownfloatingpointnormalized(normalizenanandzero(c_acctbal#5)) AS c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9737},{"metricName":"peak memory","value":690487296},{"metricName":"number of output rows","value":1017112},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":149}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2553123}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":2553123},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":9772}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":21},{"metricName":"peak memory","value":750780416},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":151330498},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=1673]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":221750795},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1277153},{"metricName":"local bytes read","value":160359097},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":60},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":247920176},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":143878760}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":3356}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1222}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":57},{"metricName":"peak memory","value":956301312},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":367173042},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=1398]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3447004},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":480632896},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":350310598},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":12},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":718254792},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":350310598}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":4285}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3447005}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3450755},{"metricName":"number of input batches","value":858}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1,c_address#2,c_nationkey#3,c_phone#4,c_acctbal#5,c_comment#7] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:doub...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:double,c_comment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":870},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3450755}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5472}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":17},{"metricName":"peak memory","value":452984832},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":13500370},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=1417]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":122671667},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1145890},{"metricName":"local bytes read","value":12879093},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":60},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":27501360},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12879093}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1338}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1993-10-01)) AND (o_orderdate#28 < 1994-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":640},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":983},{"metricName":"peak memory","value":2684354560},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":430636400},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=1442]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":51455551},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":689428624},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":33013273},{"metricName":"local bytes read","value":461949717},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1646577632},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":684377890}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":9288}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, l_returnflag#98, 1, true, false, true) = R)","metadata":{},"metrics":[{"metricName":"number of output rows","value":51455551}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":208494608},{"metricName":"number of input batches","value":2085}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_extendedprice#95, l_discount#96, l_returnflag#98] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":208494608},{"metricName":"time spent in job init","value":9720056},{"metricName":"time spent in decode_batch","value":1802772802},{"metricName":"time spent loading native vectors","value":251000101}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1462]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":8},{"metricName":"time to build","value":6},{"metricName":"time to collect","value":4717},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":12}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":30856,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=20, orderBy=[revenue#442 DESC NULLS LAST], output=[toprettystring(c_custkey)#460,toprettystring(c_name)#461,toprettystring(revenue)#462,toprettystring(c_acctbal)#463,toprettystring(n_name)#464,toprettystring(c_address)#465,toprettystring(c_phone)#466,toprettystring(c_comment)#467])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":1058}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":869},{"metricName":"peak memory","value":301989888},{"metricName":"number of output rows","value":763483},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":30}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":133555803},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7, 200), ENSURE_REQUIREMENTS, [plan_id=4254]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":954152},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":218147675},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":954152},{"metricName":"local bytes read","value":127320121},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":18},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":215894952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":127320121}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":9739}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, knownfloatingpointnormalized(normalizenanandzero(c_acctbal#5)) AS c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8576},{"metricName":"peak memory","value":621281280},{"metricName":"number of output rows","value":954152},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":134}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2290399}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":2290399},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":8569}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":23},{"metricName":"peak memory","value":750780416},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":151330498},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=4113]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":220658279},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1277782},{"metricName":"local bytes read","value":160428059},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":60},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":247920176},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":143878760}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":3299}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1181}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":57},{"metricName":"peak memory","value":956301312},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":367173042},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3838]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":471313427},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3048730},{"metricName":"local bytes read","value":411611196},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":14},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":625114384},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":350310598}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":4305}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1,c_address#2,c_nationkey#3,c_phone#4,c_acctbal#5,c_comment#7] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:doub...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:double,c_comment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":665},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5410}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":17},{"metricName":"peak memory","value":452984832},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":13500370},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=3857]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":104865335},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1145890},{"metricName":"local bytes read","value":15132220},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":27501360},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12879093}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1298}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1993-10-01)) AND (o_orderdate#28 < 1994-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":625},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":879},{"metricName":"peak memory","value":2415919104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":430636400},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=3882]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":31537028},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":512179156},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32646879},{"metricName":"local bytes read","value":462074434},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1009184896},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":414351339}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":9162}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, l_returnflag#98, 1, true, false, true) = R)","metadata":{},"metrics":[{"metricName":"number of output rows","value":31537028}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":127794608},{"metricName":"number of input batches","value":1278}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_extendedprice#95, l_discount#96, l_returnflag#98] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":127794608},{"metricName":"time spent in job init","value":20845214},{"metricName":"time spent in decode_batch","value":1052500552},{"metricName":"time spent loading native vectors","value":95050240}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3902]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":3},{"metricName":"time to build","value":8},{"metricName":"time to collect","value":4698},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":12}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":30784,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=20, orderBy=[revenue#389 DESC NULLS LAST], output=[toprettystring(c_custkey)#407,toprettystring(c_name)#408,toprettystring(revenue)#409,toprettystring(c_acctbal)#410,toprettystring(n_name)#411,toprettystring(c_address)#412,toprettystring(c_phone)#413,toprettystring(c_comment)#414])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":1041}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":854},{"metricName":"peak memory","value":301989888},{"metricName":"number of output rows","value":763483},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":30}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":133555803},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7, 200), ENSURE_REQUIREMENTS, [plan_id=3644]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":954152},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":216684242},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":954152},{"metricName":"local bytes read","value":127320121},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":18},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":215894952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":127320121}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":9948}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, knownfloatingpointnormalized(normalizenanandzero(c_acctbal#5)) AS c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8794},{"metricName":"peak memory","value":621281280},{"metricName":"number of output rows","value":954152},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":134}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2290399}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":2290399},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":8788}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":28},{"metricName":"peak memory","value":750780416},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":151330498},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=3503]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":220585043},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1277359},{"metricName":"local bytes read","value":160385832},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":60},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":247920176},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":143878760}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":3268}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1163}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":56},{"metricName":"peak memory","value":956301312},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":367173042},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3228]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":439340633},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3096555},{"metricName":"local bytes read","value":411705148},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":14},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":625114384},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":350310598}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":4214}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1,c_address#2,c_nationkey#3,c_phone#4,c_acctbal#5,c_comment#7] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:doub...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:double,c_comment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":642},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5355}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":17},{"metricName":"peak memory","value":452984832},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":13500370},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=3247]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":104779500},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1145890},{"metricName":"local bytes read","value":15139902},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":27501360},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12879093}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1188}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1993-10-01)) AND (o_orderdate#28 < 1994-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":571},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":878},{"metricName":"peak memory","value":2415919104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":430636400},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=3272]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":35660796},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":551511215},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":31708950},{"metricName":"local bytes read","value":461985749},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1141145472},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":455109096}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":9097}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, l_returnflag#98, 1, true, false, true) = R)","metadata":{},"metrics":[{"metricName":"number of output rows","value":35660796}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":144494608},{"metricName":"number of input batches","value":1445}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_extendedprice#95, l_discount#96, l_returnflag#98] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":144494608},{"metricName":"time spent in job init","value":25409948},{"metricName":"time spent in decode_batch","value":1208780984},{"metricName":"time spent loading native vectors","value":107738704}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3292]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":4},{"metricName":"time to collect","value":4622},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":2},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":31160,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=20, orderBy=[revenue#336 DESC NULLS LAST], output=[toprettystring(c_custkey)#354,toprettystring(c_name)#355,toprettystring(revenue)#356,toprettystring(c_acctbal)#357,toprettystring(n_name)#358,toprettystring(c_address)#359,toprettystring(c_phone)#360,toprettystring(c_comment)#361])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":1056}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":871},{"metricName":"peak memory","value":301989888},{"metricName":"number of output rows","value":763483},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":30}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":133555803},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7, 200), ENSURE_REQUIREMENTS, [plan_id=3034]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":954152},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":216554499},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":954152},{"metricName":"local bytes read","value":127320121},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":18},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":215894952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":127320121}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":9850}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, knownfloatingpointnormalized(normalizenanandzero(c_acctbal#5)) AS c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8669},{"metricName":"peak memory","value":621281280},{"metricName":"number of output rows","value":954152},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":134}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2290399}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":2290399},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":8674}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":28},{"metricName":"peak memory","value":746586112},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":151330498},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=2893]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1236566},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":225490023},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1237606},{"metricName":"local bytes read","value":155394654},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":60},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":267531984},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":143878760}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":3250}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1236567},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1158}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":63},{"metricName":"peak memory","value":1107296256},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":367173042},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2618]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":443571542},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3375900},{"metricName":"local bytes read","value":394198194},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":14},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":625114384},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":350310598}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":4299}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1,c_address#2,c_nationkey#3,c_phone#4,c_acctbal#5,c_comment#7] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:doub...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:double,c_comment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":704},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5327}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":19},{"metricName":"peak memory","value":528482304},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":13500370},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=2637]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":148206494},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1289513},{"metricName":"local bytes read","value":14492563},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":27501360},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12879093}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1348}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1993-10-01)) AND (o_orderdate#28 < 1994-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":642},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":883},{"metricName":"peak memory","value":2415919104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":430636400},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=2662]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":39139440},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":600149918},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":30889518},{"metricName":"local bytes read","value":447475460},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1252462080},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":500978831}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":9244}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, l_returnflag#98, 1, true, false, true) = R)","metadata":{},"metrics":[{"metricName":"number of output rows","value":39139440}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":158594608},{"metricName":"number of input batches","value":1586}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_extendedprice#95, l_discount#96, l_returnflag#98] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":158594608},{"metricName":"time spent in job init","value":23606748},{"metricName":"time spent in decode_batch","value":1301210559},{"metricName":"time spent loading native vectors","value":142446924}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2682]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":12},{"metricName":"time to collect","value":4722},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":13}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":13},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":31943,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=20, orderBy=[revenue#283 DESC NULLS LAST], output=[toprettystring(c_custkey)#301,toprettystring(c_name)#302,toprettystring(revenue)#303,toprettystring(c_acctbal)#304,toprettystring(n_name)#305,toprettystring(c_address)#306,toprettystring(c_phone)#307,toprettystring(c_comment)#308])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":1106}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":917},{"metricName":"peak memory","value":301989888},{"metricName":"number of output rows","value":763483},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":30}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":2},{"metricName":"partition data size","value":133555803},{"metricName":"number of coalesced partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, c_name#1, c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7, 200), ENSURE_REQUIREMENTS, [plan_id=2424]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":954152},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":221563384},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1136535},{"metricName":"local bytes read","value":190870879},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":27},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":215894952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":127320121}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":9895}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[c_custkey#0, c_name#1, knownfloatingpointnormalized(normalizenanandzero(c_acctbal#5)) AS c_acctbal#5, c_phone#4, n_name#17, c_address#2, c_comment#7], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":8696},{"metricName":"peak memory","value":621281280},{"metricName":"number of output rows","value":954152},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":134}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2290399}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":2290399},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":8702}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":23},{"metricName":"peak memory","value":675282944},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":151330498},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=2283]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":225989022},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1232615},{"metricName":"local bytes read","value":160387060},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":60},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":247920176},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":143878760}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":3389}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0, c_name#1, c_address#2, c_nationkey#3, c_phone#4, c_acctbal#5, c_comment#7, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1282}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":57},{"metricName":"peak memory","value":956301312},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":367173042},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2008]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3898375},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":517357374},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":350310598},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":12},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":812334600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":350310598}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":4384}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3898376}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3900975},{"metricName":"number of input batches","value":970}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_name#1,c_address#2,c_nationkey#3,c_phone#4,c_acctbal#5,c_comment#7] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:doub...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_name:string,c_address:string,c_nationkey:int,c_phone:string,c_acctbal:double,c_comment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1015},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3900975}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":5498}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":17},{"metricName":"peak memory","value":452984832},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":6},{"metricName":"partition data size","value":13500370},{"metricName":"number of coalesced partitions","value":6}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=2027]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1145890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":172304740},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1145890},{"metricName":"local bytes read","value":12879093},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":60},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":27501360},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12879093}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1606}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1993-10-01)) AND (o_orderdate#28 < 1994-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1145890}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1993-10-01), LessThan(o_orderdate,1994-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1993-10-01), (o_orderdate#28 < 1994-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":804},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":881},{"metricName":"peak memory","value":2415919104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":9},{"metricName":"partition data size","value":430636400},{"metricName":"number of coalesced partitions","value":9}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=2052]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":44232117},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":621275131},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":29611797},{"metricName":"local bytes read","value":461997445},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1415427744},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":592698762}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":9351}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, l_returnflag#98, 1, true, false, true) = R)","metadata":{},"metrics":[{"metricName":"number of output rows","value":44232117}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":179294608},{"metricName":"number of input batches","value":1793}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_extendedprice#95, l_discount#96, l_returnflag#98] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":179294608},{"metricName":"time spent in job init","value":14693846},{"metricName":"time spent in decode_batch","value":1541353079},{"metricName":"time spent loading native vectors","value":183140803}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2072]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":4},{"metricName":"time to build","value":30},{"metricName":"time to collect","value":4768},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":14}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":14},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]