[{"totalTime":17023,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#195,toprettystring(s_address)#196])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":112}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [ps_suppkey#61], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=2600]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":42041610},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10392698},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10392698}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":296}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#79)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":114},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3583]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":25},{"metricName":"time to build","value":44},{"metricName":"time to collect","value":66},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=3537]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":9594810},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":613852},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":613852}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":80}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#61]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60, ps_suppkey#61], [l_partkey#91, l_suppkey#92], Inner, BuildLeft, (cast(ps_availqty#62 as double) > (0.5 * sum(l_quantity))#190), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=3434]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":38},{"metricName":"time to build","value":77},{"metricName":"time to collect","value":2442},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=3330]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":173856},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":43056026},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3011279},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5563392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3011279}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2015}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":173856}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=2674]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":339215075},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":219137025},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":7},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219137025}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3765}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#62) AND isnotnull(ps_partkey#60)) AND isnotnull(ps_suppkey#61))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_availqty#62] Batched: true, DataFilters: [isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":392},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3143]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":14},{"metricName":"time to build","value":17},{"metricName":"time to collect","value":6298},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=2693]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":34905177},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":515}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":249},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=3359]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":42247433},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":1871724},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1871724}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2301}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#190)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2220},{"metricName":"peak memory","value":272629760},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":60}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2194},{"metricName":"peak memory","value":269484032},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":40}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":245817}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":265325003},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=2717]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18781213},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":309114939},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":22666216},{"metricName":"local bytes read","value":307173220},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":600998848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":245786172}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":6148}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_suppkey#92, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1994-01-01) AND (l_shipdate#100 < 1995-01-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18781214}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":123894608},{"metricName":"number of input batches","value":1239}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_suppkey#92, l_quantity#94, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":123894608},{"metricName":"time spent in job init","value":24070562},{"metricName":"time spent in decode_batch","value":822131652},{"metricName":"time spent loading native vectors","value":139857420}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#42], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3143]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3143]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":14},{"metricName":"time to build","value":17},{"metricName":"time to collect","value":6298},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=2693]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":34905177},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":515}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":249},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2778]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":10},{"metricName":"time to collect","value":517},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":15}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = CANADA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":15},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":14996,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#319,toprettystring(s_address)#320])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":88}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [ps_suppkey#61], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=7442]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":21029816},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10392698},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10392698}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":224}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#79)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":54},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8425]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":20},{"metricName":"time to collect","value":43},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=8379]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":13519014},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":613852},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":613852}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":71}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#61]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60, ps_suppkey#61], [l_partkey#91, l_suppkey#92], Inner, BuildLeft, (cast(ps_availqty#62 as double) > (0.5 * sum(l_quantity))#314), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=8276]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":30},{"metricName":"time to build","value":31},{"metricName":"time to collect","value":2192},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=8172]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":214008},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":57815072},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3011279},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6848256},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3011279}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":1772}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":214008}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=7516]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18215375},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":338216887},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":19684470},{"metricName":"local bytes read","value":284105479},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":9},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":582892032},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219137025}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3334}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#62) AND isnotnull(ps_partkey#60)) AND isnotnull(ps_suppkey#61))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18215376}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":18218847},{"metricName":"number of input batches","value":4532}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_availqty#62] Batched: true, DataFilters: [isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":287},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":18218847}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7985]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":13},{"metricName":"time to build","value":12},{"metricName":"time to collect","value":5746},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=7535]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":18734259},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":448}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":207},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=8201]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":36739079},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":1871724},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1871724}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2058}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#314)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2012},{"metricName":"peak memory","value":272629760},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":60}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1990},{"metricName":"peak memory","value":269484032},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":40}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":265325003},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=7559]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18195269},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":310318667},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":245786172},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":582248608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":245786172}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":5574}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_suppkey#92, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1994-01-01) AND (l_shipdate#100 < 1995-01-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18195269}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_suppkey#92, l_quantity#94, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":2660771},{"metricName":"time spent in decode_batch","value":702593620},{"metricName":"time spent loading native vectors","value":91083863}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#42], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7985]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7985]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":13},{"metricName":"time to build","value":12},{"metricName":"time to collect","value":5746},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=7535]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":18734259},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":448}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":207},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7620]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":375},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":12}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = CANADA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":14920,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#288,toprettystring(s_address)#289])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":59}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [ps_suppkey#61], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=6208]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":20324804},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10392698},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10392698}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":236}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#79)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":59},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7243]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":22},{"metricName":"time to collect","value":43},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=7197]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":9482583},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":613852},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":613852}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":51}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#61]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60, ps_suppkey#61], [l_partkey#91, l_suppkey#92], Inner, BuildLeft, (cast(ps_availqty#62 as double) > (0.5 * sum(l_quantity))#283), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=7094]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":31},{"metricName":"time to build","value":44},{"metricName":"time to collect","value":2236},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=6938]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":173856},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":40727609},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3011279},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5563392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3011279}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":1696}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":173856}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=6282]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":321720320},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":219137025},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":7},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219137025}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3204}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#62) AND isnotnull(ps_partkey#60)) AND isnotnull(ps_suppkey#61))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_availqty#62] Batched: true, DataFilters: [isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":268},{"metricName":"metadata time","value":7},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6751]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6},{"metricName":"time to build","value":7},{"metricName":"time to collect","value":5844},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=6301]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22721018},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":450}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":201},{"metricName":"metadata time","value":1},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=6967]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":37455677},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":1871724},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1871724}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2100}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#283)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2038},{"metricName":"peak memory","value":272629760},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":60}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2010},{"metricName":"peak memory","value":269484032},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":40}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":265325003},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=6325]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":24900010},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":370623312},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":245786172},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":796800320},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":329159557}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":5686}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_suppkey#92, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1994-01-01) AND (l_shipdate#100 < 1995-01-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":24900010}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":164194608},{"metricName":"number of input batches","value":1642}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_suppkey#92, l_quantity#94, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":164194608},{"metricName":"time spent in job init","value":22869448},{"metricName":"time spent in decode_batch","value":951293807},{"metricName":"time spent loading native vectors","value":119042529}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#42], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6751]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6751]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6},{"metricName":"time to build","value":7},{"metricName":"time to collect","value":5844},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=6301]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22721018},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":450}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":201},{"metricName":"metadata time","value":1},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6386]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":17},{"metricName":"time to collect","value":388},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = CANADA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":15413,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#257,toprettystring(s_address)#258])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":93}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [ps_suppkey#61], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=5026]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":20211601},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10392698},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10392698}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":240}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#79)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":71},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6009]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":14},{"metricName":"time to build","value":19},{"metricName":"time to collect","value":41},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=5963]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11562613},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":613852},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":613852}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":57}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#61]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60, ps_suppkey#61], [l_partkey#91, l_suppkey#92], Inner, BuildLeft, (cast(ps_availqty#62 as double) > (0.5 * sum(l_quantity))#252), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=5860]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":31},{"metricName":"time to build","value":33},{"metricName":"time to collect","value":2394},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=5756]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":219800},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":61922089},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3011279},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7033600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3011279}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":1663}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":219800}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=5100]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16966672},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":336537878},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":20218235},{"metricName":"local bytes read","value":283700812},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":9},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":542933536},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219137025}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3435}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#62) AND isnotnull(ps_partkey#60)) AND isnotnull(ps_suppkey#61))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16966673}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16967920},{"metricName":"number of input batches","value":4220}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_availqty#62] Batched: true, DataFilters: [isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":359},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16967920}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5569]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":14},{"metricName":"time to build","value":16},{"metricName":"time to collect","value":5875},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=5119]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":18933595},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":441}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":199},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=5785]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":52661721},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":1871724},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1871724}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2257}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#252)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2146},{"metricName":"peak memory","value":272629760},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":60}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2120},{"metricName":"peak memory","value":269484032},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":40}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":265325003},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=5143]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18195269},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":314080105},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":245786172},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":582248608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":245786172}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":5720}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_suppkey#92, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1994-01-01) AND (l_shipdate#100 < 1995-01-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18195269}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_suppkey#92, l_quantity#94, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":8791426},{"metricName":"time spent in decode_batch","value":719815598},{"metricName":"time spent loading native vectors","value":103131698}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#42], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5569]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5569]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":14},{"metricName":"time to build","value":16},{"metricName":"time to collect","value":5875},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=5119]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":18933595},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":441}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":199},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5204]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":4},{"metricName":"time to build","value":22},{"metricName":"time to collect","value":379},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = CANADA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":15956,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#226,toprettystring(s_address)#227])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":95}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_address#78, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [ps_suppkey#61], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=3782]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24688815},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10392698},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10392698}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":304}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#79)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":134},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4827]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":24},{"metricName":"time to build","value":41},{"metricName":"time to collect","value":57},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=4781]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":13586959},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":613852},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":613852}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":101}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#61]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60, ps_suppkey#61], [l_partkey#91, l_suppkey#92], Inner, BuildLeft, (cast(ps_availqty#62 as double) > (0.5 * sum(l_quantity))#221), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=4678]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":46},{"metricName":"time to build","value":47},{"metricName":"time to collect","value":2294},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, ps_suppkey#61, 200), ENSURE_REQUIREMENTS, [plan_id=4574]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":173856},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":54893748},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3011279},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5563392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3011279}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2046}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#60], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":173856}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=3856]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":307244487},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":219137025},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":7},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219137025}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3235}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#62) AND isnotnull(ps_partkey#60)) AND isnotnull(ps_suppkey#61))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_availqty#62] Batched: true, DataFilters: [isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#62), isnotnull(ps_partkey#60), isnotnull(ps_suppkey#61)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":331},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4325]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":16},{"metricName":"time to build","value":12},{"metricName":"time to collect","value":5882},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=3875]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":26555888},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":620}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":375},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=4603]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":38120936},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":1871724},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1871724}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2143}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#221)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2081},{"metricName":"peak memory","value":272629760},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":60}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#91, l_suppkey#92], functions=[partial_sum(l_quantity#94)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2046},{"metricName":"peak memory","value":269484032},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":40}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":265325003},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=3899]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":29589171},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":385137757},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":245786172},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":946853504},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":373638204}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":5736}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_suppkey#92, l_quantity#94]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1994-01-01) AND (l_shipdate#100 < 1995-01-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":29589172}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":195194608},{"metricName":"number of input batches","value":1952}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_suppkey#92, l_quantity#94, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":195194608},{"metricName":"time spent in job init","value":26848494},{"metricName":"time spent in decode_batch","value":1155024457},{"metricName":"time spent loading native vectors","value":173842598}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#42], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4325]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4325]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":16},{"metricName":"time to build","value":12},{"metricName":"time to collect","value":5882},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=3875]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":26555888},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":303441},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":303441}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":620}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#43) AND StartsWith(p_name#43, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), StartsWith(p_name#43, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#43), StartsWith(p_name#43, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":375},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3960]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":9},{"metricName":"time to build","value":22},{"metricName":"time to collect","value":484},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":14}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = CANADA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = CANADA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":14},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]