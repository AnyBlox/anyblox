[{"totalTime":67262,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_year#208 ASC NULLS FIRST], output=[toprettystring(o_year)#222,toprettystring(mkt_share)#223])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#208], functions=[sum(CASE WHEN (nation#210 = BRAZIL) THEN volume#209 ELSE 0.0 END), sum(volume#209)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":160},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_year#208, 200), ENSURE_REQUIREMENTS, [plan_id=5097]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5041731},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":146},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":64},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":146}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":902}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#208], functions=[partial_sum(CASE WHEN (nation#210 = BRAZIL) THEN volume#209 ELSE 0.0 END), partial_sum(volume#209)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":897},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [year(o_orderdate#28) AS o_year#208, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#209, n_name#213 AS nation#210]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":48804}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, o_orderdate#28, n_regionkey#18, n_name#213]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#212], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":906}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":9},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5889075},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=4950]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":244948},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":33736529},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":244948},{"metricName":"local bytes read","value":5609478},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":11757504},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5609478}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":2830}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_custkey#25, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2825}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":18},{"metricName":"peak memory","value":243269632},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":19089508},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=4797]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":807993},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":540690344},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":804078},{"metricName":"local bytes read","value":18201711},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":150},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":32319720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":18201711}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":17896}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92], [s_suppkey#76], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":807993}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [p_partkey#42], [l_partkey#91], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":807993}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4008]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":8},{"metricName":"time to build","value":17},{"metricName":"time to collect","value":43324},{"metricName":"number of output rows","value":26819},{"metricName":"data size","value":2097152}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=3723]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":26819},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24877844},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":26819},{"metricName":"local bytes read","value":207748},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":429104},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":207748}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":493}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_type#46) AND (p_type#46 = ECONOMY ANODIZED STEEL)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":26819}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_type#46] Batched: true, DataFilters: [isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":75},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=3740]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":425190556},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":10629152532},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":120530909},{"metricName":"local bytes read","value":3106911502},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":52},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20409146784},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10438544559}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":71288}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":425389216},{"metricName":"number of input batches","value":4254}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":425389216},{"metricName":"time spent in job init","value":52376605},{"metricName":"time spent in decode_batch","value":3743707332},{"metricName":"time spent loading native vectors","value":422172661}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3756]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":34},{"metricName":"time to build","value":141},{"metricName":"time to collect","value":39700},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":77}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":14},{"metricName":"metadata time","value":6},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":285},{"metricName":"peak memory","value":671088640},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":145195320},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=3775]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9116496},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":266295091},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9116496},{"metricName":"local bytes read","value":138671528},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":30},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":291727872},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":138671528}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3362}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1995-01-01)) AND (o_orderdate#28 <= 1996-12-31)) AND isnotnull(o_orderkey#24)) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9116496}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,1996-12-31), IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":642},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":93},{"metricName":"peak memory","value":268435456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3796]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":45949933},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":26544400},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":581}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":55},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3815]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":2},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":39557},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":16}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":16},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3832]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":3},{"metricName":"time to build","value":16},{"metricName":"time to collect","value":39570},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#212)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#212,n_name#213] Batched: true, DataFilters: [isnotnull(n_nationkey#212)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#212)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":14},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3851]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":16},{"metricName":"time to collect","value":39694},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":8}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = AMERICA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":66969,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_year#380 ASC NULLS FIRST], output=[toprettystring(o_year)#394,toprettystring(mkt_share)#395])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#380], functions=[sum(CASE WHEN (nation#382 = BRAZIL) THEN volume#381 ELSE 0.0 END), sum(volume#381)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":160},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_year#380, 200), ENSURE_REQUIREMENTS, [plan_id=12049]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1901930},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":146},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":64},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":146}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":815}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#380], functions=[partial_sum(CASE WHEN (nation#382 = BRAZIL) THEN volume#381 ELSE 0.0 END), partial_sum(volume#381)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":808},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [year(o_orderdate#28) AS o_year#380, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#381, n_name#385 AS nation#382]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":48804}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, o_orderdate#28, n_regionkey#18, n_name#385]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#384], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":816}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5889075},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=11902]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":244948},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":37517018},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":244948},{"metricName":"local bytes read","value":5609478},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":11757504},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5609478}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":2838}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_custkey#25, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2830}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":30},{"metricName":"peak memory","value":243269632},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":19089508},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=11749]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":808664},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":513780065},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":804078},{"metricName":"local bytes read","value":18201711},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":150},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":32346560},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":18201711}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":17499}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92], [s_suppkey#76], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":808664}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [p_partkey#42], [l_partkey#91], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":808664}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=10960]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":12},{"metricName":"time to build","value":4},{"metricName":"time to collect","value":43911},{"metricName":"number of output rows","value":26819},{"metricName":"data size","value":2097152}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=10675]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":26819},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":30119555},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":26819},{"metricName":"local bytes read","value":207748},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":429104},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":207748}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":383}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_type#46) AND (p_type#46 = ECONOMY ANODIZED STEEL)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":26819}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_type#46] Batched: true, DataFilters: [isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":31},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=10692]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":319912761},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":10586082961},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":120595861},{"metricName":"local bytes read","value":3107768130},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":52},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":15355812672},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":7842577949}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":36460}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":320194608},{"metricName":"number of input batches","value":3202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":320194608},{"metricName":"time spent in job init","value":55173185},{"metricName":"time spent in decode_batch","value":2622912451},{"metricName":"time spent loading native vectors","value":249111654}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=10708]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":34},{"metricName":"time to build","value":71},{"metricName":"time to collect","value":690},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":59}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":285},{"metricName":"peak memory","value":671088640},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":145195320},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=10727]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9355366},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":335112082},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9116496},{"metricName":"local bytes read","value":138671528},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":30},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":299371744},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":138671528}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3068}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1995-01-01)) AND (o_orderdate#28 <= 1996-12-31)) AND isnotnull(o_orderkey#24)) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9355367}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30787144},{"metricName":"number of input batches","value":7644}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,1996-12-31), IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":553},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30787144}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":93},{"metricName":"peak memory","value":268435456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=10748]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":62873498},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":26544400},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":579}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":23},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=10767]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":655},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":13}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=10784]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":18},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":40319},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":6}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#384)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#384,n_name#385] Batched: true, DataFilters: [isnotnull(n_nationkey#384)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#384)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=10803]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":8},{"metricName":"time to collect","value":40307},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = AMERICA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":2},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":66274,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_year#338 ASC NULLS FIRST], output=[toprettystring(o_year)#352,toprettystring(mkt_share)#353])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#338], functions=[sum(CASE WHEN (nation#340 = BRAZIL) THEN volume#339 ELSE 0.0 END), sum(volume#339)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":160},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_year#338, 200), ENSURE_REQUIREMENTS, [plan_id=10339]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1903698},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":146},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":64},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":146}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":825}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#338], functions=[partial_sum(CASE WHEN (nation#340 = BRAZIL) THEN volume#339 ELSE 0.0 END), partial_sum(volume#339)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":818},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [year(o_orderdate#28) AS o_year#338, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#339, n_name#343 AS nation#340]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":48804}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, o_orderdate#28, n_regionkey#18, n_name#343]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#342], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":825}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5889075},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=10192]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":244948},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":37242667},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":244948},{"metricName":"local bytes read","value":5609478},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":11757504},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5609478}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":2708}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_custkey#25, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2692}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":20},{"metricName":"peak memory","value":243269632},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":19089508},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=10039]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":817000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":518038435},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":804078},{"metricName":"local bytes read","value":18201711},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":150},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":32680000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":18201711}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":17681}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92], [s_suppkey#76], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":817000}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [p_partkey#42], [l_partkey#91], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":817000}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=9250]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":43048},{"metricName":"number of output rows","value":26819},{"metricName":"data size","value":2097152}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=8965]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":26819},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":32036563},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":26819},{"metricName":"local bytes read","value":207748},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":429104},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":207748}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":409}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_type#46) AND (p_type#46 = ECONOMY ANODIZED STEEL)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":26819}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_type#46] Batched: true, DataFilters: [isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":73},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=8982]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":407475486},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11670408595},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":121886580},{"metricName":"local bytes read","value":3107347009},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":52},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":19558823424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10002388037}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":71698}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":407589216},{"metricName":"number of input batches","value":4076}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":407589216},{"metricName":"time spent in job init","value":58928845},{"metricName":"time spent in decode_batch","value":3188379451},{"metricName":"time spent loading native vectors","value":300858509}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=8998]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":33},{"metricName":"time to build","value":115},{"metricName":"time to collect","value":39487},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":65}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":16},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":286},{"metricName":"peak memory","value":671088640},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":145195320},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=9017]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9116496},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":324113915},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9116496},{"metricName":"local bytes read","value":138671528},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":30},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":291727872},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":138671528}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3135}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1995-01-01)) AND (o_orderdate#28 <= 1996-12-31)) AND isnotnull(o_orderkey#24)) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9116496}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,1996-12-31), IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":560},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":92},{"metricName":"peak memory","value":268435456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=9038]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":68317669},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":26544400},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":567}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":27},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=9057]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":18},{"metricName":"time to collect","value":39466},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=9074]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":39368},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":13}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#342)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#342,n_name#343] Batched: true, DataFilters: [isnotnull(n_nationkey#342)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#342)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":13},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=9093]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":22},{"metricName":"time to collect","value":39380},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = AMERICA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":2},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":66440,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_year#294 ASC NULLS FIRST], output=[toprettystring(o_year)#308,toprettystring(mkt_share)#309])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#294], functions=[sum(CASE WHEN (nation#296 = BRAZIL) THEN volume#295 ELSE 0.0 END), sum(volume#295)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":160},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_year#294, 200), ENSURE_REQUIREMENTS, [plan_id=8629]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1895244},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":146},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":64},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":146}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":787}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#294], functions=[partial_sum(CASE WHEN (nation#296 = BRAZIL) THEN volume#295 ELSE 0.0 END), partial_sum(volume#295)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":783},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [year(o_orderdate#28) AS o_year#294, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#295, n_name#299 AS nation#296]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":48804}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, o_orderdate#28, n_regionkey#18, n_name#299]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#298], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":790}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5889075},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=8482]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":244948},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":36931927},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":244948},{"metricName":"local bytes read","value":5609478},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":11757504},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5609478}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":2698}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_custkey#25, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2670}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":25},{"metricName":"peak memory","value":327155712},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":19089508},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=8329]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":818183},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":506729747},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1129877},{"metricName":"local bytes read","value":25574946},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":200},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":32727320},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":18201711}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":17576}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92], [s_suppkey#76], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":818183}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [p_partkey#42], [l_partkey#91], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":818183}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7628]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":8},{"metricName":"time to build","value":8},{"metricName":"time to collect","value":43232},{"metricName":"number of output rows","value":26819},{"metricName":"data size","value":2097152}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=7199]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":26819},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":18996972},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":26819},{"metricName":"local bytes read","value":207748},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":429104},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":207748}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":450}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_type#46) AND (p_type#46 = ECONOMY ANODIZED STEEL)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":26819}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_type#46] Batched: true, DataFilters: [isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":63},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=7216]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":365192187},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":10976607781},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":122302194},{"metricName":"local bytes read","value":3048077577},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":51},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":17529225024},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":8898222035}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":35812}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":365294608},{"metricName":"number of input batches","value":3653}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":365294608},{"metricName":"time spent in job init","value":47203680},{"metricName":"time spent in decode_batch","value":3040138009},{"metricName":"time spent loading native vectors","value":344459832}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7232]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":62},{"metricName":"time to build","value":105},{"metricName":"time to collect","value":327},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":120}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":37},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":285},{"metricName":"peak memory","value":671088640},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":145195320},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=7251]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9116496},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":323680271},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":10515280},{"metricName":"local bytes read","value":194815085},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":291727872},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":138671528}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2863}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1995-01-01)) AND (o_orderdate#28 <= 1996-12-31)) AND isnotnull(o_orderkey#24)) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9116496}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,1996-12-31), IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":471},{"metricName":"metadata time","value":14},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":92},{"metricName":"peak memory","value":268435456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=7272]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":58684679},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":26544400},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":610}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":38},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7291]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":15},{"metricName":"time to collect","value":39964},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":13}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":13},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=7308]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":40015},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#298)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#298,n_name#299] Batched: true, DataFilters: [isnotnull(n_nationkey#298)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#298)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7327]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":39973},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":12}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = AMERICA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":67346,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[o_year#250 ASC NULLS FIRST], output=[toprettystring(o_year)#264,toprettystring(mkt_share)#265])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#250], functions=[sum(CASE WHEN (nation#252 = BRAZIL) THEN volume#251 ELSE 0.0 END), sum(volume#251)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":160},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_year#250, 200), ENSURE_REQUIREMENTS, [plan_id=6863]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1846865},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2},{"metricName":"local bytes read","value":146},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":64},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":146}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":820}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[o_year#250], functions=[partial_sum(CASE WHEN (nation#252 = BRAZIL) THEN volume#251 ELSE 0.0 END), partial_sum(volume#251)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":807},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":2},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [year(o_orderdate#28) AS o_year#250, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#251, n_name#255 AS nation#252]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":48804}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, o_orderdate#28, n_regionkey#18, n_name#255]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#254], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_orderdate#28, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":820}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5889075},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=6716]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":244948},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":34043392},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":244948},{"metricName":"local bytes read","value":5609478},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":11757504},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5609478}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":2698}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79, o_custkey#25, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":244948},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2702}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":18},{"metricName":"peak memory","value":243269632},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":19089508},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=6563]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":831138},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":494054965},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":804078},{"metricName":"local bytes read","value":18201711},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":150},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":33245520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":18201711}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":17695}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92], [s_suppkey#76], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":831138}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [p_partkey#42], [l_partkey#91], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":831138}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5862]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":16},{"metricName":"time to build","value":6},{"metricName":"time to collect","value":43684},{"metricName":"number of output rows","value":26819},{"metricName":"data size","value":2097152}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=5433]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":26819},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":31210849},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":26819},{"metricName":"local bytes read","value":207748},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":429104},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":207748}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":609}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_type#46) AND (p_type#46 = ECONOMY ANODIZED STEEL)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":26819}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_type#46] Batched: true, DataFilters: [isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_type:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_type:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_type), EqualTo(p_type,ECONOMY ANODIZED STEEL), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_type#46), (p_type#46 = ECONOMY ANODIZED STEEL), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":77},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=5450]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":327671346},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":8040625701},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":124042417},{"metricName":"local bytes read","value":3107483294},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":52},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":15728224704},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":7930297410}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":36479}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":327894608},{"metricName":"number of input batches","value":3279}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":327894608},{"metricName":"time spent in job init","value":57448460},{"metricName":"time spent in decode_batch","value":2645075625},{"metricName":"time spent loading native vectors","value":377703793}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5466]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":48},{"metricName":"time to build","value":121},{"metricName":"time to collect","value":408},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":85}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":15},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":285},{"metricName":"peak memory","value":671088640},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":145195320},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=5485]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9692498},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":308496871},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9116496},{"metricName":"local bytes read","value":138671528},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":30},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":310159968},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":138671528}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3173}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1995-01-01)) AND (o_orderdate#28 <= 1996-12-31)) AND isnotnull(o_orderkey#24)) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9692499}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":31899307},{"metricName":"number of input batches","value":7920}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnot..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1995-01-01), LessThanOrEqual(o_orderdate,1996-12-31), IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1995-01-01), (o_orderdate#28 <= 1996-12-31), isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":626},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":31899307}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":93},{"metricName":"peak memory","value":268435456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=5506]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":45937193},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":26544400},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":606}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":54},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5525]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":18},{"metricName":"time to collect","value":40369},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":15}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":15},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5542]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":13},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":40346},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":13}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#254)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#254,n_name#255] Batched: true, DataFilters: [isnotnull(n_nationkey#254)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#254)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":13},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5561]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":40305},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":18}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = AMERICA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,AMERICA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = AMERICA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":18},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]