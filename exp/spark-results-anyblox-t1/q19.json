[{"totalTime":7625,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=726]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":216966},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":307}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":306},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=581]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3814150},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":93262856},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":42880357},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":152566040},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":42880357}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":6127}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3814151}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":178194608},{"metricName":"number of input batches","value":1782}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":178194608},{"metricName":"time spent in job init","value":26654958},{"metricName":"time spent in decode_batch","value":2648431462},{"metricName":"time spent loading native vectors","value":208432138}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=679]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6},{"metricName":"time to build","value":15},{"metricName":"time to collect","value":81},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=599]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":38563477},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":214793},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":214793}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":633}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":141},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6637,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1686]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":217466},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":296}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":296},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=1541]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4417547},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":83289204},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":42880357},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":176701880},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":42880357}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":5316}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4417547}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":206294608},{"metricName":"number of input batches","value":2063}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":206294608},{"metricName":"time spent in job init","value":26641318},{"metricName":"time spent in decode_batch","value":2568324575},{"metricName":"time spent loading native vectors","value":163635103}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1639]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":8},{"metricName":"time to build","value":14},{"metricName":"time to collect","value":54},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=1559]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":38922711},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":214793},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":214793}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":602}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":101},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6668,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1446]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":214550},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":299}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":299},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=1301]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2872582},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":104560491},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":42880357},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":114903280},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":42880357}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":5370}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2872582}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":134094608},{"metricName":"number of input batches","value":1341}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":134094608},{"metricName":"time spent in job init","value":22938982},{"metricName":"time spent in decode_batch","value":1701119752},{"metricName":"time spent loading native vectors","value":115473296}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1399]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":10},{"metricName":"time to collect","value":47},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=1319]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":27043831},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":214793},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":214793}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":544}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":98},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6960,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1206]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":224232},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":473}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":473},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=1061]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2569938},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":68116366},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":42880357},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":102797520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":42880357}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":5473}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2569938}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":10461966},{"metricName":"time spent in decode_batch","value":1582050352},{"metricName":"time spent loading native vectors","value":139947482}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1159]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":9},{"metricName":"time to build","value":15},{"metricName":"time to collect","value":47},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=1079]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":37642804},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":214793},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":214793}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":546}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":110},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":7468,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=966]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":654607},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":584}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":584},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=821]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4943567},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":93047379},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":42880357},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":197742680},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":42880357}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":5792}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4943567}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":230894608},{"metricName":"number of input batches","value":2309}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":230894608},{"metricName":"time spent in job init","value":16562696},{"metricName":"time spent in decode_batch","value":3334082126},{"metricName":"time spent loading native vectors","value":272390403}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=919]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":9},{"metricName":"time to build","value":17},{"metricName":"time to collect","value":66},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=839]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22886555},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":214793},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":214793}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":593}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":138},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]