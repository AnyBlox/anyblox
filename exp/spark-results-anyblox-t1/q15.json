[{"totalTime":6483,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#431,toprettystring(s_name)#432,toprettystring(s_address)#433,toprettystring(s_phone)#434,toprettystring(total_revenue)#435])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":196}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#398]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#397], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=800]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":38426924},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":200}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":59},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=934]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":4},{"metricName":"time to build","value":7},{"metricName":"time to collect","value":3173},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":122}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#397, sum((l_extendedprice * (1 - l_discount)))#396 AS total_revenue#398]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#396) AND (sum((l_extendedprice * (1 - l_discount)))#396 = Subquery subquery#394, [id=#894]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":105},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=829]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23019513},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2570}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2483},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":11312735},{"metricName":"time spent in decode_batch","value":886054342},{"metricName":"time spent loading native vectors","value":130152259}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#394, [id=#894]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":2964}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#400)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1004]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":4265371},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":119}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#400)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":118},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#479], functions=[sum((l_extendedprice#482 * (1.0 - l_discount#483)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":214},{"metricName":"peak memory","value":150994944},{"metricName":"number of output rows","value":201024},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":32}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#479, 200), ENSURE_REQUIREMENTS, [plan_id=967]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":13290113},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":400000},{"metricName":"local bytes read","value":5501776},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2612}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#479], functions=[partial_sum((l_extendedprice#482 * (1.0 - l_discount#483)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2566},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#479, l_extendedprice#482, l_discount#483]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#487 >= 1996-01-01) AND (l_shipdate#487 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#479, l_extendedprice#482, l_discount#483, l_shipdate#487] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":2416724},{"metricName":"time spent in decode_batch","value":940131559},{"metricName":"time spent loading native vectors","value":108383477}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":5945,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#971,toprettystring(s_name)#972,toprettystring(s_address)#973,toprettystring(s_phone)#974,toprettystring(total_revenue)#975])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":162}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#938]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#937], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=2160]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24724060},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":156}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":40},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2294]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":3},{"metricName":"time to collect","value":2867},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":60}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#937, sum((l_extendedprice * (1 - l_discount)))#936 AS total_revenue#938]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#936) AND (sum((l_extendedprice * (1 - l_discount)))#936 = Subquery subquery#934, [id=#2254]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":56},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=2189]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":16828238},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2536}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2384},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":6437505},{"metricName":"time spent in decode_batch","value":860596195},{"metricName":"time spent loading native vectors","value":102931012}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#934, [id=#2254]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":2749}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#940)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=2364]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":202316},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":119}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#940)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":119},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#1019], functions=[sum((l_extendedprice#1022 * (1.0 - l_discount#1023)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":107},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#1019, 200), ENSURE_REQUIREMENTS, [plan_id=2327]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12041490},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2454}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#1019], functions=[partial_sum((l_extendedprice#1022 * (1.0 - l_discount#1023)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2406},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#1019, l_extendedprice#1022, l_discount#1023]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#1027 >= 1996-01-01) AND (l_shipdate#1027 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#1019, l_extendedprice#1022, l_discount#1023, l_shipdate#1027] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":3285766},{"metricName":"time spent in decode_batch","value":882615778},{"metricName":"time spent loading native vectors","value":94320122}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":5766,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#836,toprettystring(s_name)#837,toprettystring(s_address)#838,toprettystring(s_phone)#839,toprettystring(total_revenue)#840])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":166}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#803]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#802], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=1820]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":41695816},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":168}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":41},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1954]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":2799},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":106}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#802, sum((l_extendedprice * (1 - l_discount)))#801 AS total_revenue#803]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#801) AND (sum((l_extendedprice * (1 - l_discount)))#801 = Subquery subquery#799, [id=#1914]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":99},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=1849]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":18576629},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2343}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2299},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":7817266},{"metricName":"time spent in decode_batch","value":845140737},{"metricName":"time spent loading native vectors","value":81761229}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#799, [id=#1914]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":2622}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#805)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=2024]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":190637},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":100}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#805)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":100},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#884], functions=[sum((l_extendedprice#887 * (1.0 - l_discount#888)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":95},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#884, 200), ENSURE_REQUIREMENTS, [plan_id=1987]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":15717315},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2318}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#884], functions=[partial_sum((l_extendedprice#887 * (1.0 - l_discount#888)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2276},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#884, l_extendedprice#887, l_discount#888]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#892 >= 1996-01-01) AND (l_shipdate#892 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#884, l_extendedprice#887, l_discount#888, l_shipdate#892] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":6623617},{"metricName":"time spent in decode_batch","value":832012540},{"metricName":"time spent loading native vectors","value":82117885}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6375,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#701,toprettystring(s_name)#702,toprettystring(s_address)#703,toprettystring(s_phone)#704,toprettystring(total_revenue)#705])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":218}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#668]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#667], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=1480]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":50694198},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":320}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":77},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1614]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":4},{"metricName":"time to collect","value":3104},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":87}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#667, sum((l_extendedprice * (1 - l_discount)))#666 AS total_revenue#668]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#666) AND (sum((l_extendedprice * (1 - l_discount)))#666 = Subquery subquery#664, [id=#1574]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":80},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=1509]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":21518738},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2471}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2402},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":8185470}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":216694608},{"metricName":"number of input batches","value":2167}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":216694608},{"metricName":"time spent in job init","value":21237660},{"metricName":"time spent in decode_batch","value":1564676167},{"metricName":"time spent loading native vectors","value":155974617}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#664, [id=#1574]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":2945}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#670)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1684]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":192798},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":114}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#670)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":113},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#749], functions=[sum((l_extendedprice#752 * (1.0 - l_discount#753)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":104},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#749, 200), ENSURE_REQUIREMENTS, [plan_id=1647]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22582675},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2593}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#749], functions=[partial_sum((l_extendedprice#752 * (1.0 - l_discount#753)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2552},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#749, l_extendedprice#752, l_discount#753]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#757 >= 1996-01-01) AND (l_shipdate#757 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#749, l_extendedprice#752, l_discount#753, l_shipdate#757] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":3297433},{"metricName":"time spent in decode_batch","value":958241173},{"metricName":"time spent loading native vectors","value":89149797}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6531,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#566,toprettystring(s_name)#567,toprettystring(s_address)#568,toprettystring(s_phone)#569,toprettystring(total_revenue)#570])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":162}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#533]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#532], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=1140]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":36050649},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":269}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":71},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1274]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":6},{"metricName":"time to collect","value":3023},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":112}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#532, sum((l_extendedprice * (1 - l_discount)))#531 AS total_revenue#533]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#531) AND (sum((l_extendedprice * (1 - l_discount)))#531 = Subquery subquery#529, [id=#1234]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":107},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=1169]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":38721837},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2787}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2654},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":13440620},{"metricName":"time spent in decode_batch","value":951865796},{"metricName":"time spent loading native vectors","value":105804903}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#529, [id=#1234]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":2822}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#535)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1344]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":213901},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":91}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#535)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":90},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#614], functions=[sum((l_extendedprice#617 * (1.0 - l_discount#618)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":80},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#614, 200), ENSURE_REQUIREMENTS, [plan_id=1307]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":14187139},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2528}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#614], functions=[partial_sum((l_extendedprice#617 * (1.0 - l_discount#618)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2480},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#614, l_extendedprice#617, l_discount#618]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#622 >= 1996-01-01) AND (l_shipdate#622 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#614, l_extendedprice#617, l_discount#618, l_shipdate#622] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":7435380},{"metricName":"time spent in decode_batch","value":893962292},{"metricName":"time spent loading native vectors","value":97933582}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]