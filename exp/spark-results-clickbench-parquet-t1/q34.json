[{"totalTime":309827,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#408L DESC NULLS LAST], output=[toprettystring(URL)#414,toprettystring(c)#415])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":32618}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":30130},{"metricName":"peak memory","value":7549747200},{"metricName":"number of output rows","value":18342019},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1290}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":4546376790},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(URL#205, 200), ENSURE_REQUIREMENTS, [plan_id=1214]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":52309834},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5814215182},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":52106509},{"metricName":"local bytes read","value":4511660850},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10400},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":8183513496},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4337789773}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":154612}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":115632},{"metricName":"peak memory","value":15703474176},{"metricName":"number of output rows","value":52309838},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1572}],"children":[{"nodeName":"Project","description":"Project [URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":107753001},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":115988}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3543},{"metricName":"peak memory","value":11576279040},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1061]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101809761},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1199023538},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":115274104},{"metricName":"local bytes read","value":584205684},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":7772},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1628956208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24187}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101809763}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101816121},{"metricName":"number of input batches","value":24877}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9303},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101816121}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":115804}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3498},{"metricName":"peak memory","value":18622709760},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":5722198608},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1098]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":120968249},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7692250727},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":113109362},{"metricName":"local bytes read","value":6306683524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3364},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":14475981528},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5762330274}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16963}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":27674648}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27676672},{"metricName":"number of input batches","value":6761}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,URL#205] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4088},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":27676672}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":19416}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":32877943}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":32879484},{"metricName":"number of input batches","value":8029}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,URL#217] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6456},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":32879484}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":29434}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":31649789}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":31649789},{"metricName":"number of input batches","value":7742}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,URL#229] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9241},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":31649789}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":22891}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":28765873}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28768635},{"metricName":"number of input batches","value":7034}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,URL#241] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8368},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":28768635}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":313802,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#393L DESC NULLS LAST], output=[toprettystring(URL)#399,toprettystring(c)#400])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":32509}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":30038},{"metricName":"peak memory","value":7549747200},{"metricName":"number of output rows","value":18342019},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1290}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":4546376790},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(URL#205, 200), ENSURE_REQUIREMENTS, [plan_id=907]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":52896133},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5832296307},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":52051461},{"metricName":"local bytes read","value":4511660850},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10400},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":8266451648},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4337789773}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":155214}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":117247},{"metricName":"peak memory","value":15854469120},{"metricName":"number of output rows","value":52896138},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1587}],"children":[{"nodeName":"Project","description":"Project [URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":109025681},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":117640}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3566},{"metricName":"peak memory","value":11576279040},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=754]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":104140794},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1212751768},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":115620674},{"metricName":"local bytes read","value":584226128},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":7772},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1666252720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":512317394}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24917}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":104140796}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":104146678},{"metricName":"number of input batches","value":25448}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9467},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":104146678}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":117469}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3564},{"metricName":"peak memory","value":18790481920},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":5722198608},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=791]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":120079178},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7951168106},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":113395513},{"metricName":"local bytes read","value":6306592046},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3364},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":14682855488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5578171864}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16915}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":28760595}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28763982},{"metricName":"number of input batches","value":7027}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,URL#205] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4276},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":28763982}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":19510}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":28512330}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28516352},{"metricName":"number of input batches","value":6963}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,URL#217] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6361},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":28516352}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":27934}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":33043118}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":33043118},{"metricName":"number of input batches","value":8078}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,URL#229] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9534},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":33043118}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":26041}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":29763139}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":29763963},{"metricName":"number of input batches","value":7277}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,URL#241] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10816},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":29763963}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":307483,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#453L DESC NULLS LAST], output=[toprettystring(URL)#459,toprettystring(c)#460])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":32159}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29717},{"metricName":"peak memory","value":7549747200},{"metricName":"number of output rows","value":18342019},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1290}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":4546376790},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(URL#205, 200), ENSURE_REQUIREMENTS, [plan_id=2135]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":52354217},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5895739236},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":52055026},{"metricName":"local bytes read","value":4511441439},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10400},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":8176150968},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4337789773}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":154234}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":115193},{"metricName":"peak memory","value":15703474176},{"metricName":"number of output rows","value":52354221},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1572}],"children":[{"nodeName":"Project","description":"Project [URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":107072435},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":115425}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3486},{"metricName":"peak memory","value":11374952448},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1982]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":99997537},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1182412463},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":114647120},{"metricName":"local bytes read","value":584196865},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":7772},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1599960592},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":23954}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":99997538}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100001593},{"metricName":"number of input batches","value":24434}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9051},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100001593}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":115299}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3455},{"metricName":"peak memory","value":18454937600},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":5722198608},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2019]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":114322703},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6902823584},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":112373626},{"metricName":"local bytes read","value":6306781654},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3364},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":13452911568},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5653162411}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16807}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":28403637}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28407709},{"metricName":"number of input batches","value":6941}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,URL#205] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3969},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":28407709}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":19347}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":30551906}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30552956},{"metricName":"number of input batches","value":7461}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,URL#217] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5552},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":30552956}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":25589}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":27827205}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27834234},{"metricName":"number of input batches","value":6808}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,URL#229] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8277},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27834234}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":22592}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":27539961}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27543353},{"metricName":"number of input batches","value":6734}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,URL#241] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7780},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":27543353}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":309657,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#438L DESC NULLS LAST], output=[toprettystring(URL)#444,toprettystring(c)#445])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":32196}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29737},{"metricName":"peak memory","value":7549747200},{"metricName":"number of output rows","value":18342019},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1290}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":4546376790},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(URL#205, 200), ENSURE_REQUIREMENTS, [plan_id=1828]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":52443329},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5759174782},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":52028525},{"metricName":"local bytes read","value":4466883828},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10300},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":8193880536},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4337789773}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":154396}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":115163},{"metricName":"peak memory","value":15703474176},{"metricName":"number of output rows","value":52443333},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1573}],"children":[{"nodeName":"Project","description":"Project [URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":107457475},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":115428}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3485},{"metricName":"peak memory","value":11374952448},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1675]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102414349},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1264226719},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":115456230},{"metricName":"local bytes read","value":584248277},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":7772},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1638629584},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":511061825}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":25750}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102414351}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102416480},{"metricName":"number of input batches","value":25025}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9725},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102416480}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":115282}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3492},{"metricName":"peak memory","value":18622709760},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":5722198608},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1712]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":120767346},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7571505755},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":112114579},{"metricName":"local bytes read","value":6307222759},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3364},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":14216142488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":6023566715}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16795}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25491527}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25493504},{"metricName":"number of input batches","value":6228}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,URL#205] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3638},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25493504}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":19353}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":30182832}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30183424},{"metricName":"number of input batches","value":7370}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,URL#217] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5455},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":30183424}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":25686}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":28721698}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28725248},{"metricName":"number of input batches","value":7023}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,URL#229] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9602},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":28725248}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":25779}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":36371295}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":36374472},{"metricName":"number of input batches","value":8896}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,URL#241] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8755},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":36374472}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":311940,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#423L DESC NULLS LAST], output=[toprettystring(URL)#429,toprettystring(c)#430])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":32223}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29789},{"metricName":"peak memory","value":7549747200},{"metricName":"number of output rows","value":18342019},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1290}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":4546376790},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(URL#205, 200), ENSURE_REQUIREMENTS, [plan_id=1521]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":52397744},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6027461339},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":52039570},{"metricName":"local bytes read","value":4467409970},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10300},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":8183697560},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4337789773}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":157563}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[URL#205], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":118189},{"metricName":"peak memory","value":15703474176},{"metricName":"number of output rows","value":52397748},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1573}],"children":[{"nodeName":"Project","description":"Project [URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":107178779},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":118534}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3660},{"metricName":"peak memory","value":11374952448},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":530530557},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1368]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101528924},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1189611425},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":115208286},{"metricName":"local bytes read","value":589292725},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":7839},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1624462784},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24070}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101528925}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101529401},{"metricName":"number of input batches","value":24807}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9119},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101529401}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":118364}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3502},{"metricName":"peak memory","value":18287165440},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":100},{"metricName":"partition data size","value":5722198608},{"metricName":"number of coalesced partitions","value":100}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1405]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118188322},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7359133618},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":111991264},{"metricName":"local bytes read","value":6361494122},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3393},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":14132408624},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":5702152342}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16818}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":28262093}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28266496},{"metricName":"number of input batches","value":6905}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,URL#205] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4109},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":28266496}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":23431}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":30229372}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30229372},{"metricName":"number of input batches","value":7382}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,URL#217] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5823},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":30229372}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":25815}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":29604175}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":29610826},{"metricName":"number of input batches","value":7240}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,URL#229] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8626},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":29610826}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":22953}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":30092687}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30095739},{"metricName":"number of input batches","value":7358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,URL#241] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8731},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":30095739}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]