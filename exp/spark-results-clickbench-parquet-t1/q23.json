[{"totalTime":103923,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#657L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#675,toprettystring(min(URL))#676,toprettystring(min(Title))#677,toprettystring(c)#678,toprettystring(count(DISTINCT UserID))#679])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":23}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1965]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22629364},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":104}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1921]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":166227874},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10328}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7223}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1645]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100410362},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2192612063},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":102049545},{"metricName":"local bytes read","value":1469244194},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2409848712},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28577}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100410363}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100411193},{"metricName":"number of input batches","value":24534}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9609},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100411193}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1837]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":23},{"metricName":"time to build","value":21},{"metricName":"time to collect","value":117},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1682]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7713},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":213536161},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":2195130},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2651232},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2195130}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":13865}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#206) AND isnotnull(URL#205)) AND isnotnull(SearchPhrase#203)) AND Contains(Title#206, Google)) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1713}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27342749},{"metricName":"number of input batches","value":6681}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205,Title#206] Batched: true, DataFilters: [isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Google), NOT Contains(URL#205, .google.), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8432},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":27342749}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":14430}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#218) AND isnotnull(URL#217)) AND isnotnull(SearchPhrase#215)) AND Contains(Title#218, Google)) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2355}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26714112},{"metricName":"number of input batches","value":6523}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217,Title#218] Batched: true, DataFilters: [isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Google), NOT Contains(URL#217, .google.), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9560},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":26714112}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":16868}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#230) AND isnotnull(URL#229)) AND isnotnull(SearchPhrase#227)) AND Contains(Title#230, Google)) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1544}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26112000},{"metricName":"number of input batches","value":6384}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229,Title#230] Batched: true, DataFilters: [isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Google), NOT Contains(URL#229, .google.), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11449},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":26112000}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":15796}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#242) AND isnotnull(URL#241)) AND isnotnull(SearchPhrase#239)) AND Contains(Title#242, Google)) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2101}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":31321786},{"metricName":"number of input batches","value":7662}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241,Title#242] Batched: true, DataFilters: [isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Google), NOT Contains(URL#241, .google.), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12062},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":31321786}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":104400,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#559L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#577,toprettystring(min(URL))#578,toprettystring(min(Title))#579,toprettystring(c)#580,toprettystring(count(DISTINCT UserID))#581])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":29}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1472]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":16258454},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":94}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":7},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1428]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":175438714},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10536}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7833}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1152]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100489582},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2210325171},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":104550668},{"metricName":"local bytes read","value":1506147197},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":72},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2411749992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28729}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100489583}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100493567},{"metricName":"number of input batches","value":24555}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9931},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100493567}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1344]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":19},{"metricName":"time to build","value":17},{"metricName":"time to collect","value":100},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1189]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":8044},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":211820137},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":2195130},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2836656},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2195130}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":14100}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#206) AND isnotnull(URL#205)) AND isnotnull(SearchPhrase#203)) AND Contains(Title#206, Google)) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1963}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28753920},{"metricName":"number of input batches","value":7024}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205,Title#206] Batched: true, DataFilters: [isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Google), NOT Contains(URL#205, .google.), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9257},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":28753920}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":14399}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#218) AND isnotnull(URL#217)) AND isnotnull(SearchPhrase#215)) AND Contains(Title#218, Google)) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2155}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25497600},{"metricName":"number of input batches","value":6226}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217,Title#218] Batched: true, DataFilters: [isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Google), NOT Contains(URL#217, .google.), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8874},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25497600}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":16817}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#230) AND isnotnull(URL#229)) AND isnotnull(SearchPhrase#227)) AND Contains(Title#230, Google)) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1700}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27344145},{"metricName":"number of input batches","value":6686}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229,Title#230] Batched: true, DataFilters: [isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Google), NOT Contains(URL#229, .google.), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12250},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27344145}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":15632}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#242) AND isnotnull(URL#241)) AND isnotnull(SearchPhrase#239)) AND Contains(Title#242, Google)) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2226}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27727673},{"metricName":"number of input batches","value":6779}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241,Title#242] Batched: true, DataFilters: [isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Google), NOT Contains(URL#241, .google.), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11517},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":27727673}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":102557,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#951L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#969,toprettystring(min(URL))#970,toprettystring(min(Title))#971,toprettystring(c)#972,toprettystring(count(DISTINCT UserID))#973])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":17}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=3444]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":10172542},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":64}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=3400]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":153711842},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10275}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7345}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=3124]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101381634},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2413072811},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":103030120},{"metricName":"local bytes read","value":1450859407},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2433159240},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28114}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101381637}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101386829},{"metricName":"number of input batches","value":24773}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9349},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101386829}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3316]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":13},{"metricName":"time to build","value":14},{"metricName":"time to collect","value":62},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=3161]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7835},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":214354301},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":2195130},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2706368},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2195130}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":13823}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#206) AND isnotnull(URL#205)) AND isnotnull(SearchPhrase#203)) AND Contains(Title#206, Google)) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1645}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25620480},{"metricName":"number of input batches","value":6259}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205,Title#206] Batched: true, DataFilters: [isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Google), NOT Contains(URL#205, .google.), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7893},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25620480}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":14497}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#218) AND isnotnull(URL#217)) AND isnotnull(SearchPhrase#215)) AND Contains(Title#218, Google)) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2572}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26234880},{"metricName":"number of input batches","value":6406}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217,Title#218] Batched: true, DataFilters: [isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Google), NOT Contains(URL#217, .google.), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9922},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":26234880}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":16654}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#230) AND isnotnull(URL#229)) AND isnotnull(SearchPhrase#227)) AND Contains(Title#230, Google)) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1656}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27899344},{"metricName":"number of input batches","value":6821}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229,Title#230] Batched: true, DataFilters: [isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Google), NOT Contains(URL#229, .google.), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12272},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27899344}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":15519}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#242) AND isnotnull(URL#241)) AND isnotnull(SearchPhrase#239)) AND Contains(Title#242, Google)) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1962}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":29421668},{"metricName":"number of input batches","value":7195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241,Title#242] Batched: true, DataFilters: [isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Google), NOT Contains(URL#241, .google.), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11240},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":29421668}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":103082,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#853L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#871,toprettystring(min(URL))#872,toprettystring(min(Title))#873,toprettystring(c)#874,toprettystring(count(DISTINCT UserID))#875])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":23}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2951]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22478234},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":88}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":6},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2907]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":167267193},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10417}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7398}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2631]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102888134},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2241659449},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":103653613},{"metricName":"local bytes read","value":1458579680},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2469315264},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28416}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102888137}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102894697},{"metricName":"number of input batches","value":25141}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9931},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102894697}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2823]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":16},{"metricName":"time to build","value":10},{"metricName":"time to collect","value":54},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2668]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7514},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":213847982},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":2195130},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2594960},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2195130}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":13837}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#206) AND isnotnull(URL#205)) AND isnotnull(SearchPhrase#203)) AND Contains(Title#206, Google)) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1615}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25931776},{"metricName":"number of input batches","value":6335}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205,Title#206] Batched: true, DataFilters: [isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Google), NOT Contains(URL#205, .google.), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8118},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25931776}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":14318}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#218) AND isnotnull(URL#217)) AND isnotnull(SearchPhrase#215)) AND Contains(Title#218, Google)) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2196}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25649152},{"metricName":"number of input batches","value":6263}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217,Title#218] Batched: true, DataFilters: [isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Google), NOT Contains(URL#217, .google.), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8889},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25649152}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":16649}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#230) AND isnotnull(URL#229)) AND isnotnull(SearchPhrase#227)) AND Contains(Title#230, Google)) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1736}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27957114},{"metricName":"number of input batches","value":6838}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229,Title#230] Batched: true, DataFilters: [isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Google), NOT Contains(URL#229, .google.), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12147},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27957114}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":15550}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#242) AND isnotnull(URL#241)) AND isnotnull(SearchPhrase#239)) AND Contains(Title#242, Google)) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1967}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26700874},{"metricName":"number of input batches","value":6529}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241,Title#242] Batched: true, DataFilters: [isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Google), NOT Contains(URL#241, .google.), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11080},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":26700874}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":103874,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#755L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#773,toprettystring(min(URL))#774,toprettystring(min(Title))#775,toprettystring(c)#776,toprettystring(count(DISTINCT UserID))#777])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), min(Title#206), count(1), count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":25}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":67239936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":978923},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2458]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3673},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":21490442},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3673},{"metricName":"local bytes read","value":931587},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1346128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":931587}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1), partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":3673}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[merge_min(URL#205), merge_min(Title#206), merge_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5950}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":74}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":6},{"metricName":"peak memory","value":67371008},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1943054},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2414]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5971},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":192931184},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5971},{"metricName":"local bytes read","value":1852457},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":23},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2091456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1852457}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203, UserID#9L], functions=[partial_min(URL#205), partial_min(Title#206), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":5971}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10580}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST, UserID#9L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":1545011200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, URL#205, Title#206]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":7428}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":23}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2138]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101405664},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2204844020},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":104626376},{"metricName":"local bytes read","value":1474508200},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":70},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2433735984},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28181}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101405666}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101410617},{"metricName":"number of input batches","value":24778}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9530},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101410617}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2330]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":10},{"metricName":"time to collect","value":78},{"metricName":"number of output rows","value":7128},{"metricName":"data size","value":4456448}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2175]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":8028},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":217141578},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7128},{"metricName":"local bytes read","value":2195130},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2762336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2195130}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":13841}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#206) AND isnotnull(URL#205)) AND isnotnull(SearchPhrase#203)) AND Contains(Title#206, Google)) AND NOT Contains(URL#205, .google.)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1723}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27096910},{"metricName":"number of input batches","value":6620}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205,Title#206] Batched: true, DataFilters: [isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#206), isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(Title#206, Google), NOT Contains(URL#205, .google.), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8576},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":27096910}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":15097}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#218) AND isnotnull(URL#217)) AND isnotnull(SearchPhrase#215)) AND Contains(Title#218, Google)) AND NOT Contains(URL#217, .google.)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2284}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25608192},{"metricName":"number of input batches","value":6253}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217,Title#218] Batched: true, DataFilters: [isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#218), isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(Title#218, Google), NOT Contains(URL#217, .google.), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9830},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25608192}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":16667}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#230) AND isnotnull(URL#229)) AND isnotnull(SearchPhrase#227)) AND Contains(Title#230, Google)) AND NOT Contains(URL#229, .google.)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1858}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28902698},{"metricName":"number of input batches","value":7067}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229,Title#230] Batched: true, DataFilters: [isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#230), isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(Title#230, Google), NOT Contains(URL#229, .google.), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12806},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":28902698}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":15635}],"children":[{"nodeName":"Filter","description":"Filter ((((((isnotnull(Title#242) AND isnotnull(URL#241)) AND isnotnull(SearchPhrase#239)) AND Contains(Title#242, Google)) AND NOT Contains(URL#241, .google.)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2164}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26576697},{"metricName":"number of input batches","value":6498}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241,Title#242] Batched: true, DataFilters: [isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Googl..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(Str..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string,Title:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string,Title:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Title), IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(Title,Google), Not(StringContains(URL,.google.)), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(Title#242), isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(Title#242, Google), NOT Contains(URL#241, .google.), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11139},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":26576697}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]