[{"totalTime":93074,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#510L DESC NULLS LAST], output=[toprettystring(WatchID)#526,toprettystring(ClientIP)#527,toprettystring(c)#528,toprettystring(sum(IsRefresh))#529,toprettystring(avg(ResolutionWidth))#530])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":6029}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":5104},{"metricName":"peak memory","value":1610612736},{"metricName":"number of output rows","value":13172392},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":64}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":267486072},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=1306]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13172392},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":622306748},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14274523},{"metricName":"local bytes read","value":320454236},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":200},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":737653952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":256336118}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":34783}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":31682},{"metricName":"peak memory","value":3355443200},{"metricName":"number of output rows","value":13172392},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":642}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7203}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3390},{"metricName":"peak memory","value":11005853696},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1137]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102907550},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3240761470},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":109943232},{"metricName":"local bytes read","value":2630031527},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2948},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4939562448},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2390900872}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":36033}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102907551}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102911556},{"metricName":"number of input batches","value":25146}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11282},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102911556}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":55887}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":372},{"metricName":"peak memory","value":3355443200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":70226938},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1182]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13263271},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":349691669},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13451390},{"metricName":"local bytes read","value":73508304},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1276},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":212212336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":66825207}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2342}],"children":[{"nodeName":"Project","description":"Project [rid#202]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2607007}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1006},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":2936}],"children":[{"nodeName":"Project","description":"Project [rid#214]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4110902}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27157372},{"metricName":"number of input batches","value":6632}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1367},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":27157372}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2629}],"children":[{"nodeName":"Project","description":"Project [rid#226]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271352}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6114}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1139},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2620}],"children":[{"nodeName":"Project","description":"Project [rid#238]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3274010}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24856377},{"metricName":"number of input batches","value":6078}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1163},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24856377}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":93679,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#461L DESC NULLS LAST], output=[toprettystring(WatchID)#477,toprettystring(ClientIP)#478,toprettystring(c)#479,toprettystring(sum(IsRefresh))#480,toprettystring(avg(ResolutionWidth))#481])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":6146}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":5190},{"metricName":"peak memory","value":1610612736},{"metricName":"number of output rows","value":13172392},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":64}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":267486072},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=976]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13172392},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":620846037},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":256336118},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":160},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":737653952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":256336118}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":34691}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":31582},{"metricName":"peak memory","value":3355443200},{"metricName":"number of output rows","value":13172392},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":642}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7147}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3285},{"metricName":"peak memory","value":10737418240},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=807]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102584563},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3350746462},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106478327},{"metricName":"local bytes read","value":2629955142},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2948},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4924059072},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2390900872}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":36336}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102584565}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102590265},{"metricName":"number of input batches","value":25066}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11402},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102590265}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":55852}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":358},{"metricName":"peak memory","value":3355443200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":70226938},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=852]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13303418},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":350418786},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":73507168},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1276},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":212854688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":66825207}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2344}],"children":[{"nodeName":"Project","description":"Project [rid#202]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2607007}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1019},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":3030}],"children":[{"nodeName":"Project","description":"Project [rid#214]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020023}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1369},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2648}],"children":[{"nodeName":"Project","description":"Project [rid#226]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3402378}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25985024},{"metricName":"number of input batches","value":6353}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1196},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25985024}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2607}],"children":[{"nodeName":"Project","description":"Project [rid#238]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3274010}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24856377},{"metricName":"number of input batches","value":6078}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1156},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24856377}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":92230,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#657L DESC NULLS LAST], output=[toprettystring(WatchID)#673,toprettystring(ClientIP)#674,toprettystring(c)#675,toprettystring(sum(IsRefresh))#676,toprettystring(avg(ResolutionWidth))#677])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":5992}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":5071},{"metricName":"peak memory","value":1610612736},{"metricName":"number of output rows","value":13172392},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":64}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":267486072},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=2296]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13501357},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":648003940},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":15269544},{"metricName":"local bytes read","value":320401106},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":200},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":756075992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":262739065}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":35331}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32196},{"metricName":"peak memory","value":3439329280},{"metricName":"number of output rows","value":13501357},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":658}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13829037},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7068}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3452},{"metricName":"peak memory","value":11274289152},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2127]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101080625},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3219290599},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":105817600},{"metricName":"local bytes read","value":2570209433},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2881},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4851870144},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2390900872}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":35767}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101080628}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101082937},{"metricName":"number of input batches","value":24698}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11069},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101082937}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":56969}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":376},{"metricName":"peak memory","value":3523215360},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":70226938},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2172]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14003351},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":351841023},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13830669},{"metricName":"local bytes read","value":71836292},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1247},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":224053616},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":66825207}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2294}],"children":[{"nodeName":"Project","description":"Project [rid#202]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3127240}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26480640},{"metricName":"number of input batches","value":6469}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1165},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":26480640}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":2970}],"children":[{"nodeName":"Project","description":"Project [rid#214]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020023}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1309},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2629}],"children":[{"nodeName":"Project","description":"Project [rid#226]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271352}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6114}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1143},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2609}],"children":[{"nodeName":"Project","description":"Project [rid#238]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3584736}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27455866},{"metricName":"number of input batches","value":6714}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1288},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":27455866}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":95608,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#608L DESC NULLS LAST], output=[toprettystring(WatchID)#624,toprettystring(ClientIP)#625,toprettystring(c)#626,toprettystring(sum(IsRefresh))#627,toprettystring(avg(ResolutionWidth))#628])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":6108}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":5203},{"metricName":"peak memory","value":1610612736},{"metricName":"number of output rows","value":13172392},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":64}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":267486072},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=1966]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13819603},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":718684074},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":256336118},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":160},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":773897768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":262744307}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":36611}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":33866},{"metricName":"peak memory","value":3523215360},{"metricName":"number of output rows","value":13819604},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":674}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":14159478},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7366}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3628},{"metricName":"peak memory","value":11542724608},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1797]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103217287},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3294122999},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":107950534},{"metricName":"local bytes read","value":2629977266},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2948},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4954429776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2458645943}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":37196}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":103217288}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":103217531},{"metricName":"number of input batches","value":25220}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11221},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":103217531}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":60122}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":394},{"metricName":"peak memory","value":3607101440},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":70226938},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1842]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13286008},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":416338584},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14160963},{"metricName":"local bytes read","value":73508710},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1276},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":212576128},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":66825207}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2311}],"children":[{"nodeName":"Project","description":"Project [rid#202]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2607007}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":997},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":2911}],"children":[{"nodeName":"Project","description":"Project [rid#214]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020023}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1300},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2634}],"children":[{"nodeName":"Project","description":"Project [rid#226]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3384968}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26480640},{"metricName":"number of input batches","value":6474}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1203},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":26480640}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":4076}],"children":[{"nodeName":"Project","description":"Project [rid#238]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3274010}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24856377},{"metricName":"number of input batches","value":6078}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1880},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24856377}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":92714,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#559L DESC NULLS LAST], output=[toprettystring(WatchID)#575,toprettystring(ClientIP)#576,toprettystring(c)#577,toprettystring(sum(IsRefresh))#578,toprettystring(avg(ResolutionWidth))#579])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":6030}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[count(1), sum(IsRefresh#13), avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":5105},{"metricName":"peak memory","value":1610612736},{"metricName":"number of output rows","value":13172392},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":64}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":4},{"metricName":"partition data size","value":267486072},{"metricName":"number of coalesced partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(WatchID#1L, ClientIP#7, 200), ENSURE_REQUIREMENTS, [plan_id=1636]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13172392},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":625083717},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14549716},{"metricName":"local bytes read","value":320433724},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":200},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":737653952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":256336118}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":34761}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[WatchID#1L, ClientIP#7], functions=[partial_count(1), partial_sum(IsRefresh#13), partial_avg(ResolutionWidth#18)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":31712},{"metricName":"peak memory","value":3355443200},{"metricName":"number of output rows","value":13172392},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":642}],"children":[{"nodeName":"Project","description":"Project [WatchID#1L, ClientIP#7, IsRefresh#13, ResolutionWidth#18]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13172392},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7161}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3297},{"metricName":"peak memory","value":10737418240},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2480075616},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1467]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102722494},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3237677852},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":104137715},{"metricName":"local bytes read","value":2570158216},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2881},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4930679760},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2390900872}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":35746}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102722496}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102724701},{"metricName":"number of input batches","value":25100}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,WatchID#1L,ClientIP#7,IsRefresh#13,ResolutionWidth#18] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,WatchID:bigint,ClientIP:int,IsRefresh:smallint,ResolutionWidth:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11109},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102724701}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":55934}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":358},{"metricName":"peak memory","value":3355443200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":70226938},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1512]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13174102},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":366206566},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13172392},{"metricName":"local bytes read","value":71833017},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1247},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":210785632},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":66825207}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2327}],"children":[{"nodeName":"Project","description":"Project [rid#202]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2607007}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1021},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":2944}],"children":[{"nodeName":"Project","description":"Project [rid#214]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020023}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1325},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2664}],"children":[{"nodeName":"Project","description":"Project [rid#226]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271352}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6114}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1171},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2649}],"children":[{"nodeName":"Project","description":"Project [rid#238]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3275720}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25163577},{"metricName":"number of input batches","value":6153}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1186},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":25163577}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]