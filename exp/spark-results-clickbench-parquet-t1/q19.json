[{"totalTime":241456,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#450L DESC NULLS LAST], output=[toprettystring(UserID)#459,toprettystring(m)#460,toprettystring(SearchPhrase)#461,toprettystring(count(1))#462])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":43324}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#467, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38559},{"metricName":"peak memory","value":6744440832},{"metricName":"number of output rows","value":56384822},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":476}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#467, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1214]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100581358},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2926359727},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106158860},{"metricName":"local bytes read","value":2471578166},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2613},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4827113952},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2149229269}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":125526}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#467, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":99695},{"metricName":"peak memory","value":13992198144},{"metricName":"number of output rows","value":100581361},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1120}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#467]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":108711915},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":99878}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3616},{"metricName":"peak memory","value":10435428352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1061]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":99997497},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2976610307},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118093668},{"metricName":"local bytes read","value":2503093073},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3199919904},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2094561885}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":33207}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":99997497}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":99997497},{"metricName":"number of input batches","value":24433}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10326},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":99997497}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":99756}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3600},{"metricName":"peak memory","value":10301210624},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1322125186},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1098]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103428368},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1740489052},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":115921069},{"metricName":"local bytes read","value":1506514016},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3314812120},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1260705499}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7177}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25255082}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25255936},{"metricName":"number of input batches","value":6170}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":999},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25255936}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8115}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25340143}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25341952},{"metricName":"number of input batches","value":6188}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1343},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25341952}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":7660}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":27853889}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27854122},{"metricName":"number of input batches","value":6811}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1332},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27854122}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":7630}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":24979257}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24979257},{"metricName":"number of input batches","value":6108}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1176},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24979257}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":241695,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#422L DESC NULLS LAST], output=[toprettystring(UserID)#431,toprettystring(m)#432,toprettystring(SearchPhrase)#433,toprettystring(count(1))#434])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":43076}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#439, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":39469},{"metricName":"peak memory","value":6945767424},{"metricName":"number of output rows","value":57209705},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":490}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#439, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=907]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102325292},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2948403588},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":105310566},{"metricName":"local bytes read","value":2428535546},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2613},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4909077680},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2181448259}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":127864}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#439, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":103240},{"metricName":"peak memory","value":14394851328},{"metricName":"number of output rows","value":102325295},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1152}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#439]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":111287131},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":103475}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3698},{"metricName":"peak memory","value":10435428352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=754]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102848450},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3050872614},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119278091},{"metricName":"local bytes read","value":2502734297},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3291150496},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2094561885}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":32961}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102848453}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102852409},{"metricName":"number of input batches","value":25130}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10616},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102852409}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":103340}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3647},{"metricName":"peak memory","value":10435428352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1322125186},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=791]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":107246003},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1868916467},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":116488428},{"metricName":"local bytes read","value":1506407507},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3389650072},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1294839893}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7135}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":28273567}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28275869},{"metricName":"number of input batches","value":6908}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1115},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":28275869}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8150}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25533417}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25534464},{"metricName":"number of input batches","value":6235}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1344},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25534464}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":7756}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6114}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1154},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":7700}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":28432942}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28434225},{"metricName":"number of input batches","value":6953}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1271},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":28434225}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":240109,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#534L DESC NULLS LAST], output=[toprettystring(UserID)#543,toprettystring(m)#544,toprettystring(SearchPhrase)#545,toprettystring(count(1))#546])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":42883}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#551, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38126},{"metricName":"peak memory","value":6744440832},{"metricName":"number of output rows","value":56384822},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":476}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#551, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2135]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101300469},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2939341191},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":103138563},{"metricName":"local bytes read","value":2407004080},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4862327984},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2149229269}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":125386}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#551, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":101083},{"metricName":"peak memory","value":14193524736},{"metricName":"number of output rows","value":101300473},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1136}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#551]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":109696040},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":101198}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3556},{"metricName":"peak memory","value":10301210624},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1982]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103712842},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3018243666},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":117598603},{"metricName":"local bytes read","value":2503013301},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3318811040},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2117946220}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":33352}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":103712845}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":103714064},{"metricName":"number of input batches","value":25341}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10730},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":103714064}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":101084}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3556},{"metricName":"peak memory","value":10166992896},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1322125186},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2019]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102356506},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1802879222},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":114482432},{"metricName":"local bytes read","value":1506576109},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3247652864},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1260705499}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7161}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":980},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8049}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":26444162}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26447872},{"metricName":"number of input batches","value":6458}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1328},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":26447872}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":7560}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25189729}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25190400},{"metricName":"number of input batches","value":6159}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1152},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25190400}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":7692}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25716537}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25716537},{"metricName":"number of input batches","value":6288}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1168},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":25716537}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":240365,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#506L DESC NULLS LAST], output=[toprettystring(UserID)#515,toprettystring(m)#516,toprettystring(SearchPhrase)#517,toprettystring(count(1))#518])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":42972}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#523, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":39345},{"metricName":"peak memory","value":6945767424},{"metricName":"number of output rows","value":57293299},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":490}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#523, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1828]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100463169},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2935350837},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":105845326},{"metricName":"local bytes read","value":2407004080},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4822340176},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2149229269}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":125382}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#523, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":99485},{"metricName":"peak memory","value":13992198144},{"metricName":"number of output rows","value":100463172},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1120}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#523]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":108536393},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":99637}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3609},{"metricName":"peak memory","value":10435428352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1675]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103932749},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3023615524},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118512196},{"metricName":"local bytes read","value":2502966066},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3325848032},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2125606247}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":33427}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":103932751}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":103935771},{"metricName":"number of input batches","value":25396}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10651},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":103935771}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":99530}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3507},{"metricName":"peak memory","value":10032775168},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1322125186},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1712]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":105763923},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1763953826},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":114546686},{"metricName":"local bytes read","value":1506542119},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3366238336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1260705499}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7147}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":982},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8063}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":27865597}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27865980},{"metricName":"number of input batches","value":6805}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1370},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":27865980}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":7545}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":26335345}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26337280},{"metricName":"number of input batches","value":6439}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1183},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":26337280}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":7663}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":26556904}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26560313},{"metricName":"number of input batches","value":6494}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1297},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":26560313}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":243304,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[count(1)#478L DESC NULLS LAST], output=[toprettystring(UserID)#487,toprettystring(m)#488,toprettystring(SearchPhrase)#489,toprettystring(count(1))#490])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":43117}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#495, SearchPhrase#203], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38369},{"metricName":"peak memory","value":6744440832},{"metricName":"number of output rows","value":56384822},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":476}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":2215755674},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(UserID#9L, _groupingexpression#495, SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1521]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101461325},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3017293412},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":104510249},{"metricName":"local bytes read","value":2406957454},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4869705976},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2149229269}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":128105}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[UserID#9L, _groupingexpression#495, SearchPhrase#203], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":103143},{"metricName":"peak memory","value":14193524736},{"metricName":"number of output rows","value":101461328},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":1136}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203, minute(EventTime#4, Some(Etc/UTC)) AS _groupingexpression#495]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":110646589},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":103337}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3709},{"metricName":"peak memory","value":10435428352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":2204185535},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1368]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102249823},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2990327137},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119507096},{"metricName":"local bytes read","value":2503192711},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":5360},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3271994400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2094561885}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":32888}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102249826}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102256429},{"metricName":"number of input batches","value":24985}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,EventTime#4,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,EventTime:timestamp,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,EventTime:timestamp,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10419},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102256429}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":103220}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3698},{"metricName":"peak memory","value":10301210624},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1322125186},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1405]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":108972621},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1742145022},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":116377497},{"metricName":"local bytes read","value":1506598199},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3465044160},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1260705499}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7149}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#202)","metadata":{},"metrics":[{"metricName":"number of output rows","value":27219790}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27219790},{"metricName":"number of input batches","value":6650}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1069},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":27219790}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":8056}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#214)","metadata":{},"metrics":[{"metricName":"number of output rows","value":26109406}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26112000},{"metricName":"number of input batches","value":6376}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1344},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":26112000}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":7611}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#226)","metadata":{},"metrics":[{"metricName":"number of output rows","value":27712425}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27713536},{"metricName":"number of input batches","value":6775}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1295},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27713536}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":7654}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#238)","metadata":{},"metrics":[{"metricName":"number of output rows","value":27931002}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27931002},{"metricName":"number of input batches","value":6830}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1306},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":27931002}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]