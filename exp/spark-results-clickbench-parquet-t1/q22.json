[{"totalTime":82042,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#450L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#460,toprettystring(min(URL))#461,toprettystring(c)#462])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":677}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":25}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":6},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":176479},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1478]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":725},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":36159691},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":725},{"metricName":"local bytes read","value":168769},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":8},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":158168},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":168769}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[partial_min(URL#205), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":725}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7949}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4},{"metricName":"peak memory","value":537395200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1090}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1261]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102490962},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1177221708},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":105363467},{"metricName":"local bytes read","value":562423854},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":75},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1639855392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24356}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102490963}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102493929},{"metricName":"number of input batches","value":25043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8649},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102493929}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1415]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":8},{"metricName":"time to collect","value":42},{"metricName":"number of output rows","value":1038},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1298]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1094},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":105317390},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1038},{"metricName":"local bytes read","value":236411},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":218384},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":236411}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8516}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#205) AND isnotnull(SearchPhrase#203)) AND Contains(URL#205, google)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":159}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26482510},{"metricName":"number of input batches","value":6470}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205] Batched: true, DataFilters: [isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#20..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4562},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":26482510}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":10943}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#217) AND isnotnull(SearchPhrase#215)) AND Contains(URL#217, google)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":458}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27258880},{"metricName":"number of input batches","value":6656}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217] Batched: true, DataFilters: [isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#21..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6799},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":27258880}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":14736}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#229) AND isnotnull(SearchPhrase#227)) AND Contains(URL#229, google)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":249}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27079934},{"metricName":"number of input batches","value":6622}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229] Batched: true, DataFilters: [isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#22..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8905},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27079934}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":12889}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#241) AND isnotnull(SearchPhrase#239)) AND Contains(URL#241, google)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":228}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25470777},{"metricName":"number of input batches","value":6228}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241] Batched: true, DataFilters: [isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#23..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7580},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":25470777}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":82654,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#421L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#431,toprettystring(min(URL))#432,toprettystring(c)#433])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":677}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":16}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":176479},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1106]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":725},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":41530030},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":725},{"metricName":"local bytes read","value":168769},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":8},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":158168},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":168769}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[partial_min(URL#205), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":725}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7858}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":537395200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1095}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=889]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101082678},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1187945994},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":109519750},{"metricName":"local bytes read","value":560563987},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":75},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1617322848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24858}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101082680}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101087033},{"metricName":"number of input batches","value":24699}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8914},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101087033}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1043]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":4},{"metricName":"time to build","value":4},{"metricName":"time to collect","value":49},{"metricName":"number of output rows","value":1038},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=926]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1047},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":97455008},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1038},{"metricName":"local bytes read","value":236411},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":213016},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":236411}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8540}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#205) AND isnotnull(SearchPhrase#203)) AND Contains(URL#205, google)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":158}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26251264},{"metricName":"number of input batches","value":6413}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205] Batched: true, DataFilters: [isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#20..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4428},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":26251264}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":10997}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#217) AND isnotnull(SearchPhrase#215)) AND Contains(URL#217, google)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":451}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25497600},{"metricName":"number of input batches","value":6226}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217] Batched: true, DataFilters: [isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#21..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6032},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25497600}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":14778}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#229) AND isnotnull(SearchPhrase#227)) AND Contains(URL#229, google)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":203}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25489408},{"metricName":"number of input batches","value":6232}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229] Batched: true, DataFilters: [isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#22..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8754},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25489408}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":12865}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#241) AND isnotnull(SearchPhrase#239)) AND Contains(URL#241, google)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":235}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27121772},{"metricName":"number of input batches","value":6633}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241] Batched: true, DataFilters: [isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#23..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7650},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":27121772}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":81128,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#537L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#547,toprettystring(min(URL))#548,toprettystring(c)#549])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":677}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":10}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":176479},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2594]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":725},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":42141026},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":725},{"metricName":"local bytes read","value":168769},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":8},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":158168},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":168769}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[partial_min(URL#205), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":725}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7841}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":537395200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1038}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2377]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103863232},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1199182775},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":99997497},{"metricName":"local bytes read","value":503639567},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":67},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1661811760},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":23996}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":103863235}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":103868217},{"metricName":"number of input batches","value":25378}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8497},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":103868217}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2531]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":32},{"metricName":"number of output rows","value":1038},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2414]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1094},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":103397003},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1038},{"metricName":"local bytes read","value":236411},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":222568},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":236411}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8468}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#205) AND isnotnull(SearchPhrase#203)) AND Contains(URL#205, google)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":161}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26841088},{"metricName":"number of input batches","value":6557}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205] Batched: true, DataFilters: [isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#20..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4466},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":26841088}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":10923}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#217) AND isnotnull(SearchPhrase#215)) AND Contains(URL#217, google)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":481}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25497600},{"metricName":"number of input batches","value":6226}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217] Batched: true, DataFilters: [isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#21..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6156},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25497600}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":14596}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#229) AND isnotnull(SearchPhrase#227)) AND Contains(URL#229, google)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":204}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26824704},{"metricName":"number of input batches","value":6558}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229] Batched: true, DataFilters: [isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#22..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9822},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":26824704}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":12817}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#241) AND isnotnull(SearchPhrase#239)) AND Contains(URL#241, google)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":248}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27683914},{"metricName":"number of input batches","value":6769}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241] Batched: true, DataFilters: [isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#23..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8070},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":27683914}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":82427,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#508L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#518,toprettystring(min(URL))#519,toprettystring(c)#520])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":677}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":16}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":176479},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2222]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":725},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":43604838},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":725},{"metricName":"local bytes read","value":168769},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":8},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":158168},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":168769}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[partial_min(URL#205), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":725}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7875}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":537395200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1079}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2005]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100960675},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1177893626},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":105812410},{"metricName":"local bytes read","value":584453287},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":76},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1615370800},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24522}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100960675}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100962993},{"metricName":"number of input batches","value":24670}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8630},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100962993}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2159]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":28},{"metricName":"number of output rows","value":1038},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2042]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1238},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":101896489},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1038},{"metricName":"local bytes read","value":236411},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":253480},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":236411}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8478}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#205) AND isnotnull(SearchPhrase#203)) AND Contains(URL#205, google)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":258}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":31152116},{"metricName":"number of input batches","value":7610}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205] Batched: true, DataFilters: [isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#20..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4681},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":31152116}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":10994}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#217) AND isnotnull(SearchPhrase#215)) AND Contains(URL#217, google)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":525}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26390528},{"metricName":"number of input batches","value":6444}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217] Batched: true, DataFilters: [isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#21..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6637},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":26390528}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":14630}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#229) AND isnotnull(SearchPhrase#227)) AND Contains(URL#229, google)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":214}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26320896},{"metricName":"number of input batches","value":6435}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229] Batched: true, DataFilters: [isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#22..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8430},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":26320896}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13437}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#241) AND isnotnull(SearchPhrase#239)) AND Contains(URL#241, google)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":241}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26683193},{"metricName":"number of input batches","value":6524}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241] Batched: true, DataFilters: [isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#23..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9448},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":26683193}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":81523,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[c#479L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#489,toprettystring(min(URL))#490,toprettystring(c)#491])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[min(URL#205), count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":677}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":16}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":176479},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1850]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":725},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":35713027},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":725},{"metricName":"local bytes read","value":168769},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":8},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":158168},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":168769}],"children":[{"nodeName":"SortAggregate","description":"SortAggregate(key=[SearchPhrase#203], functions=[partial_min(URL#205), partial_count(1)])","metadata":{},"metrics":[{"metricName":"number of output rows","value":725}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7753}],"children":[{"nodeName":"Sort","description":"Sort [SearchPhrase#203 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1},{"metricName":"peak memory","value":537395200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [SearchPhrase#203, URL#205]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [rid#0L], [cast(rid#202 as bigint)], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1196}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1633]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102454090},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1172825835},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":106708686},{"metricName":"local bytes read","value":568559923},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":76},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1639265472},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":503639567}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24242}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102454092}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102459193},{"metricName":"number of input batches","value":25034}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8624},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102459193}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1787]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":46},{"metricName":"number of output rows","value":1038},{"metricName":"data size","value":1114112}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1670]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1246},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":103278473},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1038},{"metricName":"local bytes read","value":236411},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":29},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":245544},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":236411}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8518}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#205) AND isnotnull(SearchPhrase#203)) AND Contains(URL#205, google)) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":160}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25743360},{"metricName":"number of input batches","value":6289}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203,URL#205] Batched: true, DataFilters: [isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#20..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#205), isnotnull(SearchPhrase#203), Contains(URL#205, google), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4295},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25743360}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":10941}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#217) AND isnotnull(SearchPhrase#215)) AND Contains(URL#217, google)) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":608}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":29860732},{"metricName":"number of input batches","value":7292}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215,URL#217] Batched: true, DataFilters: [isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#21..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#217), isnotnull(SearchPhrase#215), Contains(URL#217, google), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6721},{"metricName":"metadata time","value":4},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":29860732}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":14612}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#229) AND isnotnull(SearchPhrase#227)) AND Contains(URL#229, google)) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":229}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":28447846},{"metricName":"number of input batches","value":6957}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227,URL#229] Batched: true, DataFilters: [isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#22..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#229), isnotnull(SearchPhrase#227), Contains(URL#229, google), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8998},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":28447846}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":12909}],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(URL#241) AND isnotnull(SearchPhrase#239)) AND Contains(URL#241, google)) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":249}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25990969},{"metricName":"number of input batches","value":6355}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239,URL#241] Batched: true, DataFilters: [isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#23..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,))..., ReadSchema: struct<rid:int,SearchPhrase:string,URL:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string,URL:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(URL), IsNotNull(SearchPhrase), StringContains(URL,google), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(URL#241), isnotnull(SearchPhrase#239), Contains(URL#241, google), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7536},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":25990969}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]