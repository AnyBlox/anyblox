[{"totalTime":113709,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#441L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#447,toprettystring(u)#448])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4436}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3811},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1602]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":8385890},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":552816223},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7771855},{"metricName":"local bytes read","value":392173145},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":96},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":751993648},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18516}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":15348},{"metricName":"peak memory","value":2081423360},{"metricName":"number of output rows","value":8385891},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9633},{"metricName":"peak memory","value":2082471936},{"metricName":"number of output rows","value":11641308},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1557]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13355422},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1063393784},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14620895},{"metricName":"local bytes read","value":822706422},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1118012760},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40725}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":35233},{"metricName":"peak memory","value":3007315968},{"metricName":"number of output rows","value":13355424},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":576}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":14307847},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7118}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3781},{"metricName":"peak memory","value":10032775168},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1361]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102115363},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2202704002},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":111998730},{"metricName":"local bytes read","value":1567905417},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2450768712},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":27885}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102115365}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102119679},{"metricName":"number of input batches","value":24952}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9495},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102119679}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":63082}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":409},{"metricName":"peak memory","value":3179282432},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":675803197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1398]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13523916},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1017799603},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14753530},{"metricName":"local bytes read","value":721054859},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1102},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1129672000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":643778666}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3236}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2807638}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26808320},{"metricName":"number of input batches","value":6549}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1057},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":26808320}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":4228}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020023}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1314},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3758}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271352}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6114}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1141},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":3821}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3424903}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25962297},{"metricName":"number of input batches","value":6348}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1229},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":25962297}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":115074,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#415L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#421,toprettystring(u)#422])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4445}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3813},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=1201]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7739678},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":535475720},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7739678},{"metricName":"local bytes read","value":388271359},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":84},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":694071488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18624}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14193},{"metricName":"peak memory","value":1913651200},{"metricName":"number of output rows","value":7739678},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":180}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9717},{"metricName":"peak memory","value":2082471936},{"metricName":"number of output rows","value":10779123},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1156]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13007148},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1051485281},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14829635},{"metricName":"local bytes read","value":823024187},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1088796776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40867}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":33366},{"metricName":"peak memory","value":2839543808},{"metricName":"number of output rows","value":13007148},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":544}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13461157},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":6936}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3446},{"metricName":"peak memory","value":9227468800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=960]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102281257},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2224349450},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":109519386},{"metricName":"local bytes read","value":1609863775},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2613},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2454750192},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28607}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102281259}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102287209},{"metricName":"number of input batches","value":24993}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9694},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102287209}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":59585}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":375},{"metricName":"peak memory","value":2927624192},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":675803197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=997]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13768586},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1038471025},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13567508},{"metricName":"local bytes read","value":740398911},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1131},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1153699552},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":643778666}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3309}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2607007}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1037},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":4249}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4616217}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26112000},{"metricName":"number of input batches","value":6376}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1479},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":26112000}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3844}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271352}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6114}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1190},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":3825}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3274010}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24856377},{"metricName":"number of input batches","value":6078}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1186},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24856377}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":113101,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#519L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#525,toprettystring(u)#526])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4458}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3824},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2805]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7739678},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":539446655},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8874498},{"metricName":"local bytes read","value":452232544},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":96},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":694071488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18500}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14062},{"metricName":"peak memory","value":1913651200},{"metricName":"number of output rows","value":7739678},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":180}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9638},{"metricName":"peak memory","value":2082471936},{"metricName":"number of output rows","value":11245953},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2760]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13394300},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1065467674},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":15200368},{"metricName":"local bytes read","value":822839223},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1121216880},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40381}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":33801},{"metricName":"peak memory","value":2923429888},{"metricName":"number of output rows","value":13394301},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":14225238},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":6936}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3641},{"metricName":"peak memory","value":9764339712},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2564]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102380800},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2259494375},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":109569176},{"metricName":"local bytes read","value":1567892679},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2457139224},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":27709}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102380802}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102385465},{"metricName":"number of input batches","value":25016}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9253},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102385465}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":60377}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":401},{"metricName":"peak memory","value":3095396352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":675803197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2601]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13812540},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1047251851},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14358523},{"metricName":"local bytes read","value":721094486},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1102},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1159371600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":643778666}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3237}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2752480}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26234880},{"metricName":"number of input batches","value":6409}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1033},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":26234880}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":4199}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020023}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1296},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3812}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3766028}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27614586},{"metricName":"number of input batches","value":6752}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1364},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27614586}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":3866}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3274010}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24856377},{"metricName":"number of input batches","value":6078}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1195},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24856377}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":113584,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#493L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#499,toprettystring(u)#500])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4480}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3841},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2404]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7739678},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":537594962},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7739678},{"metricName":"local bytes read","value":388271359},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":84},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":694071488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18524}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14089},{"metricName":"peak memory","value":1913651200},{"metricName":"number of output rows","value":7739678},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":180}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9647},{"metricName":"peak memory","value":2082471936},{"metricName":"number of output rows","value":11029943},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2359]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13007148},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1162804376},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14999605},{"metricName":"local bytes read","value":822905934},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":476},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1088796776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40399}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":32859},{"metricName":"peak memory","value":2839543808},{"metricName":"number of output rows","value":13007148},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":544}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":13646508},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":6934}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3645},{"metricName":"peak memory","value":9764339712},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2163]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101020505},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2210778524},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":111993333},{"metricName":"local bytes read","value":1567863845},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2424492168},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28077}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101020507}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101025593},{"metricName":"number of input batches","value":24684}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9441},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101025593}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":58543}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":386},{"metricName":"peak memory","value":3011510272},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":675803197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2200]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13835358},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1197060851},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":13965225},{"metricName":"local bytes read","value":720987341},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1102},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1156519864},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":643778666}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3230}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2607007}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":987},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":4208}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4500304}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":29184000},{"metricName":"number of input batches","value":7126}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1503},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":29184000}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3766}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3271352}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6114}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1165},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":3792}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3456696}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26683771},{"metricName":"number of input batches","value":6525}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1265},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":26683771}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":113732,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#467L DESC NULLS LAST], output=[toprettystring(SearchPhrase)#473,toprettystring(u)#474])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":4509}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3861},{"metricName":"peak memory","value":1075838976},{"metricName":"number of output rows","value":6019102},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":105}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":403149424},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, 200), ENSURE_REQUIREMENTS, [plan_id=2003]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7739678},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":536797601},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8889991},{"metricName":"local bytes read","value":452493647},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":96},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":694071488},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":388271359}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":18553}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14125},{"metricName":"peak memory","value":1913651200},{"metricName":"number of output rows","value":7739678},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":180}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":9718},{"metricName":"peak memory","value":2082471936},{"metricName":"number of output rows","value":11602307},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":195}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":737885014},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(SearchPhrase#203, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1958]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13177825},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1058552674},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14178074},{"metricName":"local bytes read","value":760132065},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":442},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1103100048},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":697365594}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":40468}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[SearchPhrase#203, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":33951},{"metricName":"peak memory","value":2923429888},{"metricName":"number of output rows","value":13177826},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":560}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, SearchPhrase#203]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":14035344},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":6931}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3744},{"metricName":"peak memory","value":10032775168},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":1480187192},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1762]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102595399},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2211652922},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":111997819},{"metricName":"local bytes read","value":1567889297},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2546},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2462289600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1399893208}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":28115}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102595401}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102602553},{"metricName":"number of input batches","value":25069}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9580},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102602553}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":60676}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":398},{"metricName":"peak memory","value":3095396352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":675803197},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1799]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":13366053},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1021379469},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14465964},{"metricName":"local bytes read","value":721039649},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1102},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1115753432},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":643778666}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3243}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#203) AND NOT (SearchPhrase#203 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2607007}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,SearchPhrase#203] Batched: true, DataFilters: [isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#203), NOT (SearchPhrase#203 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":985},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":4245}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#215) AND NOT (SearchPhrase#215 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4020023}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,SearchPhrase#215] Batched: true, DataFilters: [isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#215), NOT (SearchPhrase#215 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1311},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3760}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#227) AND NOT (SearchPhrase#227 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3465014}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":26425220},{"metricName":"number of input batches","value":6461}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,SearchPhrase#227] Batched: true, DataFilters: [isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#227), NOT (SearchPhrase#227 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1213},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":26425220}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":3800}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(SearchPhrase#239) AND NOT (SearchPhrase#239 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3274010}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24856377},{"metricName":"number of input batches","value":6078}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,SearchPhrase#239] Batched: true, DataFilters: [isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)], ReadSchema: struct<rid:int,SearchPhrase:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,SearchPhrase:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(SearchPhrase), Not(EqualTo(SearchPhrase,)), IsNotNull(rid)]","DataFilters":"[isnotnull(SearchPhrase#239), NOT (SearchPhrase#239 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1156},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24856377}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]