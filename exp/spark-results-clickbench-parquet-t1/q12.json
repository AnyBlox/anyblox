[{"totalTime":66772,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#456L DESC NULLS LAST], output=[toprettystring(MobilePhone)#464,toprettystring(MobilePhoneModel)#465,toprettystring(u)#466])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16748},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, 200), ENSURE_REQUIREMENTS, [plan_id=1602]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":302},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":13906531},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":302},{"metricName":"local bytes read","value":15977},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":12752},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15977}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":2128}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2117},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1980},{"metricName":"peak memory","value":134217728},{"metricName":"number of output rows","value":1188478},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":55127915},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1557]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3910477},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":310415366},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3910477},{"metricName":"local bytes read","value":52535029},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":28},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":156731600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":52535029}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":24653}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":23758},{"metricName":"peak memory","value":1992556544},{"metricName":"number of output rows","value":3910477},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":434}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, MobilePhone#31, MobilePhoneModel#204]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":5563212},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3392},{"metricName":"peak memory","value":8002732032},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":1638210157},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1361]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101203628},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2343472901},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":104550814},{"metricName":"local bytes read","value":1730599075},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2077},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3238516096},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1559018888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29741}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101203629}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101205817},{"metricName":"number of input batches","value":24728}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L,MobilePhone#31] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9764},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101205817}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":47147}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":121},{"metricName":"peak memory","value":2106589184},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":39726844},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1398]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5563212},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":323551486},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5563212},{"metricName":"local bytes read","value":42004652},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":899},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":178450520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":37835678}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1368}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#204) AND NOT (MobilePhoneModel#204 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1318929}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,MobilePhoneModel#204] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":458},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1390}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#216) AND NOT (MobilePhoneModel#216 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1345764}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,MobilePhoneModel#216] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":450},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1451}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#228) AND NOT (MobilePhoneModel#228 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1484163}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006032},{"metricName":"number of input batches","value":6113}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,MobilePhoneModel#228] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":466},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006032}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1417}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#240) AND NOT (MobilePhoneModel#240 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1414356}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24979257},{"metricName":"number of input batches","value":6108}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,MobilePhoneModel#240] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":473},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24979257}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":67381,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#425L DESC NULLS LAST], output=[toprettystring(MobilePhone)#433,toprettystring(MobilePhoneModel)#434,toprettystring(u)#435])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16748},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, 200), ENSURE_REQUIREMENTS, [plan_id=1201]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":302},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":13878498},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":302},{"metricName":"local bytes read","value":15977},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":12752},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15977}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":1848}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1838},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1705},{"metricName":"peak memory","value":134217728},{"metricName":"number of output rows","value":1188478},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":55127915},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1156]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3910477},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":313874446},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3910477},{"metricName":"local bytes read","value":52535029},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":28},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":156731600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":52535029}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":24924}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":24000},{"metricName":"peak memory","value":1992556544},{"metricName":"number of output rows","value":3910477},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":434}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, MobilePhone#31, MobilePhoneModel#204]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":5681014},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3633},{"metricName":"peak memory","value":8539602944},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":1638210157},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=960]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":101808652},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2372038160},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":109084489},{"metricName":"local bytes read","value":1730549353},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2077},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3257876896},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1559018888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":30112}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":101808655}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":101816121},{"metricName":"number of input batches","value":24877}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L,MobilePhone#31] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10165},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":101816121}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":47717}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":127},{"metricName":"peak memory","value":2257584128},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":39726844},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=997]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5563212},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":316125905},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5952450},{"metricName":"local bytes read","value":41994160},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":899},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":178450520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":37835678}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1409}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#204) AND NOT (MobilePhoneModel#204 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1318929}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,MobilePhoneModel#204] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":477},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1459}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#216) AND NOT (MobilePhoneModel#216 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1345764}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,MobilePhoneModel#216] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":477},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1412}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#228) AND NOT (MobilePhoneModel#228 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1484163}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006032},{"metricName":"number of input batches","value":6113}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,MobilePhoneModel#228] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":448},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006032}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1408}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#240) AND NOT (MobilePhoneModel#240 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1414356}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24979257},{"metricName":"number of input batches","value":6108}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,MobilePhoneModel#240] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":454},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24979257}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":65545,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#549L DESC NULLS LAST], output=[toprettystring(MobilePhone)#557,toprettystring(MobilePhoneModel)#558,toprettystring(u)#559])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":5}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16748},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, 200), ENSURE_REQUIREMENTS, [plan_id=2805]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":302},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11488313},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":302},{"metricName":"local bytes read","value":15977},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":12752},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15977}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":1728}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1710},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1644},{"metricName":"peak memory","value":134217728},{"metricName":"number of output rows","value":1188478},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":55127915},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2760]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3910477},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":315726130},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3910477},{"metricName":"local bytes read","value":52535029},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":28},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":156731600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":52535029}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":24387}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":23463},{"metricName":"peak memory","value":1992556544},{"metricName":"number of output rows","value":3910477},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":434}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, MobilePhone#31, MobilePhoneModel#204]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":5713069},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3643},{"metricName":"peak memory","value":8606711808},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":1638210157},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2564]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":100646852},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2335789818},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":111368623},{"metricName":"local bytes read","value":1738319396},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2077},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3220699328},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1559018888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29416}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":100646854}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":100648761},{"metricName":"number of input batches","value":24592}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L,MobilePhone#31] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9621},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":100648761}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":46521}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":133},{"metricName":"peak memory","value":2182086656},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":39726844},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2601]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5605979},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":320336551},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5903570},{"metricName":"local bytes read","value":42186355},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":899},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":179821912},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":37835678}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1392}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#204) AND NOT (MobilePhoneModel#204 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1361696}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25890816},{"metricName":"number of input batches","value":6325}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,MobilePhoneModel#204] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":475},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25890816}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1385}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#216) AND NOT (MobilePhoneModel#216 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1345764}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,MobilePhoneModel#216] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":453},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1438}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#228) AND NOT (MobilePhoneModel#228 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1484163}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006032},{"metricName":"number of input batches","value":6113}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,MobilePhoneModel#228] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":455},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006032}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1423}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#240) AND NOT (MobilePhoneModel#240 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1414356}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24979257},{"metricName":"number of input batches","value":6108}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,MobilePhoneModel#240] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":458},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24979257}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":66025,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#518L DESC NULLS LAST], output=[toprettystring(MobilePhone)#526,toprettystring(MobilePhoneModel)#527,toprettystring(u)#528])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":5}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16748},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, 200), ENSURE_REQUIREMENTS, [plan_id=2404]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":302},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7746591},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":302},{"metricName":"local bytes read","value":15977},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":12752},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15977}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":1742}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1732},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1661},{"metricName":"peak memory","value":134217728},{"metricName":"number of output rows","value":1188478},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":55127915},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=2359]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3910477},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":313273360},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3910477},{"metricName":"local bytes read","value":52535029},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":28},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":156731600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":52535029}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":24414}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":23524},{"metricName":"peak memory","value":1992556544},{"metricName":"number of output rows","value":3910477},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":434}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, MobilePhone#31, MobilePhoneModel#204]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":5563212},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3388},{"metricName":"peak memory","value":8002732032},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":1638210157},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=2163]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":102352478},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2353200094},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":103917201},{"metricName":"local bytes read","value":1738249133},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2077},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3275279328},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1559018888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29691}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":102352480}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":102356841},{"metricName":"number of input batches","value":25010}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L,MobilePhone#31] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9802},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":102356841}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":46637}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":133},{"metricName":"peak memory","value":2106589184},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":39726844},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=2200]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5563212},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":437803014},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5563212},{"metricName":"local bytes read","value":42182660},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":899},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":178450520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":37835678}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1378}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#204) AND NOT (MobilePhoneModel#204 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1318929}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,MobilePhoneModel#204] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":451},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1384}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#216) AND NOT (MobilePhoneModel#216 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1345764}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,MobilePhoneModel#216] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":454},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1426}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#228) AND NOT (MobilePhoneModel#228 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1484163}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006032},{"metricName":"number of input batches","value":6113}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,MobilePhoneModel#228] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":459},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":25006032}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1440}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#240) AND NOT (MobilePhoneModel#240 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1414356}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24979257},{"metricName":"number of input batches","value":6108}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,MobilePhoneModel#240] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":457},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24979257}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":66054,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[u#487L DESC NULLS LAST], output=[toprettystring(MobilePhone)#495,toprettystring(MobilePhoneModel)#496,toprettystring(u)#497])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":5}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16748},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, 200), ENSURE_REQUIREMENTS, [plan_id=2003]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":302},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7791382},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":302},{"metricName":"local bytes read","value":15977},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":12752},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15977}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":1750}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204], functions=[partial_count(distinct UserID#9L)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1743},{"metricName":"peak memory","value":262144},{"metricName":"number of output rows","value":302},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1676},{"metricName":"peak memory","value":134217728},{"metricName":"number of output rows","value":1188478},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":55127915},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(MobilePhone#31, MobilePhoneModel#204, UserID#9L, 200), ENSURE_REQUIREMENTS, [plan_id=1958]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3910477},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":311781715},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7001588},{"metricName":"local bytes read","value":105070058},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":56},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":156731600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":52535029}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":24640}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[MobilePhone#31, MobilePhoneModel#204, UserID#9L], functions=[])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":23734},{"metricName":"peak memory","value":1992556544},{"metricName":"number of output rows","value":3910477},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":434}],"children":[{"nodeName":"Project","description":"Project [UserID#9L, MobilePhone#31, MobilePhoneModel#204]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [rid#0L], [cast(rid#202 as bigint)], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":5785583},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [rid#0L ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3538},{"metricName":"peak memory","value":8338276352},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":1638210157},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(rid#0L, 200), ENSURE_REQUIREMENTS, [plan_id=1762]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":103540474},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2369839254},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":104168568},{"metricName":"local bytes read","value":1675897782},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2010},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3313295200},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1559018888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29506}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(rid#0L)","metadata":{},"metrics":[{"metricName":"number of output rows","value":103540476}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":103544633},{"metricName":"number of input batches","value":25299}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#0L,UserID#9L,MobilePhone#31] Batched: true, DataFilters: [isnotnull(rid#0L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(rid)], ReadSchema: struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-base.parquet]","ReadSchema":"struct<rid:bigint,UserID:bigint,MobilePhone:smallint>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(rid)]","DataFilters":"[isnotnull(rid#0L)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9459},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":8888366239},{"metricName":"number of output rows","value":103544633}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":48917}],"children":[{"nodeName":"Sort","description":"Sort [cast(rid#202 as bigint) ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":140},{"metricName":"peak memory","value":2182086656},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":28},{"metricName":"partition data size","value":39726844},{"metricName":"number of coalesced partitions","value":27}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(cast(rid#202 as bigint), 200), ENSURE_REQUIREMENTS, [plan_id=1799]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5715429},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":316109766},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5785583},{"metricName":"local bytes read","value":40673452},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":870},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":183332328},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":37835678}],"children":[{"nodeName":"Union","description":"Union","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1387}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#204) AND NOT (MobilePhoneModel#204 = )) AND isnotnull(rid#202))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1318929}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6109}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#202,MobilePhoneModel#204] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-0.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#204), NOT (MobilePhoneModel#204 = ), isnotnull(rid#202)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":464},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":768458232},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1387}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#216) AND NOT (MobilePhoneModel#216 = )) AND isnotnull(rid#214))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1345764}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25006080},{"metricName":"number of input batches","value":6106}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#214,MobilePhoneModel#216] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-1.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#216), NOT (MobilePhoneModel#216 = ), isnotnull(rid#214)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":451},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":867045466},{"metricName":"number of output rows","value":25006080}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1451}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#228) AND NOT (MobilePhoneModel#228 = )) AND isnotnull(rid#226))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1636380}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":27453258},{"metricName":"number of input batches","value":6714}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#226,MobilePhoneModel#228] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-2.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#228), NOT (MobilePhoneModel#228 = ), isnotnull(rid#226)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":506},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1027745831},{"metricName":"number of output rows","value":27453258}],"children":[]}]}]}]}]},{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1417}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(MobilePhoneModel#240) AND NOT (MobilePhoneModel#240 = )) AND isnotnull(rid#238))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1414356}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":24979257},{"metricName":"number of input batches","value":6108}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [rid#238,MobilePhoneModel#240] Batched: true, DataFilters: [isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)], ReadSchema: struct<rid:int,MobilePhoneModel:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/ClickBench/hits-strings-3.parquet]","ReadSchema":"struct<rid:int,MobilePhoneModel:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(MobilePhoneModel), Not(EqualTo(MobilePhoneModel,)), IsNotNull(rid)]","DataFilters":"[isnotnull(MobilePhoneModel#240), NOT (MobilePhoneModel#240 = ), isnotnull(rid#238)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":457},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":947629660},{"metricName":"number of output rows","value":24979257}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]