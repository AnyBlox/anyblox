[{"totalTime":44332,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#172 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#182,toprettystring(revenue)#183,toprettystring(o_orderdate)#184,toprettystring(o_shippriority)#185])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14701}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14660},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14595},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13554}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":88},{"metricName":"peak memory","value":1277165568},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=1198]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2924425},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":72496995},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3334968},{"metricName":"local bytes read","value":36558849},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":68},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":93581600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2857}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2924425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1068]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":67},{"metricName":"time to build","value":132},{"metricName":"time to collect","value":25321},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=956]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":600888},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22885876},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":9614208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":371}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":600888}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":45},{"metricName":"metadata time","value":3},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=975]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":15978045},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":384691465},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14577240},{"metricName":"local bytes read","value":223228463},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":639121800},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4402}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":15978046}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":32885572},{"metricName":"number of input batches","value":8167}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":639},{"metricName":"metadata time","value":4},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":32885572}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":999}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1956},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=1005]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":66890620},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1503432616},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":70481760},{"metricName":"local bytes read","value":998153919},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":697},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2140499872},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":18548}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":66890621}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":124075746},{"metricName":"number of input batches","value":30585}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5470},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":124075746}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":42433,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#272 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#282,toprettystring(revenue)#283,toprettystring(o_orderdate)#284,toprettystring(o_shippriority)#285])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14577}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14532},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14473},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13305}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":96},{"metricName":"peak memory","value":1277165568},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=2850]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2924425},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":76260880},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3333342},{"metricName":"local bytes read","value":36539479},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":68},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":93581600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2491}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2924425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2720]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":67},{"metricName":"time to build","value":192},{"metricName":"time to collect","value":24109},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2608]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":600888},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":32116978},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":9614208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":354}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":600888}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":32},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=2627]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14577240},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":351143591},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14577240},{"metricName":"local bytes read","value":223228463},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":583089600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4087}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14577240}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":435},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1094}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1962},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=2657]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":67562151},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1396434032},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":69718073},{"metricName":"local bytes read","value":998169771},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":697},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2161988864},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":17826}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":67562152}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":125327771},{"metricName":"number of input batches","value":30892}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5069},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":125327771}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":42496,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#247 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#257,toprettystring(revenue)#258,toprettystring(o_orderdate)#259,toprettystring(o_shippriority)#260])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14499}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14463},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14401},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13344}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":101},{"metricName":"peak memory","value":1277165568},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=2437]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2924425},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":75237310},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3333744},{"metricName":"local bytes read","value":36546274},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":68},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":93581600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2426}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2924425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2307]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":71},{"metricName":"time to build","value":128},{"metricName":"time to collect","value":24306},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2195]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":755421},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23350397},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":12086752},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":373}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":755422}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3772823},{"metricName":"number of input batches","value":938}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":55},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3772823}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=2214]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14577240},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":352988832},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14577240},{"metricName":"local bytes read","value":223228463},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":583089600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4157}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14577240}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":485},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1009}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1954},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=2244]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":67662459},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1396439733},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":70208260},{"metricName":"local bytes read","value":998191678},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":697},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2165198720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":896315906}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":18420}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":67662460}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":125516000},{"metricName":"number of input batches","value":30938}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5205},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":125516000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":42596,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#222 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#232,toprettystring(revenue)#233,toprettystring(o_orderdate)#234,toprettystring(o_shippriority)#235])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14457}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14429},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14370},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":601556},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13311}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":88},{"metricName":"peak memory","value":1201668096},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=2024]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2924425},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":80923943},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3128432},{"metricName":"local bytes read","value":34295850},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":64},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":93581600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2522}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2924425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1894]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":73},{"metricName":"time to build","value":124},{"metricName":"time to collect","value":24331},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=1782]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":600888},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":28223874},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":9614208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":366}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":600888}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":19},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=1801]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":15792321},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":358101048},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14577240},{"metricName":"local bytes read","value":223228463},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":10},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":631692880},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4061}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":15792322}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":32500097},{"metricName":"number of input batches","value":8069}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":459},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":32500097}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":995}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1956},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=1831]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":65994741},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1391747856},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":64965973},{"metricName":"local bytes read","value":936806141},{"metricName":"fetch wait time","value":3},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":656},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2111831712},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":18022}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":65994742}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":122421254},{"metricName":"number of input batches","value":30182}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5148},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":122421254}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":43423,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=10, orderBy=[revenue#197 DESC NULLS LAST,o_orderdate#60 ASC NULLS FIRST], output=[toprettystring(l_orderkey)#207,toprettystring(revenue)#208,toprettystring(o_orderdate)#209,toprettystring(o_shippriority)#210])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":14486}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14455},{"metricName":"peak memory","value":1014235136},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":221}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_orderkey#16, o_orderdate#60, o_shippriority#63], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14390},{"metricName":"peak memory","value":1010565120},{"metricName":"number of output rows","value":227611},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":150}],"children":[{"nodeName":"Project","description":"Project [o_orderdate#60, o_shippriority#63, l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#56], [l_orderkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":631715},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13329}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":91},{"metricName":"peak memory","value":1201668096},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":33480814},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=1611]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3836843},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":79047628},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3129257},{"metricName":"local bytes read","value":34304896},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":64},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":122778976},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":32058651}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":2431}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#56, o_orderdate#60, o_shippriority#63]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_custkey#0], [o_custkey#57], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3836843}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1481]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":69},{"metricName":"time to build","value":133},{"metricName":"time to collect","value":25159},{"metricName":"number of output rows","value":600888},{"metricName":"data size","value":40777168}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=1369]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":600888},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":28084672},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":600888},{"metricName":"local bytes read","value":3152384},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":9614208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3152384}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":395}],"children":[{"nodeName":"Project","description":"Project [c_custkey#0]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(c_mktsegment#6) AND (c_mktsegment#6 = BUILDING)) AND isnotnull(c_custkey#0))","metadata":{},"metrics":[{"metricName":"number of output rows","value":600888}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_mktsegment#6] Batched: true, DataFilters: [isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)], ReadSchema: struct<c_custkey:int,c_mktsegment:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_mktsegment:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_mktsegment), EqualTo(c_mktsegment,BUILDING), IsNotNull(c_custkey)]","DataFilters":"[isnotnull(c_mktsegment#6), (c_mktsegment#6 = BUILDING), isnotnull(c_custkey#0)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":69},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":4}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=1388]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14577240},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":357759733},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":19125500},{"metricName":"local bytes read","value":293629066},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":13},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":583089600},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":223228463}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4145}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(o_orderdate#60) AND (o_orderdate#60 < 1995-03-15)) AND isnotnull(o_custkey#57)) AND isnotnull(o_orderkey#56))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14577240}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57,o_orderdate#60,o_shippriority#63] Batched: true, DataFilters: [isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_o..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orde..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date,o_shippriority:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), LessThan(o_orderdate,1995-03-15), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#60), (o_orderdate#60 < 1995-03-15), isnotnull(o_custkey#57), isnotnull(o_orderkey#56)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":477},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1002}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2094},{"metricName":"peak memory","value":7180648448},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":15},{"metricName":"partition data size","value":918163688},{"metricName":"number of coalesced partitions","value":15}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=1418]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":65467589},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1659831329},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":69215331},{"metricName":"local bytes read","value":936817490},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":656},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2094962848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":875545516}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":18513}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#16, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#26) AND (l_shipdate#26 > 1995-03-15)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":65467590}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":121450089},{"metricName":"number of input batches","value":29942}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)], ReadSchema: struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThan(l_shipdate,1995-03-15), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 > 1995-03-15), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5254},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":121450089}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]