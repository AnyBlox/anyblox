[{"totalTime":115988,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1419]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":40},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7469030},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":40},{"metricName":"local bytes read","value":2360},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":640},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2360}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":29922}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29918},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":40},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#74], [l_partkey#219], Inner, (l_quantity#20 < (0.2 * avg(l_quantity))#217)","metadata":{},"metrics":[{"metricName":"number of output rows","value":10913},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":30037}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":2824077312},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":130570}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":1794406674},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=1111]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":127543212},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2359054607},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":128471745},{"metricName":"local bytes read","value":1861883268},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4081382816},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1764114489}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":30685}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_partkey#17) AND isnotnull(l_quantity#20))","metadata":{},"metrics":[{"metricName":"number of output rows","value":127543214}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":127547964},{"metricName":"number of input batches","value":31442}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_quantity#20,l_extendedprice#21] Batched: true, DataFilters: [isnotnull(l_partkey#17), isnotnull(l_quantity#20)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey), IsNotNull(l_quantity)], ReadSchema: struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey), IsNotNull(l_quantity)]","DataFilters":"[isnotnull(l_partkey#17), isnotnull(l_quantity#20)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4210},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":127547964}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1290]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":3},{"metricName":"time to collect","value":52658},{"metricName":"number of output rows","value":4066},{"metricName":"data size","value":1179648}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=1130]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4066},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":16279186},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4066},{"metricName":"local bytes read","value":47222},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":65056},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":47222}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":266}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(p_brand#77) AND isnotnull(p_container#80)) AND (p_brand#77 = Brand#23)) AND (p_container#80 = MED BOX)) AND isnotnull(p_partkey#74))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4066}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_brand#77,p_container#80] Batched: true, DataFilters: [isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED B..., ReadSchema: struct<p_partkey:int,p_brand:string,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED BOX), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED BOX), isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":64},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#219 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":40},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.2 * avg(l_quantity))#217)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#219], functions=[avg(l_quantity#222)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":16400},{"metricName":"peak memory","value":2852126720},{"metricName":"number of output rows","value":4000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":486}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":852330442},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#219, 200), ENSURE_REQUIREMENTS, [plan_id=1153]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":87978538},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1310565205},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":86781486},{"metricName":"local bytes read","value":888497824},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2815313248},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":846851336}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":52491}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#219], functions=[partial_avg(l_quantity#222)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":36336},{"metricName":"peak memory","value":8657043456},{"metricName":"number of output rows","value":87978539},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":645}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(l_partkey#219)","metadata":{},"metrics":[{"metricName":"number of output rows","value":133483301}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":133490862},{"metricName":"number of input batches","value":32910}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#219,l_quantity#222] Batched: true, DataFilters: [isnotnull(l_partkey#219)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey)], ReadSchema: struct<l_partkey:int,l_quantity:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_partkey#219)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1743},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":133490862}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":116078,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=3327]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":40},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7531983},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":40},{"metricName":"local bytes read","value":2360},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":640},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2360}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":29556}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29555},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":40},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#74], [l_partkey#403], Inner, (l_quantity#20 < (0.2 * avg(l_quantity))#401)","metadata":{},"metrics":[{"metricName":"number of output rows","value":10913},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":29632}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":2756837376},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":128821}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":1794406674},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=3019]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":126535475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3273145771},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":126427937},{"metricName":"local bytes read","value":1861593502},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4049135328},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1732154851}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":30053}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_partkey#17) AND isnotnull(l_quantity#20))","metadata":{},"metrics":[{"metricName":"number of output rows","value":126535479}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":126543044},{"metricName":"number of input batches","value":31202}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_quantity#20,l_extendedprice#21] Batched: true, DataFilters: [isnotnull(l_partkey#17), isnotnull(l_quantity#20)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey), IsNotNull(l_quantity)], ReadSchema: struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey), IsNotNull(l_quantity)]","DataFilters":"[isnotnull(l_partkey#17), isnotnull(l_quantity#20)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4122},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":126543044}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3198]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":9},{"metricName":"time to build","value":5},{"metricName":"time to collect","value":52736},{"metricName":"number of output rows","value":4066},{"metricName":"data size","value":1179648}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=3038]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4066},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":17000798},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4066},{"metricName":"local bytes read","value":47222},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":65056},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":47222}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":268}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(p_brand#77) AND isnotnull(p_container#80)) AND (p_brand#77 = Brand#23)) AND (p_container#80 = MED BOX)) AND isnotnull(p_partkey#74))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4066}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_brand#77,p_container#80] Batched: true, DataFilters: [isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED B..., ReadSchema: struct<p_partkey:int,p_brand:string,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED BOX), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED BOX), isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":78},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#403 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":40},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.2 * avg(l_quantity))#401)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#403], functions=[avg(l_quantity#406)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":16361},{"metricName":"peak memory","value":2852126720},{"metricName":"number of output rows","value":4000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":486}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":852330442},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#403, 200), ENSURE_REQUIREMENTS, [plan_id=3061]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":87904806},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1696493761},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":86082410},{"metricName":"local bytes read","value":888358880},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2812953824},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":834687782}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":52379}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#403], functions=[partial_avg(l_quantity#406)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":36073},{"metricName":"peak memory","value":8657043456},{"metricName":"number of output rows","value":87904807},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":645}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(l_partkey#403)","metadata":{},"metrics":[{"metricName":"number of output rows","value":129919763}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":129927048},{"metricName":"number of input batches","value":32024}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#403,l_quantity#406] Batched: true, DataFilters: [isnotnull(l_partkey#403)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey)], ReadSchema: struct<l_partkey:int,l_quantity:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_partkey#403)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1504},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":129927048}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":115032,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=2850]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":40},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12565948},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":40},{"metricName":"local bytes read","value":2360},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":640},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2360}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":29542}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29528},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":40},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#74], [l_partkey#357], Inner, (l_quantity#20 < (0.2 * avg(l_quantity))#355)","metadata":{},"metrics":[{"metricName":"number of output rows","value":10913},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":29620}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":2824077312},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":129081}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":1794406674},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=2542]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":126005864},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2412755606},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":126839452},{"metricName":"local bytes read","value":1861932291},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4032187744},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1732154851}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29427}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_partkey#17) AND isnotnull(l_quantity#20))","metadata":{},"metrics":[{"metricName":"number of output rows","value":126005867}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":126013147},{"metricName":"number of input batches","value":31061}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_quantity#20,l_extendedprice#21] Batched: true, DataFilters: [isnotnull(l_partkey#17), isnotnull(l_quantity#20)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey), IsNotNull(l_quantity)], ReadSchema: struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey), IsNotNull(l_quantity)]","DataFilters":"[isnotnull(l_partkey#17), isnotnull(l_quantity#20)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3979},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":126013147}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2721]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":7},{"metricName":"time to collect","value":52828},{"metricName":"number of output rows","value":4066},{"metricName":"data size","value":1179648}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=2561]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4066},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":16970893},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4066},{"metricName":"local bytes read","value":47222},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":65056},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":47222}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":233}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(p_brand#77) AND isnotnull(p_container#80)) AND (p_brand#77 = Brand#23)) AND (p_container#80 = MED BOX)) AND isnotnull(p_partkey#74))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4066}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_brand#77,p_container#80] Batched: true, DataFilters: [isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED B..., ReadSchema: struct<p_partkey:int,p_brand:string,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED BOX), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED BOX), isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":51},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#357 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":40},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.2 * avg(l_quantity))#355)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#357], functions=[avg(l_quantity#360)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":16368},{"metricName":"peak memory","value":2852126720},{"metricName":"number of output rows","value":4000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":486}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":852330442},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#357, 200), ENSURE_REQUIREMENTS, [plan_id=2584]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":86359817},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1682001396},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":86425539},{"metricName":"local bytes read","value":888505797},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2763514144},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":826582334}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":51218}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#357], functions=[partial_avg(l_quantity#360)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":35275},{"metricName":"peak memory","value":8455716864},{"metricName":"number of output rows","value":86359818},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":630}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(l_partkey#357)","metadata":{},"metrics":[{"metricName":"number of output rows","value":128377864}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":128386146},{"metricName":"number of input batches","value":31645}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#357,l_quantity#360] Batched: true, DataFilters: [isnotnull(l_partkey#357)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey)], ReadSchema: struct<l_partkey:int,l_quantity:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_partkey#357)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1551},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":128386146}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":115158,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=2373]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":40},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7636083},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":40},{"metricName":"local bytes read","value":2360},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":640},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2360}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":29851}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29849},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":40},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#74], [l_partkey#311], Inner, (l_quantity#20 < (0.2 * avg(l_quantity))#309)","metadata":{},"metrics":[{"metricName":"number of output rows","value":10913},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":29953}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":2824077312},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":128187}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":1794406674},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=2065]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":126804954},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2375607146},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":127106504},{"metricName":"local bytes read","value":1861775227},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4057758592},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1732154851}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29396}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_partkey#17) AND isnotnull(l_quantity#20))","metadata":{},"metrics":[{"metricName":"number of output rows","value":126804957}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":126813828},{"metricName":"number of input batches","value":31268}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_quantity#20,l_extendedprice#21] Batched: true, DataFilters: [isnotnull(l_partkey#17), isnotnull(l_quantity#20)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey), IsNotNull(l_quantity)], ReadSchema: struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey), IsNotNull(l_quantity)]","DataFilters":"[isnotnull(l_partkey#17), isnotnull(l_quantity#20)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4082},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":126813828}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2244]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":3},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":52668},{"metricName":"number of output rows","value":4066},{"metricName":"data size","value":1179648}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=2084]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4066},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":16419336},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4066},{"metricName":"local bytes read","value":47222},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":65056},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":47222}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":247}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(p_brand#77) AND isnotnull(p_container#80)) AND (p_brand#77 = Brand#23)) AND (p_container#80 = MED BOX)) AND isnotnull(p_partkey#74))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4066}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_brand#77,p_container#80] Batched: true, DataFilters: [isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED B..., ReadSchema: struct<p_partkey:int,p_brand:string,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED BOX), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED BOX), isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":55},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#311 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":44},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.2 * avg(l_quantity))#309)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#311], functions=[avg(l_quantity#314)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":16471},{"metricName":"peak memory","value":2852126720},{"metricName":"number of output rows","value":4000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":486}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":852330442},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#311, 200), ENSURE_REQUIREMENTS, [plan_id=2107]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":86501922},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1280190842},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":88299690},{"metricName":"local bytes read","value":888432153},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2768061568},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":826582334}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":51287}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#311], functions=[partial_avg(l_quantity#314)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":36261},{"metricName":"peak memory","value":8657043456},{"metricName":"number of output rows","value":86501924},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":645}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(l_partkey#311)","metadata":{},"metrics":[{"metricName":"number of output rows","value":129456987}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":129463714},{"metricName":"number of input batches","value":31913}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#311,l_quantity#314] Batched: true, DataFilters: [isnotnull(l_partkey#311)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey)], ReadSchema: struct<l_partkey:int,l_quantity:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_partkey#311)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1529},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":129463714}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":115731,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1896]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":40},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":8024917},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":40},{"metricName":"local bytes read","value":2360},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":640},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2360}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":29852}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum(l_extendedprice#21)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":29848},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":40},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#74], [l_partkey#265], Inner, (l_quantity#20 < (0.2 * avg(l_quantity))#263)","metadata":{},"metrics":[{"metricName":"number of output rows","value":10913},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":29978}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#74 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":2824077312},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":130754}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":1794406674},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=1588]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":128399188},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2354362392},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":128786566},{"metricName":"local bytes read","value":1862402723},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4108774048},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1774706237}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":30388}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_partkey#17) AND isnotnull(l_quantity#20))","metadata":{},"metrics":[{"metricName":"number of output rows","value":128399190}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":128400256},{"metricName":"number of input batches","value":31652}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_quantity#20,l_extendedprice#21] Batched: true, DataFilters: [isnotnull(l_partkey#17), isnotnull(l_quantity#20)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey), IsNotNull(l_quantity)], ReadSchema: struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double,l_extendedprice:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey), IsNotNull(l_quantity)]","DataFilters":"[isnotnull(l_partkey#17), isnotnull(l_quantity#20)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4271},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":128400256}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1767]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":52812},{"metricName":"number of output rows","value":4066},{"metricName":"data size","value":1179648}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=1607]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4066},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":16337788},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4066},{"metricName":"local bytes read","value":47222},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":65056},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":47222}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":252}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(p_brand#77) AND isnotnull(p_container#80)) AND (p_brand#77 = Brand#23)) AND (p_container#80 = MED BOX)) AND isnotnull(p_partkey#74))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4066}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_brand#77,p_container#80] Batched: true, DataFilters: [isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED B..., ReadSchema: struct<p_partkey:int,p_brand:string,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_brand), IsNotNull(p_container), EqualTo(p_brand,Brand#23), EqualTo(p_container,MED BOX), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_brand#77), isnotnull(p_container#80), (p_brand#77 = Brand#23), (p_container#80 = MED BOX), isnotnull(p_partkey#74)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":69},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#265 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":41},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.2 * avg(l_quantity))#263)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#265], functions=[avg(l_quantity#268)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":16391},{"metricName":"peak memory","value":2852126720},{"metricName":"number of output rows","value":4000000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":486}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":852330442},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#265, 200), ENSURE_REQUIREMENTS, [plan_id=1630]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":86860552},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1280162346},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":87823516},{"metricName":"local bytes read","value":888713634},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1763},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2779537664},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":826582334}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":51430}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#265], functions=[partial_avg(l_quantity#268)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":35597},{"metricName":"peak memory","value":8455716864},{"metricName":"number of output rows","value":86860553},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":630}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(l_partkey#265)","metadata":{},"metrics":[{"metricName":"number of output rows","value":129839059}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":129850568},{"metricName":"number of input batches","value":32013}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#265,l_quantity#268] Batched: true, DataFilters: [isnotnull(l_partkey#265)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_partkey)], ReadSchema: struct<l_partkey:int,l_quantity:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_quantity:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_partkey)]","DataFilters":"[isnotnull(l_partkey#265)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1604},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":129850568}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]