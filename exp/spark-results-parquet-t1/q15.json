[{"totalTime":19910,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#108 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#409,toprettystring(s_name)#410,toprettystring(s_address)#411,toprettystring(s_phone)#412,toprettystring(total_revenue)#413])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1734}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#108, s_name#109, s_address#110, s_phone#112, total_revenue#376]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_suppkey#108], [supplier_no#375], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":879}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#108 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":9},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":12994616},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=748]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":46815603},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":294}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#108)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_phone#112] Batched: true, DataFilters: [isnotnull(s_suppkey#108)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#108)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":86},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1732}],"children":[{"nodeName":"Sort","description":"Sort [supplier_no#375 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18 AS supplier_no#375, sum((l_extendedprice * (1 - l_discount)))#374 AS total_revenue#376]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#374) AND (sum((l_extendedprice * (1 - l_discount)))#374 = Subquery subquery#372, [id=#714]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":720},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=778]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3482074},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":425869364},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":83569776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":48982221}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7897}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":7005},{"metricName":"peak memory","value":2794455040},{"metricName":"number of output rows","value":3482074},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":615}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1996-01-01)) AND (l_shipdate#26 < 1996-04-01)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01..., ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4324},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#372, [id=#714]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":9524}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#378)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=951]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":169437},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":743}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#378)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":743},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#457], functions=[sum((l_extendedprice#460 * (1.0 - l_discount#461)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":739},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#457, 200), ENSURE_REQUIREMENTS, [plan_id=913]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3495716},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":442541059},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":83897184},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":48982221}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":7606}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#457], functions=[partial_sum((l_extendedprice#460 * (1.0 - l_discount#461)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6892},{"metricName":"peak memory","value":2862612480},{"metricName":"number of output rows","value":3495717},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":630}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#457, l_extendedprice#460, l_discount#461]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#465) AND (l_shipdate#465 >= 1996-01-01)) AND (l_shipdate#465 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4643552}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":122940208},{"metricName":"number of input batches","value":30306}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#457,l_extendedprice#460,l_discount#461,l_shipdate#465] Batched: true, DataFilters: [isnotnull(l_shipdate#465), (l_shipdate#465 >= 1996-01-01), (l_shipdate#465 < 1996-04-01)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)], ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)]","DataFilters":"[isnotnull(l_shipdate#465), (l_shipdate#465 >= 1996-01-01), (l_shipdate#465 < 1996-04-01)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4163},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":122940208}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":18432,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#108 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#909,toprettystring(s_name)#910,toprettystring(s_address)#911,toprettystring(s_phone)#912,toprettystring(total_revenue)#913])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1544}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#108, s_name#109, s_address#110, s_phone#112, total_revenue#876]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_suppkey#108], [supplier_no#875], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":779}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#108 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":12994616},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=2004]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":31926342},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":205}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#108)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_phone#112] Batched: true, DataFilters: [isnotnull(s_suppkey#108)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#108)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":48},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1542}],"children":[{"nodeName":"Sort","description":"Sort [supplier_no#875 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18 AS supplier_no#875, sum((l_extendedprice * (1 - l_discount)))#874 AS total_revenue#876]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#874) AND (sum((l_extendedprice * (1 - l_discount)))#874 = Subquery subquery#872, [id=#1970]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":672},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=2034]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3482074},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":456363649},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":83569776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":48982221}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7547}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6695},{"metricName":"peak memory","value":2794455040},{"metricName":"number of output rows","value":3482074},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":615}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1996-01-01)) AND (l_shipdate#26 < 1996-04-01)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4543781}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":120298900},{"metricName":"number of input batches","value":29656}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01..., ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4061},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":120298900}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#872, [id=#1970]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":8791}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#878)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=2207]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":172538},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":714}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#878)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":714},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#957], functions=[sum((l_extendedprice#960 * (1.0 - l_discount#961)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":705},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#957, 200), ENSURE_REQUIREMENTS, [plan_id=2169]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3482074},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":429739365},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":83569776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":48982221}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":7102}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#957], functions=[partial_sum((l_extendedprice#960 * (1.0 - l_discount#961)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6302},{"metricName":"peak memory","value":2794455040},{"metricName":"number of output rows","value":3482074},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":615}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#957, l_extendedprice#960, l_discount#961]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#965) AND (l_shipdate#965 >= 1996-01-01)) AND (l_shipdate#965 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4567019}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":120909285},{"metricName":"number of input batches","value":29806}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#957,l_extendedprice#960,l_discount#961,l_shipdate#965] Batched: true, DataFilters: [isnotnull(l_shipdate#965), (l_shipdate#965 >= 1996-01-01), (l_shipdate#965 < 1996-04-01)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)], ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)]","DataFilters":"[isnotnull(l_shipdate#965), (l_shipdate#965 >= 1996-01-01), (l_shipdate#965 < 1996-04-01)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3748},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":120909285}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":18232,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#108 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#784,toprettystring(s_name)#785,toprettystring(s_address)#786,toprettystring(s_phone)#787,toprettystring(total_revenue)#788])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1504}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#108, s_name#109, s_address#110, s_phone#112, total_revenue#751]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_suppkey#108], [supplier_no#750], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":764}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#108 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":5},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":12994616},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=1690]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23047749},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":222}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#108)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_phone#112] Batched: true, DataFilters: [isnotnull(s_suppkey#108)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#108)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":61},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1502}],"children":[{"nodeName":"Sort","description":"Sort [supplier_no#750 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18 AS supplier_no#750, sum((l_extendedprice * (1 - l_discount)))#749 AS total_revenue#751]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#749) AND (sum((l_extendedprice * (1 - l_discount)))#749 = Subquery subquery#747, [id=#1656]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":672},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=1720]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3482074},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":435980862},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":83569776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":48982221}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7203}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6337},{"metricName":"peak memory","value":2794455040},{"metricName":"number of output rows","value":3482074},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":615}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1996-01-01)) AND (l_shipdate#26 < 1996-04-01)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01..., ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3726},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#747, [id=#1656]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":8904}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#753)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1893]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":172850},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":724}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#753)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":724},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#832], functions=[sum((l_extendedprice#835 * (1.0 - l_discount#836)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":721},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#832, 200), ENSURE_REQUIREMENTS, [plan_id=1855]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3567305},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":431721959},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":85615320},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":49847315}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":7289}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#832], functions=[partial_sum((l_extendedprice#835 * (1.0 - l_discount#836)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6390},{"metricName":"peak memory","value":2862612480},{"metricName":"number of output rows","value":3567305},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":630}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#832, l_extendedprice#835, l_discount#836]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#840) AND (l_shipdate#840 >= 1996-01-01)) AND (l_shipdate#840 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4643523}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":122944425},{"metricName":"number of input batches","value":30306}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#832,l_extendedprice#835,l_discount#836,l_shipdate#840] Batched: true, DataFilters: [isnotnull(l_shipdate#840), (l_shipdate#840 >= 1996-01-01), (l_shipdate#840 < 1996-04-01)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)], ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)]","DataFilters":"[isnotnull(l_shipdate#840), (l_shipdate#840 >= 1996-01-01), (l_shipdate#840 < 1996-04-01)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3741},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":122944425}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":18749,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#108 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#659,toprettystring(s_name)#660,toprettystring(s_address)#661,toprettystring(s_phone)#662,toprettystring(total_revenue)#663])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1564}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#108, s_name#109, s_address#110, s_phone#112, total_revenue#626]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_suppkey#108], [supplier_no#625], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":799}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#108 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":5},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":12994616},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=1376]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23626945},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":205}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#108)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_phone#112] Batched: true, DataFilters: [isnotnull(s_suppkey#108)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#108)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":52},{"metricName":"metadata time","value":3},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1576}],"children":[{"nodeName":"Sort","description":"Sort [supplier_no#625 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18 AS supplier_no#625, sum((l_extendedprice * (1 - l_discount)))#624 AS total_revenue#626]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#624) AND (sum((l_extendedprice * (1 - l_discount)))#624 = Subquery subquery#622, [id=#1342]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":680},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=1406]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3567940},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":431604675},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":85630560},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":50189861}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7567}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6713},{"metricName":"peak memory","value":2862612480},{"metricName":"number of output rows","value":3567940},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":630}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1996-01-01)) AND (l_shipdate#26 < 1996-04-01)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4644614}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":122940181},{"metricName":"number of input batches","value":30306}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01..., ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4030},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":122940181}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#622, [id=#1342]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":9227}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#628)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1579]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":162882},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":698}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#628)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":697},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#707], functions=[sum((l_extendedprice#710 * (1.0 - l_discount#711)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":694},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#707, 200), ENSURE_REQUIREMENTS, [plan_id=1541]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3482074},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":426246835},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":83569776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":48982221}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":7489}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#707], functions=[partial_sum((l_extendedprice#710 * (1.0 - l_discount#711)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6658},{"metricName":"peak memory","value":2794455040},{"metricName":"number of output rows","value":3482074},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":615}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#707, l_extendedprice#710, l_discount#711]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#715) AND (l_shipdate#715 >= 1996-01-01)) AND (l_shipdate#715 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4570734}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":121011235},{"metricName":"number of input batches","value":29831}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#707,l_extendedprice#710,l_discount#711,l_shipdate#715] Batched: true, DataFilters: [isnotnull(l_shipdate#715), (l_shipdate#715 >= 1996-01-01), (l_shipdate#715 < 1996-04-01)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)], ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)]","DataFilters":"[isnotnull(l_shipdate#715), (l_shipdate#715 >= 1996-01-01), (l_shipdate#715 < 1996-04-01)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4094},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":121011235}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":18687,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#108 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#534,toprettystring(s_name)#535,toprettystring(s_address)#536,toprettystring(s_phone)#537,toprettystring(total_revenue)#538])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1496}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#108, s_name#109, s_address#110, s_phone#112, total_revenue#501]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_suppkey#108], [supplier_no#500], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":758}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#108 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":5},{"metricName":"peak memory","value":75497472},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":12994616},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=1062]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22865734},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":12448392},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21675776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":12448392}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":201}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#108)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_phone#112] Batched: true, DataFilters: [isnotnull(s_suppkey#108)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#108)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":65},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":1494}],"children":[{"nodeName":"Sort","description":"Sort [supplier_no#500 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":67174400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18 AS supplier_no#500, sum((l_extendedprice * (1 - l_discount)))#499 AS total_revenue#501]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#499) AND (sum((l_extendedprice * (1 - l_discount)))#499 = Subquery subquery#497, [id=#1028]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":674},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=1092]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3482074},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":428208454},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":83569776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":48982221}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7551}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#18], functions=[partial_sum((l_extendedprice#21 * (1.0 - l_discount#22)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6673},{"metricName":"peak memory","value":2794455040},{"metricName":"number of output rows","value":3482074},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":615}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#18, l_extendedprice#21, l_discount#22]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1996-01-01)) AND (l_shipdate#26 < 1996-04-01)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4592669}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":121600593},{"metricName":"number of input batches","value":29981}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01..., ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1996-01-01), (l_shipdate#26 < 1996-04-01), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4128},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":121600593}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#497, [id=#1028]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":8995}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#503)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1265]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":179281},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":710}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#503)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":709},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#582], functions=[sum((l_extendedprice#585 * (1.0 - l_discount#586)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":706},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":51381706},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#582, 200), ENSURE_REQUIREMENTS, [plan_id=1227]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3482074},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":428540154},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3482074},{"metricName":"local bytes read","value":48982221},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":83569776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":48982221}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":7215}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#582], functions=[partial_sum((l_extendedprice#585 * (1.0 - l_discount#586)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":6556},{"metricName":"peak memory","value":2862612480},{"metricName":"number of output rows","value":3482075},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":630}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#582, l_extendedprice#585, l_discount#586]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(l_shipdate#590) AND (l_shipdate#590 >= 1996-01-01)) AND (l_shipdate#590 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4643333}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":122943975},{"metricName":"number of input batches","value":30306}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_suppkey#582,l_extendedprice#585,l_discount#586,l_shipdate#590] Batched: true, DataFilters: [isnotnull(l_shipdate#590), (l_shipdate#590 >= 1996-01-01), (l_shipdate#590 < 1996-04-01)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)], ReadSchema: struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1996-01-01), LessThan(l_shipdate,1996-04-01)]","DataFilters":"[isnotnull(l_shipdate#590), (l_shipdate#590 >= 1996-01-01), (l_shipdate#590 < 1996-04-01)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3889},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":122943975}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]