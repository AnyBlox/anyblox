[{"totalTime":1416,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#376,toprettystring(l_linestatus)#377,toprettystring(sum_qty)#378,toprettystring(sum_base_price)#379,toprettystring(sum_disc_price)#380,toprettystring(sum_charge)#381,toprettystring(avg_qty)#382,toprettystring(avg_price)#383,toprettystring(avg_disc)#384,toprettystring(count_order)#385])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=197]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":108986568},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29398}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":28977},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":118306082}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7244},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":1260,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#812,toprettystring(l_linestatus)#813,toprettystring(sum_qty)#814,toprettystring(sum_base_price)#815,toprettystring(sum_disc_price)#816,toprettystring(sum_charge)#817,toprettystring(avg_qty)#818,toprettystring(avg_price)#819,toprettystring(avg_disc)#820,toprettystring(count_order)#821])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":6}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=461]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":126585364},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24442}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":24144},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":118306082}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6582},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":1309,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#703,toprettystring(l_linestatus)#704,toprettystring(sum_qty)#705,toprettystring(sum_base_price)#706,toprettystring(sum_disc_price)#707,toprettystring(sum_charge)#708,toprettystring(avg_qty)#709,toprettystring(avg_price)#710,toprettystring(avg_disc)#711,toprettystring(count_order)#712])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":6}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=395]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":105260554},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":25996}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":25684},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":118306082}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7210},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":1276,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#594,toprettystring(l_linestatus)#595,toprettystring(sum_qty)#596,toprettystring(sum_base_price)#597,toprettystring(sum_disc_price)#598,toprettystring(sum_charge)#599,toprettystring(avg_qty)#600,toprettystring(avg_price)#601,toprettystring(avg_disc)#602,toprettystring(count_order)#603])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":6}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=329]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":160868305},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":24938}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":24605},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":146068561}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":148202269},{"metricName":"number of input batches","value":36524}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9662},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":148202269}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":1406,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[l_returnflag#24 ASC NULLS FIRST,l_linestatus#25 ASC NULLS FIRST], output=[toprettystring(l_returnflag)#485,toprettystring(l_linestatus)#486,toprettystring(sum_qty)#487,toprettystring(sum_base_price)#488,toprettystring(sum_disc_price)#489,toprettystring(sum_charge)#490,toprettystring(avg_qty)#491,toprettystring(avg_price)#492,toprettystring(avg_disc)#493,toprettystring(count_order)#494])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":8}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[sum(l_quantity#20), sum(l_extendedprice#21), sum((l_extendedprice#21 * (1.0 - l_discount#22))), sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), avg(l_quantity#20), avg(l_extendedprice#21), avg(l_discount#22), count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":23288},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_returnflag#24, l_linestatus#25, 200), ENSURE_REQUIREMENTS, [plan_id=263]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":164},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":122216317},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":164},{"metricName":"local bytes read","value":22516},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":41},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":20992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":22516}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":25562}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_returnflag#24, l_linestatus#25], functions=[partial_sum(l_quantity#20), partial_sum(l_extendedprice#21), partial_sum((l_extendedprice#21 * (1.0 - l_discount#22))), partial_sum(((l_extendedprice#21 * (1.0 - l_discount#22)) * (1.0 + l_tax#23))), partial_avg(l_quantity#20), partial_avg(l_extendedprice#21), partial_avg(l_discount#22), partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":25253},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":164},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_quantity#20, l_extendedprice#21, l_discount#22, l_tax#23, l_returnflag#24, l_linestatus#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(l_shipdate#26) AND (l_shipdate#26 <= 1998-09-02))","metadata":{},"metrics":[{"metricName":"number of output rows","value":118306082}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_quantity#20,l_extendedprice#21,l_discount#22,l_tax#23,l_returnflag#24,l_linestatus#25,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)], ReadSchema: struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:strin...","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_quantity:double,l_extendedprice:double,l_discount:double,l_tax:double,l_returnflag:string,l_linestatus:string,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), LessThanOrEqual(l_shipdate,1998-09-02)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 <= 1998-09-02)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":6933},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]