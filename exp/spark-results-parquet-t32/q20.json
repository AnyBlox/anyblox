[{"totalTime":1500,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#109 ASC NULLS FIRST], output=[toprettystring(s_name)#185,toprettystring(s_address)#186])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":44}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110, s_nationkey#111]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [ps_suppkey#93], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=2682]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":41572884},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10429273},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10429273}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":172}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#111)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":35},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3678]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":23},{"metricName":"time to collect","value":28},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=3632]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23742404},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":665475},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":665475}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":116}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#93]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92, ps_suppkey#93], [l_partkey#17, l_suppkey#18], Inner, BuildLeft, (cast(ps_availqty#94 as double) > (0.5 * sum(l_quantity))#180), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=3529]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":31},{"metricName":"time to build","value":35},{"metricName":"time to collect","value":160},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=3352]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":173856},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1383814383},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3705462},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5563392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3705462}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2147}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":173856}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=2757]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3477646210},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":219464048},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219464048}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4694}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#94) AND isnotnull(ps_partkey#92)) AND isnotnull(ps_suppkey#93))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#92,ps_suppkey#93,ps_availqty#94] Batched: true, DataFilters: [isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":542},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3227]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":8},{"metricName":"time to collect","value":279},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=2776]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2318219608},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":587518}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":930}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":390},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=3454]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2528383146},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":2312909},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2312909}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":3521}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#180)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":3054},{"metricName":"peak memory","value":2290614272},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":373}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[partial_sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2952},{"metricName":"peak memory","value":1686634496},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":250}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":261690508},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=2800]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18195269},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1933341848},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":247653897},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1394},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":582248608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":247653897}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":10240}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_suppkey#18, l_quantity#20]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1994-01-01)) AND (l_shipdate#26 < 1995-01-01)) AND isnotnull(l_partkey#17)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18195269}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_suppkey#18,l_quantity#20,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01..., ReadSchema: struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01), IsNotNull(l_partkey), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull(l_partkey#17), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3981},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#74], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3227]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3227]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":8},{"metricName":"time to collect","value":279},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=2776]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2318219608},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":587518}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":930}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":390},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2862]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":3},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":47},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#48]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#49) AND (n_name#49 = CANADA)) AND isnotnull(n_nationkey#48))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":2},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":1398,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#109 ASC NULLS FIRST], output=[toprettystring(s_name)#293,toprettystring(s_address)#294])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":45}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110, s_nationkey#111]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [ps_suppkey#93], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=7462]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":41502025},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10429273},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10429273}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":164}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#111)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":34},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8458]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":18},{"metricName":"time to collect","value":26},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=8412]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23577219},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":665475},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":665475}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":83}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#93]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92, ps_suppkey#93], [l_partkey#17, l_suppkey#18], Inner, BuildLeft, (cast(ps_availqty#94 as double) > (0.5 * sum(l_quantity))#288), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=8309]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":31},{"metricName":"time to build","value":34},{"metricName":"time to collect","value":157},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=8132]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":173856},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1593545581},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3705462},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5563392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3705462}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2101}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":173856}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=7537]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3146801816},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":219464048},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219464048}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4542}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#94) AND isnotnull(ps_partkey#92)) AND isnotnull(ps_suppkey#93))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#92,ps_suppkey#93,ps_availqty#94] Batched: true, DataFilters: [isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":574},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8007]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":257},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=7556]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1902045385},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":587518}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":948}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":345},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=8234]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2649774993},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":2312909},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2312909}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2883}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#288)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2331},{"metricName":"peak memory","value":2290614272},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":373}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[partial_sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2239},{"metricName":"peak memory","value":1686634496},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":250}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":261690508},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=7580]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18195269},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2291317057},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":247653897},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1394},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":582248608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":247653897}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":9460}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_suppkey#18, l_quantity#20]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1994-01-01)) AND (l_shipdate#26 < 1995-01-01)) AND isnotnull(l_partkey#17)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18195269}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_suppkey#18,l_quantity#20,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01..., ReadSchema: struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01), IsNotNull(l_partkey), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull(l_partkey#17), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3671},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#74], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8007]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=8007]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":257},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=7556]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1902045385},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":587518}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":948}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":345},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7642]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":2},{"metricName":"time to build","value":3},{"metricName":"time to collect","value":34},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#48]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#49) AND (n_name#49 = CANADA)) AND isnotnull(n_nationkey#48))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":1485,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#109 ASC NULLS FIRST], output=[toprettystring(s_name)#266,toprettystring(s_address)#267])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":48}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110, s_nationkey#111]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [ps_suppkey#93], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=6267]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":38337360},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10429273},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10429273}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":138}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#111)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":21},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=7263]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":13},{"metricName":"time to build","value":29},{"metricName":"time to collect","value":32},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=7217]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23699651},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":665475},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":665475}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":103}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#93]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92, ps_suppkey#93], [l_partkey#17, l_suppkey#18], Inner, BuildLeft, (cast(ps_availqty#94 as double) > (0.5 * sum(l_quantity))#261), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=7114]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":34},{"metricName":"time to build","value":53},{"metricName":"time to collect","value":133},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=6937]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":173856},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2169399309},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3705462},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5563392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3705462}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2001}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":173856}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=6342]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3353308576},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":219464048},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219464048}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3472}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#94) AND isnotnull(ps_partkey#92)) AND isnotnull(ps_suppkey#93))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#92,ps_suppkey#93,ps_availqty#94] Batched: true, DataFilters: [isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":332},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6812]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":7},{"metricName":"time to collect","value":292},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=6361]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2244528490},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":587518}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":843}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":292},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=7039]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2421758560},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":2312909},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2312909}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":3132}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#261)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2413},{"metricName":"peak memory","value":2290614272},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":373}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[partial_sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2299},{"metricName":"peak memory","value":1686634496},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":250}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":261690508},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=6385]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18195269},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2494473048},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":247653897},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1394},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":582248608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":247653897}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":9878}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_suppkey#18, l_quantity#20]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1994-01-01)) AND (l_shipdate#26 < 1995-01-01)) AND isnotnull(l_partkey#17)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18195269}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_suppkey#18,l_quantity#20,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01..., ReadSchema: struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01), IsNotNull(l_partkey), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull(l_partkey#17), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4023},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#74], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6812]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6812]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":7},{"metricName":"time to collect","value":292},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=6361]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2244528490},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":587518}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":843}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":292},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6447]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":25},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#48]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#49) AND (n_name#49 = CANADA)) AND isnotnull(n_nationkey#48))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":1418,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#109 ASC NULLS FIRST], output=[toprettystring(s_name)#239,toprettystring(s_address)#240])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":44}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110, s_nationkey#111]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [ps_suppkey#93], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=5072]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":54940600},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10429273},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10429273}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":194}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#111)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":40},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6068]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":19},{"metricName":"time to collect","value":27},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=6022]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23858694},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":665475},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":665475}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":82}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#93]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92, ps_suppkey#93], [l_partkey#17, l_suppkey#18], Inner, BuildLeft, (cast(ps_availqty#94 as double) > (0.5 * sum(l_quantity))#234), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=5919]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":31},{"metricName":"time to build","value":35},{"metricName":"time to collect","value":114},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=5742]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":173856},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1892826596},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3705462},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5563392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3705462}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2199}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":173856}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=5147]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3321401764},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":219464048},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219464048}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":4408}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#94) AND isnotnull(ps_partkey#92)) AND isnotnull(ps_suppkey#93))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#92,ps_suppkey#93,ps_availqty#94] Batched: true, DataFilters: [isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":604},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5617]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":253},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=5166]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":72956},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2555786681},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1167296},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":973130}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1453}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":72956}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":6694234},{"metricName":"number of input batches","value":1667}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":567},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":6694234}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=5844]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2575441210},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":2312909},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2312909}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2775}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#234)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2287},{"metricName":"peak memory","value":2290614272},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":373}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[partial_sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2206},{"metricName":"peak memory","value":1686634496},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":250}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":261690508},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=5190]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18195269},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2477866906},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":247653897},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1394},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":582248608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":247653897}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":9852}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_suppkey#18, l_quantity#20]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1994-01-01)) AND (l_shipdate#26 < 1995-01-01)) AND isnotnull(l_partkey#17)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18195269}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_suppkey#18,l_quantity#20,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01..., ReadSchema: struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01), IsNotNull(l_partkey), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull(l_partkey#17), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3796},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#74], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5617]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5617]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":253},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=5166]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":72956},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2555786681},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1167296},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":973130}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":1453}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":72956}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":6694234},{"metricName":"number of input batches","value":1667}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":567},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":6694234}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5252]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":25},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#48]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#49) AND (n_name#49 = CANADA)) AND isnotnull(n_nationkey#48))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":1492,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_name#109 ASC NULLS FIRST], output=[toprettystring(s_name)#212,toprettystring(s_address)#213])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":45}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":3543}],"children":[{"nodeName":"Project","description":"Project [s_name#109, s_address#110, s_nationkey#111]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [ps_suppkey#93], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":89425}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#108, 200), ENSURE_REQUIREMENTS, [plan_id=3877]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":40717357},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":10429273},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":18475776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10429273}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":147}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_nationkey#111)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_name#109,s_address#110,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":26},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 14","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4873]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":11},{"metricName":"time to build","value":20},{"metricName":"time to collect","value":27},{"metricName":"number of output rows","value":118043},{"metricName":"data size","value":5794304}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 13","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=4827]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118043},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24204537},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118043},{"metricName":"local bytes read","value":665475},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1888688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":665475}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":87}],"children":[{"nodeName":"Project","description":"Project [ps_suppkey#93]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92, ps_suppkey#93], [l_partkey#17, l_suppkey#18], Inner, BuildLeft, (cast(ps_availqty#94 as double) > (0.5 * sum(l_quantity))#207), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":118043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 12","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=4724]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":31},{"metricName":"time to build","value":32},{"metricName":"time to collect","value":120},{"metricName":"number of output rows","value":173856},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, ps_suppkey#93, 200), ENSURE_REQUIREMENTS, [plan_id=4547]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":173856},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2030320924},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":173856},{"metricName":"local bytes read","value":3705462},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":5563392},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":3705462}],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2078}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [ps_partkey#92], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":173856}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_partkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=3952]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3369345805},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":219464048},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":219464048}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":3802}],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(ps_availqty#94) AND isnotnull(ps_partkey#92)) AND isnotnull(ps_suppkey#93))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#92,ps_suppkey#93,ps_availqty#94] Batched: true, DataFilters: [isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_availqty:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_availqty), IsNotNull(ps_partkey), IsNotNull(ps_suppkey)]","DataFilters":"[isnotnull(ps_availqty#94), isnotnull(ps_partkey#92), isnotnull(ps_suppkey#93)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":411},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4422]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":10},{"metricName":"time to collect","value":356},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=3971]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2278155490},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":587518}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":897}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":346},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":2}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 11","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, l_suppkey#18, 200), ENSURE_REQUIREMENTS, [plan_id=4649]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":118304},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2306642018},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":118304},{"metricName":"local bytes read","value":2312909},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3785728},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2312909}],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2808}],"children":[{"nodeName":"Filter","description":"Filter isnotnull((0.5 * sum(l_quantity))#207)","metadata":{},"metrics":[{"metricName":"number of output rows","value":118304}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2351},{"metricName":"peak memory","value":2290614272},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":373}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_partkey#17, l_suppkey#18], functions=[partial_sum(l_quantity#20)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2285},{"metricName":"peak memory","value":1686634496},{"metricName":"number of output rows","value":118304},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":250}],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#17], [p_partkey#74], LeftSemi, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":197712}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":261690508},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#17, 200), ENSURE_REQUIREMENTS, [plan_id=3995]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":18195269},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2466574399},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18195269},{"metricName":"local bytes read","value":247653897},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1394},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":582248608},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":247653897}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":11905}],"children":[{"nodeName":"Project","description":"Project [l_partkey#17, l_suppkey#18, l_quantity#20]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1994-01-01)) AND (l_shipdate#26 < 1995-01-01)) AND isnotnull(l_partkey#17)) AND isnotnull(l_suppkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":18195269}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_partkey#17,l_suppkey#18,l_quantity#20,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01..., ReadSchema: struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_partkey:int,l_suppkey:int,l_quantity:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1994-01-01), LessThan(l_shipdate,1995-01-01), IsNotNull(l_partkey), IsNotNull(l_suppkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1994-01-01), (l_shipdate#26 < 1995-01-01), isnotnull(l_partkey#17), isnotnull(l_suppkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":4939},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [p_partkey#74], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4422]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4422]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":10},{"metricName":"time to collect","value":356},{"metricName":"number of output rows","value":43464},{"metricName":"data size","value":3145728}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#74, 200), ENSURE_REQUIREMENTS, [plan_id=3971]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":43464},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2278155490},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":43464},{"metricName":"local bytes read","value":587518},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":695424},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":587518}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":897}],"children":[{"nodeName":"Project","description":"Project [p_partkey#74]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(p_name#75) AND StartsWith(p_name#75, forest))","metadata":{},"metrics":[{"metricName":"number of output rows","value":43464}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#74,p_name#75] Batched: true, DataFilters: [isnotnull(p_name#75), StartsWith(p_name#75, forest)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringStartsWith(p_name,forest)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringStartsWith(p_name,forest)]","DataFilters":"[isnotnull(p_name#75), StartsWith(p_name#75, forest)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":346},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4057]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":2},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":27},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#48]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#49) AND (n_name#49 = CANADA)) AND isnotnull(n_nationkey#48))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,CANADA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#49), (n_name#49 = CANADA), isnotnull(n_nationkey#48)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]