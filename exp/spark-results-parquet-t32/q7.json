[{"totalTime":4497,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#198 ASC NULLS FIRST,cust_nation#199 ASC NULLS FIRST,l_year#200 ASC NULLS FIRST], output=[toprettystring(supp_nation)#216,toprettystring(cust_nation)#217,toprettystring(l_year)#218,toprettystring(revenue)#219])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#198, cust_nation#199, l_year#200], functions=[sum(volume#201)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14416},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#198, cust_nation#199, l_year#200, 200), ENSURE_REQUIREMENTS, [plan_id=3015]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":136},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":798194816},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":136},{"metricName":"local bytes read","value":13594},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7616},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13594}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":15253}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#198, cust_nation#199, l_year#200], functions=[partial_sum(volume#201)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14615},{"metricName":"peak memory","value":8912896},{"metricName":"number of output rows","value":136},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#49 AS supp_nation#198, n_name#204 AS cust_nation#199, year(l_shipdate#26) AS l_year#200, (l_extendedprice#21 * (1.0 - l_discount#22)) AS volume#201]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#203], Inner, BuildRight, (((n_name#49 = FRANCE) AND (n_name#204 = GERMANY)) OR ((n_name#49 = GERMANY) AND (n_name#204 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3, n_name#49]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#57], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":14617}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#57 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1104},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":750039496},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=2889]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36461891},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6718278509},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":36461891},{"metricName":"local bytes read","value":715602854},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1156},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1750170768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":715602854}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":30994}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, o_custkey#57]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#16], [o_orderkey#56], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":30525}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1419},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":777266865},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=2633]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":61918086},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3621338044},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":36461891},{"metricName":"local bytes read","value":741741313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1394},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2972068512},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":803265558}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":23324}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_orderkey#16, l_extendedprice#21, l_discount#22, l_shipdate#26]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [l_suppkey#18], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":61918096}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2321]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":16},{"metricName":"time to build","value":40},{"metricName":"time to collect","value":307},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":30}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#108) AND isnotnull(s_nationkey#111))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-01-01)) AND (l_shipdate#26 <= 1996-12-31)) AND isnotnull(l_suppkey#18)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":61918094}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":203820295},{"metricName":"number of input batches","value":50224}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,199..., ReadSchema: struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,1996-12-31), IsNotNull(l_suppkey), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnull(l_suppkey#18), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9113},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":203820295}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":8311}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1198},{"metricName":"peak memory","value":3405774848},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":334406442},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=2340]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3647901815},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":30000000},{"metricName":"local bytes read","value":316024942},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1088},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":720000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":316024942}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7061}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#56) AND isnotnull(o_custkey#57))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57] Batched: true, DataFilters: [isnotnull(o_orderkey#56), isnotnull(o_custkey#57)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#56), isnotnull(o_custkey#57)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":426},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":8373}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":33},{"metricName":"peak memory","value":2421161984},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2361]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2612040667},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1020},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":826}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":100},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2380]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":272},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#203, n_name#204], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2380]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2380]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":272},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":4325,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#350 ASC NULLS FIRST,cust_nation#351 ASC NULLS FIRST,l_year#352 ASC NULLS FIRST], output=[toprettystring(supp_nation)#368,toprettystring(cust_nation)#369,toprettystring(l_year)#370,toprettystring(revenue)#371])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#350, cust_nation#351, l_year#352], functions=[sum(volume#353)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14416},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#350, cust_nation#351, l_year#352, 200), ENSURE_REQUIREMENTS, [plan_id=6901]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":136},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":849746701},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":136},{"metricName":"local bytes read","value":13594},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7616},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13594}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":15500}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#350, cust_nation#351, l_year#352], functions=[partial_sum(volume#353)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14592},{"metricName":"peak memory","value":8912896},{"metricName":"number of output rows","value":136},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#49 AS supp_nation#350, n_name#356 AS cust_nation#351, year(l_shipdate#26) AS l_year#352, (l_extendedprice#21 * (1.0 - l_discount#22)) AS volume#353]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#355], Inner, BuildRight, (((n_name#49 = FRANCE) AND (n_name#356 = GERMANY)) OR ((n_name#49 = GERMANY) AND (n_name#356 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3, n_name#49]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#57], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":14545}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#57 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1081},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":750039496},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=6775]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":71464892},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7272658753},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":36461891},{"metricName":"local bytes read","value":715602854},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1156},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3430314816},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1402564590}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":56939}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, o_custkey#57]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#16], [o_orderkey#56], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":71464892},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":55957}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2834},{"metricName":"peak memory","value":8808038400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":777266865},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=6519]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36461891},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2746669303},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":71464892},{"metricName":"local bytes read","value":1453803778},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2706},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1750170768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":741741313}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":20588}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_orderkey#16, l_extendedprice#21, l_discount#22, l_shipdate#26]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [l_suppkey#18], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6207]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":15},{"metricName":"time to build","value":41},{"metricName":"time to collect","value":260},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":25}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#108) AND isnotnull(s_nationkey#111))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-01-01)) AND (l_shipdate#26 <= 1996-12-31)) AND isnotnull(l_suppkey#18)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,199..., ReadSchema: struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,1996-12-31), IsNotNull(l_suppkey), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnull(l_suppkey#18), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5124},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":15282}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2350},{"metricName":"peak memory","value":6627000320},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":334406442},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=6226]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3661426353},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":58800164},{"metricName":"local bytes read","value":619410408},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2112},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":720000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":316024942}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":6287}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#56) AND isnotnull(o_custkey#57))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57] Batched: true, DataFilters: [isnotnull(o_orderkey#56), isnotnull(o_custkey#57)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#56), isnotnull(o_custkey#57)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":305},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":8746}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":37},{"metricName":"peak memory","value":2421161984},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=6247]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1955478451},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1020},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":818}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":81},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6266]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":265},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#355, n_name#356], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6266]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6266]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":265},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":4510,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#312 ASC NULLS FIRST,cust_nation#313 ASC NULLS FIRST,l_year#314 ASC NULLS FIRST], output=[toprettystring(supp_nation)#330,toprettystring(cust_nation)#331,toprettystring(l_year)#332,toprettystring(revenue)#333])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#312, cust_nation#313, l_year#314], functions=[sum(volume#315)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14416},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#312, cust_nation#313, l_year#314, 200), ENSURE_REQUIREMENTS, [plan_id=5951]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":136},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":687261198},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":136},{"metricName":"local bytes read","value":13594},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7616},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13594}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":16980}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#312, cust_nation#313, l_year#314], functions=[partial_sum(volume#315)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":15912},{"metricName":"peak memory","value":8912896},{"metricName":"number of output rows","value":136},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#49 AS supp_nation#312, n_name#318 AS cust_nation#313, year(l_shipdate#26) AS l_year#314, (l_extendedprice#21 * (1.0 - l_discount#22)) AS volume#315]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#317], Inner, BuildRight, (((n_name#49 = FRANCE) AND (n_name#318 = GERMANY)) OR ((n_name#49 = GERMANY) AND (n_name#318 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3, n_name#49]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#57], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":15959}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#57 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1064},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":750039496},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=5825]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36461891},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6918225421},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":36461891},{"metricName":"local bytes read","value":715602854},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1156},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1750170768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":715602854}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":29037}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, o_custkey#57]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#16], [o_orderkey#56], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":28582}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1440},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":777266865},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=5569]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36461891},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2894894923},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":36461891},{"metricName":"local bytes read","value":741741313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1394},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1750170768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":741741313}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":20314}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_orderkey#16, l_extendedprice#21, l_discount#22, l_shipdate#26]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [l_suppkey#18], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5171]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":15},{"metricName":"time to build","value":42},{"metricName":"time to collect","value":279},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":26}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#108) AND isnotnull(s_nationkey#111))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":8},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-01-01)) AND (l_shipdate#26 <= 1996-12-31)) AND isnotnull(l_suppkey#18)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,199..., ReadSchema: struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,1996-12-31), IsNotNull(l_suppkey), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnull(l_suppkey#18), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5121},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":7520}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1202},{"metricName":"peak memory","value":3405774848},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":334406442},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=5190]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3381712616},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":30000000},{"metricName":"local bytes read","value":316024942},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1088},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":720000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":316024942}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":7135}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#56) AND isnotnull(o_custkey#57))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57] Batched: true, DataFilters: [isnotnull(o_orderkey#56), isnotnull(o_custkey#57)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#56), isnotnull(o_custkey#57)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":374},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":9508}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":33},{"metricName":"peak memory","value":2421161984},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=5211]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1969006700},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1020},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":811}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":86},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5230]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":285},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#317, n_name#318], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5230]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5230]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":285},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":4439,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#274 ASC NULLS FIRST,cust_nation#275 ASC NULLS FIRST,l_year#276 ASC NULLS FIRST], output=[toprettystring(supp_nation)#292,toprettystring(cust_nation)#293,toprettystring(l_year)#294,toprettystring(revenue)#295])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#274, cust_nation#275, l_year#276], functions=[sum(volume#277)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14416},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#274, cust_nation#275, l_year#276, 200), ENSURE_REQUIREMENTS, [plan_id=4915]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":136},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":863110374},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":136},{"metricName":"local bytes read","value":13594},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7616},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13594}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":15166}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#274, cust_nation#275, l_year#276], functions=[partial_sum(volume#277)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":14314},{"metricName":"peak memory","value":8912896},{"metricName":"number of output rows","value":136},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#49 AS supp_nation#274, n_name#280 AS cust_nation#275, year(l_shipdate#26) AS l_year#276, (l_extendedprice#21 * (1.0 - l_discount#22)) AS volume#277]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#279], Inner, BuildRight, (((n_name#49 = FRANCE) AND (n_name#280 = GERMANY)) OR ((n_name#49 = GERMANY) AND (n_name#280 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3, n_name#49]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#57], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":14340}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#57 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1104},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":750039496},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=4789]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36461891},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6533317930},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":36461891},{"metricName":"local bytes read","value":715602854},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1156},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1750170768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":715602854}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":30852}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, o_custkey#57]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#16], [o_orderkey#56], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":30279}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1389},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":777266865},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=4533]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36461891},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3645362614},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":37094926},{"metricName":"local bytes read","value":1453803778},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2706},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1750170768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":741741313}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":20086}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_orderkey#16, l_extendedprice#21, l_discount#22, l_shipdate#26]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [l_suppkey#18], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4221]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":16},{"metricName":"time to build","value":40},{"metricName":"time to collect","value":263},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":27}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#108) AND isnotnull(s_nationkey#111))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-01-01)) AND (l_shipdate#26 <= 1996-12-31)) AND isnotnull(l_suppkey#18)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,199..., ReadSchema: struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,1996-12-31), IsNotNull(l_suppkey), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnull(l_suppkey#18), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5127},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":8221}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1258},{"metricName":"peak memory","value":3405774848},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":334406442},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=4240]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3677942581},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":30000000},{"metricName":"local bytes read","value":619410408},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2112},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":720000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":316024942}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":6348}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#56) AND isnotnull(o_custkey#57))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57] Batched: true, DataFilters: [isnotnull(o_orderkey#56), isnotnull(o_custkey#57)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#56), isnotnull(o_custkey#57)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":329},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":8433}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":33},{"metricName":"peak memory","value":2421161984},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=4261]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2376233167},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1020},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":830}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":95},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4280]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":269},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#279, n_name#280], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4280]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4280]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":269},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":4713,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#236 ASC NULLS FIRST,cust_nation#237 ASC NULLS FIRST,l_year#238 ASC NULLS FIRST], output=[toprettystring(supp_nation)#254,toprettystring(cust_nation)#255,toprettystring(l_year)#256,toprettystring(revenue)#257])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#236, cust_nation#237, l_year#238], functions=[sum(volume#239)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14416},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#236, cust_nation#237, l_year#238, 200), ENSURE_REQUIREMENTS, [plan_id=3965]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":136},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":800757380},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":136},{"metricName":"local bytes read","value":13594},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":34},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7616},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13594}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":16607}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#236, cust_nation#237, l_year#238], functions=[partial_sum(volume#239)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":15652},{"metricName":"peak memory","value":8912896},{"metricName":"number of output rows","value":136},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#49 AS supp_nation#236, n_name#242 AS cust_nation#237, year(l_shipdate#26) AS l_year#238, (l_extendedprice#21 * (1.0 - l_discount#22)) AS volume#239]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#241], Inner, BuildRight, (((n_name#49 = FRANCE) AND (n_name#242 = GERMANY)) OR ((n_name#49 = GERMANY) AND (n_name#242 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3, n_name#49]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#111], [n_nationkey#48], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#57], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":15676}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#57 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1066},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":750039496},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#57, 200), ENSURE_REQUIREMENTS, [plan_id=3839]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36461891},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6841447587},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":36461891},{"metricName":"local bytes read","value":715602854},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1156},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1750170768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":715602854}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":29238}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_extendedprice#21, l_discount#22, l_shipdate#26, o_custkey#57]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#16], [o_orderkey#56], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":28750}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1444},{"metricName":"peak memory","value":4513071104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":777266865},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=3583]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36461891},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3571613512},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":36461891},{"metricName":"local bytes read","value":741741313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1394},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1750170768},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":741741313}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":21503}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#111, l_orderkey#16, l_extendedprice#21, l_discount#22, l_shipdate#26]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#108], [l_suppkey#18], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3271]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":16},{"metricName":"time to build","value":41},{"metricName":"time to collect","value":285},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":9988608}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":29}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#108) AND isnotnull(s_nationkey#111))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#108,s_nationkey#111] Batched: true, DataFilters: [isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#108), isnotnull(s_nationkey#111)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter ((((isnotnull(l_shipdate#26) AND (l_shipdate#26 >= 1995-01-01)) AND (l_shipdate#26 <= 1996-12-31)) AND isnotnull(l_suppkey#18)) AND isnotnull(l_orderkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":29581}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [l_orderkey#16,l_suppkey#18,l_extendedprice#21,l_discount#22,l_shipdate#26] Batched: true, DataFilters: [isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,199..., ReadSchema: struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/lineitem.parquet]","ReadSchema":"struct<l_orderkey:int,l_suppkey:int,l_extendedprice:double,l_discount:double,l_shipdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(l_shipdate), GreaterThanOrEqual(l_shipdate,1995-01-01), LessThanOrEqual(l_shipdate,1996-12-31), IsNotNull(l_suppkey), IsNotNull(l_orderkey)]","DataFilters":"[isnotnull(l_shipdate#26), (l_shipdate#26 >= 1995-01-01), (l_shipdate#26 <= 1996-12-31), isnotnull(l_suppkey#18), isnotnull(l_orderkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":5324},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":5497795005},{"metricName":"number of output rows","value":119994608}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":7692}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#56 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1172},{"metricName":"peak memory","value":3405774848},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":334406442},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#56, 200), ENSURE_REQUIREMENTS, [plan_id=3290]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":4011857436},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":30000000},{"metricName":"local bytes read","value":316024942},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1088},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":720000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":316024942}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":6861}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#56) AND isnotnull(o_custkey#57))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#56,o_custkey#57] Batched: true, DataFilters: [isnotnull(o_orderkey#56), isnotnull(o_custkey#57)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#56), isnotnull(o_custkey#57)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":426},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":9300}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":33},{"metricName":"peak memory","value":2421161984},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":34},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":34}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3311]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2318571315},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1020},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":846}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":93},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3330]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":290},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#241, n_name#242], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3330]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3330]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":290},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#48) AND ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#48,n_name#49] Batched: true, DataFilters: [isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#48), ((n_name#49 = FRANCE) OR (n_name#49 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]