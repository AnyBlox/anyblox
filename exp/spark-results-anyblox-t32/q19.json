[{"totalTime":787,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=726]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":32},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":16364238},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32},{"metricName":"local bytes read","value":1888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1888}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":331}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":330},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":32},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=581]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2569938},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3304396401},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":44705674},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":102797520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":44705674}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":12592}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2569938}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":84504022},{"metricName":"time spent in decode_batch","value":3460484194},{"metricName":"time spent loading native vectors","value":440628310}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=679]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":3},{"metricName":"time to build","value":6},{"metricName":"time to collect","value":43},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=599]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1605484317},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":585586},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":585586}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1204}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":321},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":653,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1686]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":32},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5749079},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32},{"metricName":"local bytes read","value":1888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1888}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":329}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":322},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":32},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=1541]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2569938},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2939541282},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":44705674},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":102797520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":44705674}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":10536}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2569938}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":84060421},{"metricName":"time spent in decode_batch","value":2655984433},{"metricName":"time spent loading native vectors","value":212640327}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1639]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":3},{"metricName":"time to build","value":5},{"metricName":"time to collect","value":33},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=1559]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1283119415},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":585586},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":585586}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":937}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":202},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":664,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1446]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":32},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5295553},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32},{"metricName":"local bytes read","value":1888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1888}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":326}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":324},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":32},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=1301]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2569938},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2902061137},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":44705674},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":102797520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":44705674}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":9846}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2569938}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":82257214},{"metricName":"time spent in decode_batch","value":2851441226},{"metricName":"time spent loading native vectors","value":231057534}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1399]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":4},{"metricName":"time to build","value":6},{"metricName":"time to collect","value":39},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=1319]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1187782517},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":585586},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":585586}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1457}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":270},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":633,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1206]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":32},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5477543},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32},{"metricName":"local bytes read","value":1888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1888}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":322}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":317},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":32},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=1061]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2569938},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2845222960},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":44705674},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":102797520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":44705674}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":9542}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2569938}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":81998236},{"metricName":"time spent in decode_batch","value":2885583162},{"metricName":"time spent loading native vectors","value":257947343}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1159]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":3},{"metricName":"time to build","value":5},{"metricName":"time to collect","value":36},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=1079]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1358404660},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":585586},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":585586}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":852}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":193},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":689,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=966]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":32},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6661967},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":32},{"metricName":"local bytes read","value":1888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1888}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":331}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":330},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":32},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_partkey#91], [p_partkey#42], Inner, BuildRight, (((((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (l_quantity#94 >= 1.0)) AND (l_quantity#94 <= 11.0)) AND (p_size#47 <= 5)) OR (((((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (l_quantity#94 >= 10.0)) AND (l_quantity#94 <= 20.0)) AND (p_size#47 <= 10))) OR (((((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (l_quantity#94 >= 20.0)) AND (l_quantity#94 <= 30.0)) AND (p_size#47 <= 15))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2358}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":32}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=821]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":2569938},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2962233786},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":2569938},{"metricName":"local bytes read","value":44705674},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":102797520},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":44705674}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":9415}],"children":[{"nodeName":"Project","description":"Project [l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipmode#104 IN (AIR,AIR REG) AND (l_shipinstruct#103 = DELIVER IN PERSON)) AND ((((l_quantity#94 >= 1.0) AND (l_quantity#94 <= 11.0)) OR ((l_quantity#94 >= 10.0) AND (l_quantity#94 <= 20.0))) OR ((l_quantity#94 >= 20.0) AND (l_quantity#94 <= 30.0))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2569938}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_partkey#91, l_quantity#94, l_extendedprice#95, l_discount#96, l_shipinstruct#103, l_shipmode#104] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":82114470},{"metricName":"time spent in decode_batch","value":3064317173},{"metricName":"time spent loading native vectors","value":206562279}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=919]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":4},{"metricName":"time to build","value":6},{"metricName":"time to collect","value":46},{"metricName":"number of output rows","value":9676},{"metricName":"data size","value":1572864}],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead local","metadata":{},"metrics":[{"metricName":"number of partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=839]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9676},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1296690895},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9676},{"metricName":"local bytes read","value":585586},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":31},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":541856},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":585586}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1449}],"children":[{"nodeName":"Filter","description":"Filter (((isnotnull(p_size#47) AND (p_size#47 >= 1)) AND isnotnull(p_partkey#42)) AND (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15))))","metadata":{},"metrics":[{"metricName":"number of output rows","value":9676}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_brand#45,p_size#47,p_container#48] Batched: true, DataFilters: [isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_b..., ReadSchema: struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_brand:string,p_size:int,p_container:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_size), GreaterThanOrEqual(p_size,1), IsNotNull(p_partkey), Or(Or(And(And(EqualTo(p_brand,Brand#12),In(p_container, [SM BOX,SM CASE,SM PACK,SM PKG])),LessThanOrEqual(p_size,5)),And(And(EqualTo(p_brand,Brand#23),In(p_container, [MED BAG,MED BOX,MED PACK,MED PKG])),LessThanOrEqual(p_size,10))),And(And(EqualTo(p_brand,Brand#34),In(p_container, [LG BOX,LG CASE,LG PACK,LG PKG])),LessThanOrEqual(p_size,15)))]","DataFilters":"[isnotnull(p_size#47), (p_size#47 >= 1), isnotnull(p_partkey#42), (((((p_brand#45 = Brand#12) AND p_container#48 IN (SM CASE,SM BOX,SM PACK,SM PKG)) AND (p_size#47 <= 5)) OR (((p_brand#45 = Brand#23) AND p_container#48 IN (MED BAG,MED BOX,MED PKG,MED PACK)) AND (p_size#47 <= 10))) OR (((p_brand#45 = Brand#34) AND p_container#48 IN (LG CASE,LG BOX,LG PACK,LG PKG)) AND (p_size#47 <= 15)))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":258},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]