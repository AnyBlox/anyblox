[{"totalTime":6169,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[numwait#242L DESC NULLS LAST,s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#282,toprettystring(numwait)#283])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":47}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":45},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":7984},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1821107},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_name#77, 200), ENSURE_REQUIREMENTS, [plan_id=2449]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":71912},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5335908159},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":71912},{"metricName":"local bytes read","value":1742119},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":50},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3451776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1742119}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":88706}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":86770},{"metricName":"peak memory","value":684195840},{"metricName":"number of output rows","value":71912},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":100}],"children":[{"nodeName":"Project","description":"Project [s_name#77]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":79466}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1982426},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":76954}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79, l_orderkey#90]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1875]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":25},{"metricName":"time to build","value":54},{"metricName":"time to collect","value":1936},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":18377216}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":53}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":20},{"metricName":"metadata time","value":1},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#262], LeftAnti, NOT (l_suppkey#264 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":77070}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#246], LeftSemi, NOT (l_suppkey#248 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":73158800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":76966}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2865},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=1892]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5007454210},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":75869475},{"metricName":"local bytes read","value":720912590},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16342}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#102 > l_commitdate#101)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_commitdate#101, l_receiptdate#102] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":80224975},{"metricName":"time spent in decode_batch","value":747288399},{"metricName":"time spent loading native vectors","value":118741877}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":71202}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#246 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4649},{"metricName":"peak memory","value":12616466432},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":1155656865},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#246, 200), ENSURE_REQUIREMENTS, [plan_id=1908]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":4086499780},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119994592},{"metricName":"local bytes read","value":1097673064},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2879870208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1097673064}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":20032}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#246, l_suppkey#248] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":86848035},{"metricName":"time spent in decode_batch","value":522532215},{"metricName":"time spent loading native vectors","value":96348735}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":68776}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#262 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2861},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#262, 200), ENSURE_REQUIREMENTS, [plan_id=1925]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3986316942},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":75869475},{"metricName":"local bytes read","value":720912590},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":15748}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#262, l_suppkey#264]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#274 > l_commitdate#273)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#262, l_suppkey#264, l_commitdate#273, l_receiptdate#274] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":83405413},{"metricName":"time spent in decode_batch","value":715939852},{"metricName":"time spent loading native vectors","value":111676190}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":19978}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":420},{"metricName":"peak memory","value":4194304000},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":77347372},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=1948]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14617146},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":802187994},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14617146},{"metricName":"local bytes read","value":74264229},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":233874336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":74264229}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":4429}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(o_orderstatus#26) AND (o_orderstatus#26 = F)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14617146}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderstatus#26] Batched: true, DataFilters: [isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderstatus:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderstatus:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":340},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=1971]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":2},{"metricName":"time to build","value":3},{"metricName":"time to collect","value":1869},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = SAUDI ARABIA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6651,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[numwait#478L DESC NULLS LAST,s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#518,toprettystring(numwait)#519])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":47}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":45},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":7984},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1821107},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_name#77, 200), ENSURE_REQUIREMENTS, [plan_id=5769]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":71912},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6037186373},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":71912},{"metricName":"local bytes read","value":1742119},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":50},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3451776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1742119}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":92550}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":90848},{"metricName":"peak memory","value":684195840},{"metricName":"number of output rows","value":71912},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":100}],"children":[{"nodeName":"Project","description":"Project [s_name#77]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":79466}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1982426},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":80337}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79, l_orderkey#90]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5195]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":24},{"metricName":"time to build","value":49},{"metricName":"time to collect","value":2210},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":18377216}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":48}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":17},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#498], LeftAnti, NOT (l_suppkey#500 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":80388}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#482], LeftSemi, NOT (l_suppkey#484 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":73158800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":80280}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4971},{"metricName":"peak memory","value":11005853696},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=5212]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":8526018845},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":124429466},{"metricName":"local bytes read","value":1182316643},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2624},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16212}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#102 > l_commitdate#101)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_commitdate#101, l_receiptdate#102] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":103977464},{"metricName":"time spent in decode_batch","value":682031574},{"metricName":"time spent loading native vectors","value":110316290}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":74154}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#482 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4533},{"metricName":"peak memory","value":12616466432},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":1155656865},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#482, 200), ENSURE_REQUIREMENTS, [plan_id=5228]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":10958428533},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":196295700},{"metricName":"local bytes read","value":1800185672},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2624},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2879870208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1097673064}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":21034}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#482, l_suppkey#484] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":77672470},{"metricName":"time spent in decode_batch","value":475911537},{"metricName":"time spent loading native vectors","value":90476180}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":71988}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#498 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2743},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#498, 200), ENSURE_REQUIREMENTS, [plan_id=5245]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6698373739},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":75869475},{"metricName":"local bytes read","value":1182316643},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2624},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":15589}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#498, l_suppkey#500]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#510 > l_commitdate#509)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#498, l_suppkey#500, l_commitdate#509, l_receiptdate#510] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":72841203},{"metricName":"time spent in decode_batch","value":671857597},{"metricName":"time spent loading native vectors","value":118401013}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":20991}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":370},{"metricName":"peak memory","value":4194304000},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":77347372},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=5268]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14617146},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1277396839},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14617146},{"metricName":"local bytes read","value":121789451},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2624},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":233874336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":74264229}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":4786}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(o_orderstatus#26) AND (o_orderstatus#26 = F)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14617146}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderstatus#26] Batched: true, DataFilters: [isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderstatus:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderstatus:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":323},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5291]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":5},{"metricName":"time to collect","value":2160},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":7}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = SAUDI ARABIA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6393,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[numwait#419L DESC NULLS LAST,s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#459,toprettystring(numwait)#460])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":47}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":45},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":7984},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1821107},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_name#77, 200), ENSURE_REQUIREMENTS, [plan_id=4939]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":71912},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5707618076},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":71912},{"metricName":"local bytes read","value":1742119},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":50},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3451776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1742119}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":87994}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":85887},{"metricName":"peak memory","value":684195840},{"metricName":"number of output rows","value":71912},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":100}],"children":[{"nodeName":"Project","description":"Project [s_name#77]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":79466}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1982426},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":75853}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79, l_orderkey#90]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4365]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":25},{"metricName":"time to build","value":50},{"metricName":"time to collect","value":2135},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":18377216}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":52}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":19},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#439], LeftAnti, NOT (l_suppkey#441 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":75907}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#423], LeftSemi, NOT (l_suppkey#425 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":73158800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":75818}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2950},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=4382]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5320561039},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":75869475},{"metricName":"local bytes read","value":720912590},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16031}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#102 > l_commitdate#101)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_commitdate#101, l_receiptdate#102] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":87788876},{"metricName":"time spent in decode_batch","value":718696508},{"metricName":"time spent loading native vectors","value":118997503}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":69783}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#423 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4673},{"metricName":"peak memory","value":12616466432},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":1155656865},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#423, 200), ENSURE_REQUIREMENTS, [plan_id=4398]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":10133800447},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119994592},{"metricName":"local bytes read","value":1097673064},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2879870208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1097673064}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":19681}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#423, l_suppkey#425] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":82271044},{"metricName":"time spent in decode_batch","value":484987692},{"metricName":"time spent loading native vectors","value":91393396}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":67594}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#439 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2818},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#439, 200), ENSURE_REQUIREMENTS, [plan_id=4415]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6057347122},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":75869475},{"metricName":"local bytes read","value":720912590},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":16457}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#439, l_suppkey#441]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#451 > l_commitdate#450)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#439, l_suppkey#441, l_commitdate#450, l_receiptdate#451] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":92991253},{"metricName":"time spent in decode_batch","value":717105227},{"metricName":"time spent loading native vectors","value":112316028}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":20062}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":394},{"metricName":"peak memory","value":4194304000},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":77347372},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=4438]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14617146},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":847357727},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14617146},{"metricName":"local bytes read","value":74264229},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":233874336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":74264229}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":4312}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(o_orderstatus#26) AND (o_orderstatus#26 = F)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14617146}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderstatus#26] Batched: true, DataFilters: [isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderstatus:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderstatus:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":271},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4461]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":2142},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = SAUDI ARABIA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6154,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[numwait#360L DESC NULLS LAST,s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#400,toprettystring(numwait)#401])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":47}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":45},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":7984},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1821107},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_name#77, 200), ENSURE_REQUIREMENTS, [plan_id=4109]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":71912},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6505433956},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":71912},{"metricName":"local bytes read","value":1742119},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":50},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3451776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1742119}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":87379}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":85363},{"metricName":"peak memory","value":684195840},{"metricName":"number of output rows","value":71912},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":100}],"children":[{"nodeName":"Project","description":"Project [s_name#77]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":79466}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1982426},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":75698}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79, l_orderkey#90]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3535]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":26},{"metricName":"time to build","value":54},{"metricName":"time to collect","value":1936},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":18377216}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":54}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":24},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#380], LeftAnti, NOT (l_suppkey#382 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":75752}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#364], LeftSemi, NOT (l_suppkey#366 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":73158800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":75654}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2914},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=3552]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5868286882},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":75869475},{"metricName":"local bytes read","value":720912590},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":15601}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#102 > l_commitdate#101)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_commitdate#101, l_receiptdate#102] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":75954984},{"metricName":"time spent in decode_batch","value":690180611},{"metricName":"time spent loading native vectors","value":113349091}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":69286}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#364 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4621},{"metricName":"peak memory","value":12616466432},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":1155656865},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#364, 200), ENSURE_REQUIREMENTS, [plan_id=3568]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":4471361933},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119994592},{"metricName":"local bytes read","value":1097673064},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2879870208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1097673064}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":19898}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#364, l_suppkey#366] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":99061145},{"metricName":"time spent in decode_batch","value":493992906},{"metricName":"time spent loading native vectors","value":99181387}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":67375}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#380 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2821},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#380, 200), ENSURE_REQUIREMENTS, [plan_id=3585]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":4341842508},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":75869475},{"metricName":"local bytes read","value":720912590},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":15831}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#380, l_suppkey#382]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#392 > l_commitdate#391)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#380, l_suppkey#382, l_commitdate#391, l_receiptdate#392] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":86484847},{"metricName":"time spent in decode_batch","value":680023224},{"metricName":"time spent loading native vectors","value":113891643}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":19486}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":376},{"metricName":"peak memory","value":4194304000},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":77347372},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=3608]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14617146},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1094223668},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14617146},{"metricName":"local bytes read","value":74264229},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1600},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":233874336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":74264229}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":4345}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(o_orderstatus#26) AND (o_orderstatus#26 = F)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14617146}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderstatus#26] Batched: true, DataFilters: [isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderstatus:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderstatus:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":307},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3631]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":5},{"metricName":"time to collect","value":1916},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = SAUDI ARABIA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6181,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[numwait#301L DESC NULLS LAST,s_name#77 ASC NULLS FIRST], output=[toprettystring(s_name)#341,toprettystring(numwait)#342])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":47}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":45},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":7984},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":13}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":1821107},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_name#77, 200), ENSURE_REQUIREMENTS, [plan_id=3279]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":71912},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5216990925},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":71912},{"metricName":"local bytes read","value":1742119},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":50},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3451776},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1742119}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":89060}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[s_name#77], functions=[partial_count(1)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":87109},{"metricName":"peak memory","value":684195840},{"metricName":"number of output rows","value":71912},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":100}],"children":[{"nodeName":"Project","description":"Project [s_name#77]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":79466}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":1982426},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":77140}],"children":[{"nodeName":"Project","description":"Project [s_name#77, s_nationkey#79, l_orderkey#90]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2705]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":26},{"metricName":"time to build","value":55},{"metricName":"time to collect","value":1931},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":18377216}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":52}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":21},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]},{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#321], LeftAnti, NOT (l_suppkey#323 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":4033998},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":77230}],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [l_orderkey#305], LeftSemi, NOT (l_suppkey#307 = l_suppkey#92)","metadata":{},"metrics":[{"metricName":"number of output rows","value":73158800},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":77159}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2924},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=2722]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":5418761950},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":92498024},{"metricName":"local bytes read","value":1182316643},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2624},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":16019}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_suppkey#92]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#102 > l_commitdate#101)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_commitdate#101, l_receiptdate#102] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":74598935},{"metricName":"time spent in decode_batch","value":714778145},{"metricName":"time spent loading native vectors","value":136072000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":70126}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#305 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4642},{"metricName":"peak memory","value":12616466432},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":1155656865},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#305, 200), ENSURE_REQUIREMENTS, [plan_id=2738]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":4824889049},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119994592},{"metricName":"local bytes read","value":1800185672},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2624},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2879870208},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1097673064}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":19743}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#305, l_suppkey#307] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":86034241},{"metricName":"time spent in decode_batch","value":496471514},{"metricName":"time spent loading native vectors","value":94814130}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":68318}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#321 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2844},{"metricName":"peak memory","value":6710886400},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":760449020},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#321, 200), ENSURE_REQUIREMENTS, [plan_id=2755]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":75869475},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":4738311290},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":75869475},{"metricName":"local bytes read","value":1182316643},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2624},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1820867400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":720912590}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":15363}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#321, l_suppkey#323]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (l_receiptdate#333 > l_commitdate#332)","metadata":{},"metrics":[{"metricName":"number of output rows","value":75869475}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#321, l_suppkey#323, l_commitdate#332, l_receiptdate#333] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":83711557},{"metricName":"time spent in decode_batch","value":683738173},{"metricName":"time spent loading native vectors","value":111749458}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":19908}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":366},{"metricName":"peak memory","value":4194304000},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":50},{"metricName":"partition data size","value":77347372},{"metricName":"number of coalesced partitions","value":50}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=2778]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":14617146},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":876132798},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":14617146},{"metricName":"local bytes read","value":121789451},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2624},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":233874336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":74264229}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":4744}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(o_orderstatus#26) AND (o_orderstatus#26 = F)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":14617146}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderstatus#26] Batched: true, DataFilters: [isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderstatus:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderstatus:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderstatus), EqualTo(o_orderstatus,F), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderstatus#26), (o_orderstatus#26 = F), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":340},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2801]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":2},{"metricName":"time to build","value":4},{"metricName":"time to collect","value":1860},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Project","description":"Project [n_nationkey#16]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(n_name#17) AND (n_name#17 = SAUDI ARABIA)) AND isnotnull(n_nationkey#16))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_name), EqualTo(n_name,SAUDI ARABIA), IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_name#17), (n_name#17 = SAUDI ARABIA), isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]