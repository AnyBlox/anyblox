[{"totalTime":3836,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[revenue#170 DESC NULLS LAST], output=[toprettystring(n_name)#176,toprettystring(revenue)#177])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":5},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16320},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_name#17, 200), ENSURE_REQUIREMENTS, [plan_id=2857]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3250988726},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200},{"metricName":"local bytes read","value":15517},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15517}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":37985}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":37019},{"metricName":"peak memory","value":10485760},{"metricName":"number of output rows","value":200},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":146190}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":728114}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92, c_nationkey#3], [s_suppkey#76, s_nationkey#79], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":728114}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":18200180},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":35173}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":85},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":46009410},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=2654]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1043455696},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4549846},{"metricName":"local bytes read","value":43767813},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":43767813}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":3617}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2017}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":35},{"metricName":"peak memory","value":2353004544},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2139]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3066355993},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":990},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":1297}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":199},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":5283}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":69},{"metricName":"peak memory","value":2491416576},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":51902439},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=2158]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2854356829},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4549846},{"metricName":"local bytes read","value":49518333},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1056},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":49518333}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2904}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1994-01-01)) AND (o_orderdate#28 < 1995-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":924},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3879}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4831},{"metricName":"peak memory","value":10737418240},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2271539126},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=2179]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6354656273},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119994592},{"metricName":"local bytes read","value":2203571264},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1280},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4799783680},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2203571264}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":33036}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":79296266},{"metricName":"time spent in decode_batch","value":1239101323},{"metricName":"time spent loading native vectors","value":150890691}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=2195]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":30},{"metricName":"time to build","value":44},{"metricName":"time to collect","value":79},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":28}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":11},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2212]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":3},{"metricName":"time to collect","value":49},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_name:string,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":2},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=2231]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":2},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":84},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":3}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = ASIA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":3},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":3770,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[revenue#262 DESC NULLS LAST], output=[toprettystring(n_name)#268,toprettystring(revenue)#269])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":5},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16320},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_name#17, 200), ENSURE_REQUIREMENTS, [plan_id=6761]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":205},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2449382134},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200},{"metricName":"local bytes read","value":15517},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6888},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15517}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":41537}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":40603},{"metricName":"peak memory","value":10747904},{"metricName":"number of output rows","value":205},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":175141}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":873535}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92, c_nationkey#3], [s_suppkey#76, s_nationkey#79], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":873535}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":21835788},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":40398}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":101},{"metricName":"peak memory","value":3422552064},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":46009410},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=6558]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":773575882},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":5458318},{"metricName":"local bytes read","value":52507054},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1584},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":43767813}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":3366}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":1848}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":35},{"metricName":"peak memory","value":2353004544},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=6043]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2827897776},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":990},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":1366}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":214},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":4928}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":70},{"metricName":"peak memory","value":2491416576},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":51902439},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=6062]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2575631289},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4549846},{"metricName":"local bytes read","value":49518333},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1056},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":49518333}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2861}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1994-01-01)) AND (o_orderdate#28 < 1995-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":705},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":4084}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":5606},{"metricName":"peak memory","value":12884901888},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2271539126},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=6083]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6955454894},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":143985975},{"metricName":"local bytes read","value":2644142379},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1536},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4799783680},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2203571264}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":29530}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":76656289},{"metricName":"time spent in decode_batch","value":1163011101},{"metricName":"time spent loading native vectors","value":119084839}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=6099]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":30},{"metricName":"time to build","value":39},{"metricName":"time to collect","value":63},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":26}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=6116]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":4},{"metricName":"time to collect","value":34},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_name:string,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=6135]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":39},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = ASIA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":3975,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[revenue#239 DESC NULLS LAST], output=[toprettystring(n_name)#245,toprettystring(revenue)#246])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":5},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16320},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_name#17, 200), ENSURE_REQUIREMENTS, [plan_id=5785]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2762878850},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200},{"metricName":"local bytes read","value":15517},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15517}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":40269}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38966},{"metricName":"peak memory","value":10485760},{"metricName":"number of output rows","value":200},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":146190}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":728114}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92, c_nationkey#3], [s_suppkey#76, s_nationkey#79], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":728114}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":18200180},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":36986}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":84},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":46009410},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=5582]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1515796945},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4549846},{"metricName":"local bytes read","value":43767813},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":43767813}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":4672}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2592}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":36},{"metricName":"peak memory","value":2353004544},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=5067]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3030744045},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":990},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":1289}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":192},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":6807}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":72},{"metricName":"peak memory","value":2491416576},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":51902439},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=5086]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2262440393},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4549846},{"metricName":"local bytes read","value":49518333},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1056},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":49518333}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2288}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1994-01-01)) AND (o_orderdate#28 < 1995-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":630},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3827}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4820},{"metricName":"peak memory","value":10737418240},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2271539126},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=5107]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11562097051},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119994592},{"metricName":"local bytes read","value":2203571264},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1280},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4799783680},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2203571264}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":32383}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":80689916},{"metricName":"time spent in decode_batch","value":1199943668},{"metricName":"time spent loading native vectors","value":140043320}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=5123]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":31},{"metricName":"time to build","value":48},{"metricName":"time to collect","value":65},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":28}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5140]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":37},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_name:string,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=5159]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":37},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = ASIA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":2},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":3801,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[revenue#216 DESC NULLS LAST], output=[toprettystring(n_name)#222,toprettystring(revenue)#223])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":5},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16320},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_name#17, 200), ENSURE_REQUIREMENTS, [plan_id=4809]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2860727239},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200},{"metricName":"local bytes read","value":15517},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15517}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":39033}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":37603},{"metricName":"peak memory","value":10485760},{"metricName":"number of output rows","value":200},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":146190}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":728114}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92, c_nationkey#3], [s_suppkey#76, s_nationkey#79], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":728114}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":18200180},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":35376}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":88},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":46009410},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=4606]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":5838152},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1362725973},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4549846},{"metricName":"local bytes read","value":43767813},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":140115552},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":49018328}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":3823}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":5838152},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":2198}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":54},{"metricName":"peak memory","value":3707764736},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=4091]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":3678157790},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4794066},{"metricName":"local bytes read","value":44229041},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1620},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2220}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":191},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":5511}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":103},{"metricName":"peak memory","value":3850371072},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":51902439},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=4110]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2457217643},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7012178},{"metricName":"local bytes read","value":80683591},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1728},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":49518333}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2321}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1994-01-01)) AND (o_orderdate#28 < 1995-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":672},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3870}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4859},{"metricName":"peak memory","value":10737418240},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2271539126},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=4131]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":161242733},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":6759523981},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119994592},{"metricName":"local bytes read","value":2203571264},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1280},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6449709320},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2961066467}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":43436}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":161242733},{"metricName":"number of input batches","value":1654}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":161242733},{"metricName":"time spent in job init","value":120095078},{"metricName":"time spent in decode_batch","value":1201009798},{"metricName":"time spent loading native vectors","value":124183289}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=4147]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":30},{"metricName":"time to build","value":46},{"metricName":"time to collect","value":70},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":26}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4164]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":51},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_name:string,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=4183]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":51},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = ASIA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":3843,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[revenue#193 DESC NULLS LAST], output=[toprettystring(n_name)#199,toprettystring(revenue)#200])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":4}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":5},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":16320},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_name#17, 200), ENSURE_REQUIREMENTS, [plan_id=3833]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2824577881},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200},{"metricName":"local bytes read","value":15517},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":40},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":6720},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":15517}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":40154}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[n_name#17], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":38755},{"metricName":"peak memory","value":10485760},{"metricName":"number of output rows","value":200},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [n_regionkey#18], [r_regionkey#70], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":146190}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, n_name#17, n_regionkey#18]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":728114}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_suppkey#92, c_nationkey#3], [s_suppkey#76, s_nationkey#79], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":728114}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_orderkey#24], [l_orderkey#90], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":18200180},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":36389}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":87},{"metricName":"peak memory","value":2852126720},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":46009410},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=3630]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":833627079},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4549846},{"metricName":"local bytes read","value":43767813},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1320},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":43767813}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":3413}],"children":[{"nodeName":"Project","description":"Project [c_nationkey#3, o_orderkey#24]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [c_custkey#0], [o_custkey#25], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":1886}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":34},{"metricName":"peak memory","value":2353004544},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":28490153},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3115]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2789867604},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":27144524},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":990},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":27144524}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":1271}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":194},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":5003}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":67},{"metricName":"peak memory","value":2491416576},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":33},{"metricName":"partition data size","value":51902439},{"metricName":"number of coalesced partitions","value":33}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=3134]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":4549846},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2558719067},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":4549846},{"metricName":"local bytes read","value":49518333},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1056},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":109196304},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":49518333}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":2610}],"children":[{"nodeName":"Project","description":"Project [o_orderkey#24, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((((isnotnull(o_orderdate#28) AND (o_orderdate#28 >= 1994-01-01)) AND (o_orderdate#28 < 1995-01-01)) AND isnotnull(o_custkey#25)) AND isnotnull(o_orderkey#24))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4549846}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01..., ReadSchema: struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderdate), GreaterThanOrEqual(o_orderdate,1994-01-01), LessThan(o_orderdate,1995-01-01), IsNotNull(o_custkey), IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderdate#28), (o_orderdate#28 >= 1994-01-01), (o_orderdate#28 < 1995-01-01), isnotnull(o_custkey#25), isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":803},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3778}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":4913},{"metricName":"peak memory","value":10737418240},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":40},{"metricName":"partition data size","value":2271539126},{"metricName":"number of coalesced partitions","value":40}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=3155]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":119994592},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7475247763},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":119994592},{"metricName":"local bytes read","value":2203571264},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1280},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4799783680},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2203571264}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":31387}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"number of input batches","value":1231}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994592},{"metricName":"time spent in job init","value":81223112},{"metricName":"time spent in decode_batch","value":1184912127},{"metricName":"time spent loading native vectors","value":164315538}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List((shiftleft(cast(input[0, int, false] as bigint), 32) | (cast(input[1, int, false] as bigint) & 4294967295))),false), [plan_id=3171]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":30},{"metricName":"time to build","value":41},{"metricName":"time to collect","value":71},{"metricName":"number of output rows","value":200000},{"metricName":"data size","value":16777216}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":27}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3188]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":44},{"metricName":"number of output rows","value":25},{"metricName":"data size","value":1048776}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND isnotnull(n_regionkey#18))","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17,n_regionkey#18] Batched: true, DataFilters: [isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), IsNotNull(n_regionkey)], ReadSchema: struct<n_nationkey:int,n_name:string,n_regionkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string,n_regionkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), IsNotNull(n_regionkey)]","DataFilters":"[isnotnull(n_nationkey#16), isnotnull(n_regionkey#18)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":1},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, true] as bigint)),false), [plan_id=3207]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":2},{"metricName":"time to build","value":4},{"metricName":"time to collect","value":70},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"Project","description":"Project [r_regionkey#70]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(r_name#71) AND (r_name#71 = ASIA)) AND isnotnull(r_regionkey#70))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [r_regionkey#70,r_name#71] Batched: true, DataFilters: [isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)], ReadSchema: struct<r_regionkey:int,r_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/region.parquet]","ReadSchema":"struct<r_regionkey:int,r_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(r_name), EqualTo(r_name,ASIA), IsNotNull(r_regionkey)]","DataFilters":"[isnotnull(r_name#71), (r_name#71 = ASIA), isnotnull(r_regionkey#70)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":2},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1046},{"metricName":"number of output rows","value":5}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]