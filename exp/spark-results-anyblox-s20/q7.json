[{"totalTime":91841,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#210 ASC NULLS FIRST,cust_nation#211 ASC NULLS FIRST,l_year#212 ASC NULLS FIRST], output=[toprettystring(supp_nation)#228,toprettystring(cust_nation)#229,toprettystring(l_year)#230,toprettystring(revenue)#231])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#210, cust_nation#211, l_year#212], functions=[sum(volume#213)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5088},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#210, cust_nation#211, l_year#212, 200), ENSURE_REQUIREMENTS, [plan_id=2764]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":48},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24918285},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":48},{"metricName":"local bytes read","value":4799},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":12},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4799}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":12608}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#210, cust_nation#211, l_year#212], functions=[partial_sum(volume#213)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":12530},{"metricName":"peak memory","value":3145728},{"metricName":"number of output rows","value":48},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS supp_nation#210, n_name#216 AS cust_nation#211, year(l_shipdate#100) AS l_year#212, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#213]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#215], Inner, BuildRight, (((n_name#17 = FRANCE) AND (n_name#216 = GERMANY)) OR ((n_name#17 = GERMANY) AND (n_name#216 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":12644}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":874},{"metricName":"peak memory","value":4294967296},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":744453105},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=2645]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":38873691},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":1058374212},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":39564752},{"metricName":"local bytes read","value":775949376},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":130},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1865937216},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":715096788}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":16254}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_orderkey#90], [o_orderkey#24], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":38873698}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=2513]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6864},{"metricName":"time to build","value":11531},{"metricName":"time to collect","value":14125},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":3107483448}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":10728}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_orderkey#90, l_extendedprice#95, l_discount#96, l_shipdate#100]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":51695936}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":283568}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":286016},{"metricName":"number of input batches","value":71}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":17},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":286016}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=2049]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6103},{"metricName":"time to build","value":9502},{"metricName":"time to collect","value":13286},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":2149083648}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":8305}],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1995-01-01) AND (l_shipdate#100 <= 1996-12-31))","metadata":{},"metrics":[{"metricName":"number of output rows","value":48249549}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":158794608},{"metricName":"number of input batches","value":1588}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":158794608},{"metricName":"time spent in job init","value":28679114},{"metricName":"time spent in decode_batch","value":1679629724},{"metricName":"time spent loading native vectors","value":164586829}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#24) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":31982959}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":31988781},{"metricName":"number of input batches","value":7942}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25] Batched: true, DataFilters: [isnotnull(o_orderkey#24), isnotnull(o_custkey#25)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":240},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":31988781}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":7424}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":58},{"metricName":"peak memory","value":905969664},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=2070]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":60834203},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":28804894},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":26},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":631}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":55},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2089]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":13},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":11496},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":25}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":24},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#215, n_name#216], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2089]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2089]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":13},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":11496},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":25}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":24},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":88029,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#382 ASC NULLS FIRST,cust_nation#383 ASC NULLS FIRST,l_year#384 ASC NULLS FIRST], output=[toprettystring(supp_nation)#400,toprettystring(cust_nation)#401,toprettystring(l_year)#402,toprettystring(revenue)#403])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#382, cust_nation#383, l_year#384], functions=[sum(volume#385)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5088},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#382, cust_nation#383, l_year#384, 200), ENSURE_REQUIREMENTS, [plan_id=6420]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":48},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":25048120},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":48},{"metricName":"local bytes read","value":4799},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":12},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4799}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":13592}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#382, cust_nation#383, l_year#384], functions=[partial_sum(volume#385)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":13538},{"metricName":"peak memory","value":3145728},{"metricName":"number of output rows","value":48},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS supp_nation#382, n_name#388 AS cust_nation#383, year(l_shipdate#100) AS l_year#384, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#385]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#387], Inner, BuildRight, (((n_name#17 = FRANCE) AND (n_name#388 = GERMANY)) OR ((n_name#17 = GERMANY) AND (n_name#388 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":13588}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":794},{"metricName":"peak memory","value":3959422976},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":744453105},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=6301]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":36562072},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":925467400},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":39144036},{"metricName":"local bytes read","value":836568503},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":140},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1754979456},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":715096788}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":16010}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_orderkey#90], [o_orderkey#24], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":36562075}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=6169]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6804},{"metricName":"time to build","value":11916},{"metricName":"time to collect","value":12215},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":3107483448}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":10730}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_orderkey#90, l_extendedprice#95, l_discount#96, l_shipdate#100]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":63792021}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":349925}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":353600},{"metricName":"number of input batches","value":88}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":14},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":353600}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=5791]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5808},{"metricName":"time to build","value":9554},{"metricName":"time to collect","value":10918},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":2149083648}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":8070}],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1995-01-01) AND (l_shipdate#100 <= 1996-12-31))","metadata":{},"metrics":[{"metricName":"number of output rows","value":55999812}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":184294608},{"metricName":"number of input batches","value":1843}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":184294608},{"metricName":"time spent in job init","value":25562686},{"metricName":"time spent in decode_batch","value":1861236151},{"metricName":"time spent loading native vectors","value":132551597}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#24) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":30081838}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30081920},{"metricName":"number of input batches","value":7469}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25] Batched: true, DataFilters: [isnotnull(o_orderkey#24), isnotnull(o_custkey#25)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":136},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30081920}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":8581}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":58},{"metricName":"peak memory","value":905969664},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=5812]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":122594922},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":31067290},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":28},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1302}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":111},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5831]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":4},{"metricName":"time to build","value":18},{"metricName":"time to collect","value":9902},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":11}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#387, n_name#388], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5831]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=5831]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":4},{"metricName":"time to build","value":18},{"metricName":"time to collect","value":9902},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":11}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":85850,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#339 ASC NULLS FIRST,cust_nation#340 ASC NULLS FIRST,l_year#341 ASC NULLS FIRST], output=[toprettystring(supp_nation)#357,toprettystring(cust_nation)#358,toprettystring(l_year)#359,toprettystring(revenue)#360])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#339, cust_nation#340, l_year#341], functions=[sum(volume#342)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5088},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#339, cust_nation#340, l_year#341, 200), ENSURE_REQUIREMENTS, [plan_id=5549]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":48},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":25522943},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":48},{"metricName":"local bytes read","value":4799},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":12},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4799}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":11688}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#339, cust_nation#340, l_year#341], functions=[partial_sum(volume#342)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":11619},{"metricName":"peak memory","value":3145728},{"metricName":"number of output rows","value":48},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS supp_nation#339, n_name#345 AS cust_nation#340, year(l_shipdate#100) AS l_year#341, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#342]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#344], Inner, BuildRight, (((n_name#17 = FRANCE) AND (n_name#345 = GERMANY)) OR ((n_name#17 = GERMANY) AND (n_name#345 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":11679}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":799},{"metricName":"peak memory","value":3959422976},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":744453105},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=5430]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":42701986},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":995416580},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":39352934},{"metricName":"local bytes read","value":775501512},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":130},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2049695376},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":789529079}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":21683}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_orderkey#90], [o_orderkey#24], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":42701988}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=5298]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6665},{"metricName":"time to build","value":10303},{"metricName":"time to collect","value":12193},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":3107483448}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":10724}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_orderkey#90, l_extendedprice#95, l_discount#96, l_shipdate#100]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":58573067}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":321296}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":324928},{"metricName":"number of input batches","value":81}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":16},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":324928}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=4834]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5812},{"metricName":"time to build","value":7482},{"metricName":"time to collect","value":10564},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":2149083648}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":8102}],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1995-01-01) AND (l_shipdate#100 <= 1996-12-31))","metadata":{},"metrics":[{"metricName":"number of output rows","value":37902423}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":124794608},{"metricName":"number of input batches","value":1248}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":124794608},{"metricName":"time spent in job init","value":32862966},{"metricName":"time spent in decode_batch","value":1229991878},{"metricName":"time spent loading native vectors","value":87306020}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#24) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":35133918}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":35136814},{"metricName":"number of input batches","value":8723}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25] Batched: true, DataFilters: [isnotnull(o_orderkey#24), isnotnull(o_custkey#25)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":178},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":35136814}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":6678}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":58},{"metricName":"peak memory","value":905969664},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=4855]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":91004732},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":28790404},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":26},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1571}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":89},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4874]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":10227},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":15}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":15},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#344, n_name#345], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4874]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4874]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":9},{"metricName":"time to collect","value":10227},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":15}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":15},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":83311,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#296 ASC NULLS FIRST,cust_nation#297 ASC NULLS FIRST,l_year#298 ASC NULLS FIRST], output=[toprettystring(supp_nation)#314,toprettystring(cust_nation)#315,toprettystring(l_year)#316,toprettystring(revenue)#317])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#296, cust_nation#297, l_year#298], functions=[sum(volume#299)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5088},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#296, cust_nation#297, l_year#298, 200), ENSURE_REQUIREMENTS, [plan_id=4592]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":48},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24765097},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":48},{"metricName":"local bytes read","value":4799},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":12},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4799}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":11729}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#296, cust_nation#297, l_year#298], functions=[partial_sum(volume#299)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":11660},{"metricName":"peak memory","value":3145728},{"metricName":"number of output rows","value":48},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS supp_nation#296, n_name#302 AS cust_nation#297, year(l_shipdate#100) AS l_year#298, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#299]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#301], Inner, BuildRight, (((n_name#17 = FRANCE) AND (n_name#302 = GERMANY)) OR ((n_name#17 = GERMANY) AND (n_name#302 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117819}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2917363}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36497502},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":11737}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":865},{"metricName":"peak memory","value":4294967296},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":744453105},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=4473]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":40868274},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":996866770},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":39551596},{"metricName":"local bytes read","value":775694206},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":130},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1961677200},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":715096788}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":17103}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_orderkey#90], [o_orderkey#24], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":40868284}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=4341]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6679},{"metricName":"time to build","value":10438},{"metricName":"time to collect","value":12498},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":3107483448}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":11066}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_orderkey#90, l_extendedprice#95, l_discount#96, l_shipdate#100]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":71648445}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":393016}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":398656},{"metricName":"number of input batches","value":99}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":23},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":398656}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=3963]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5842},{"metricName":"time to build","value":7356},{"metricName":"time to collect","value":10325},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":2149083648}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":8111}],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1995-01-01) AND (l_shipdate#100 <= 1996-12-31))","metadata":{},"metrics":[{"metricName":"number of output rows","value":51181449}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":168494608},{"metricName":"number of input batches","value":1685}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":168494608},{"metricName":"time spent in job init","value":17379572},{"metricName":"time spent in decode_batch","value":1653714164},{"metricName":"time spent loading native vectors","value":129522072}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#24) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":33625535}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":33629372},{"metricName":"number of input batches","value":8350}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25] Batched: true, DataFilters: [isnotnull(o_orderkey#24), isnotnull(o_custkey#25)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":624},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":33629372}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":6707}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":63},{"metricName":"peak memory","value":981467136},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3984]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":47078007},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3254213},{"metricName":"local bytes read","value":28794602},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":26},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":569}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":54},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4003]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":9095},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":13}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":13},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#301, n_name#302], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4003]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=4003]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":9095},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":13}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":13},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":87217,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[supp_nation#253 ASC NULLS FIRST,cust_nation#254 ASC NULLS FIRST,l_year#255 ASC NULLS FIRST], output=[toprettystring(supp_nation)#271,toprettystring(cust_nation)#272,toprettystring(l_year)#273,toprettystring(revenue)#274])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":10}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#253, cust_nation#254, l_year#255], functions=[sum(volume#256)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":4},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":5088},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(supp_nation#253, cust_nation#254, l_year#255, 200), ENSURE_REQUIREMENTS, [plan_id=3721]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":48},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24991658},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":48},{"metricName":"local bytes read","value":4799},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":12},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":2688},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":4799}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":11920}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[supp_nation#253, cust_nation#254, l_year#255], functions=[partial_sum(volume#256)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":11854},{"metricName":"peak memory","value":3145728},{"metricName":"number of output rows","value":48},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS supp_nation#253, n_name#259 AS cust_nation#254, year(l_shipdate#100) AS l_year#255, (l_extendedprice#95 * (1.0 - l_discount#96)) AS volume#256]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [c_nationkey#3], [n_nationkey#258], Inner, BuildRight, (((n_name#17 = FRANCE) AND (n_name#259 = GERMANY)) OR ((n_name#17 = GERMANY) AND (n_name#259 = FRANCE))), false","metadata":{},"metrics":[{"metricName":"number of output rows","value":117729}],"children":[{"nodeName":"Project","description":"Project [l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3, n_name#17]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_nationkey#79], [n_nationkey#16], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":2914502}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, c_nationkey#3]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [o_custkey#25], [c_custkey#0], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":36461891},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":11934}],"children":[{"nodeName":"Sort","description":"Sort [o_custkey#25 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":802},{"metricName":"peak memory","value":3959422976},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":744453105},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_custkey#25, 200), ENSURE_REQUIREMENTS, [plan_id=3602]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":40401449},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":980862863},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":38029588},{"metricName":"local bytes read","value":775501512},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":130},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":1939269552},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":715096788}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":16825}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_extendedprice#95, l_discount#96, l_shipdate#100, o_custkey#25]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [l_orderkey#90], [o_orderkey#24], Inner, BuildLeft, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":40401454}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=3470]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6716},{"metricName":"time to build","value":10409},{"metricName":"time to collect","value":15052},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":3107483448}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":13561}],"children":[{"nodeName":"Project","description":"Project [s_nationkey#79, l_orderkey#90, l_extendedprice#95, l_discount#96, l_shipdate#100]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [l_suppkey#92], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":58243333}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":319489}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":320832},{"metricName":"number of input batches","value":80}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":26},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":320832}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[1, int, false] as bigint)),false), [plan_id=3006]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5872},{"metricName":"time to build","value":8616},{"metricName":"time to collect","value":10433},{"metricName":"number of output rows","value":36461891},{"metricName":"data size","value":2149083648}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":8013}],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1995-01-01) AND (l_shipdate#100 <= 1996-12-31))","metadata":{},"metrics":[{"metricName":"number of output rows","value":42601480}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":140294608},{"metricName":"number of input batches","value":1403}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":140294608},{"metricName":"time spent in job init","value":37741610},{"metricName":"time spent in decode_batch","value":1426856044},{"metricName":"time spent loading native vectors","value":113807155}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Filter","description":"Filter (isnotnull(o_orderkey#24) AND isnotnull(o_custkey#25))","metadata":{},"metrics":[{"metricName":"number of output rows","value":33240060}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":33244002},{"metricName":"number of input batches","value":8253}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_custkey#25] Batched: true, DataFilters: [isnotnull(o_orderkey#24), isnotnull(o_custkey#25)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey), IsNotNull(o_custkey)], ReadSchema: struct<o_orderkey:int,o_custkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_custkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey), IsNotNull(o_custkey)]","DataFilters":"[isnotnull(o_orderkey#24), isnotnull(o_custkey#25)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":205},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":33244002}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":6870}],"children":[{"nodeName":"Sort","description":"Sort [c_custkey#0 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":58},{"metricName":"peak memory","value":905969664},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":12},{"metricName":"partition data size","value":27988000},{"metricName":"number of coalesced partitions","value":12}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(c_custkey#0, 200), ENSURE_REQUIREMENTS, [plan_id=3027]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":3000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":115135099},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":3000000},{"metricName":"local bytes read","value":28790404},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":26},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":72000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":26544400}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":1452}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(c_custkey#0) AND isnotnull(c_nationkey#3))","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":3000000},{"metricName":"number of input batches","value":746}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [c_custkey#0,c_nationkey#3] Batched: true, DataFilters: [isnotnull(c_custkey#0), isnotnull(c_nationkey#3)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_custkey), IsNotNull(c_nationkey)], ReadSchema: struct<c_custkey:int,c_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/customer.parquet]","ReadSchema":"struct<c_custkey:int,c_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(c_custkey), IsNotNull(c_nationkey)]","DataFilters":"[isnotnull(c_custkey#0), isnotnull(c_nationkey#3)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":139},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":254642972},{"metricName":"number of output rows","value":3000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3046]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":18},{"metricName":"time to collect","value":9989},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":11}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"ReusedExchange","description":"ReusedExchange [n_nationkey#258, n_name#259], BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3046]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=3046]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":18},{"metricName":"time to collect","value":9989},{"metricName":"number of output rows","value":2},{"metricName":"data size","value":1048592}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":11}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(n_nationkey#16) AND ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY)))","metadata":{},"metrics":[{"metricName":"number of output rows","value":2}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey), Or(EqualTo(n_name,FRANCE),EqualTo(n_name,GERMANY))]","DataFilters":"[isnotnull(n_nationkey#16), ((n_name#17 = FRANCE) OR (n_name#17 = GERMANY))]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]