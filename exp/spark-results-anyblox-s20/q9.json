[{"totalTime":127276,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[nation#196 ASC NULLS FIRST,o_year#197 DESC NULLS LAST], output=[toprettystring(nation)#207,toprettystring(o_year)#208,toprettystring(sum_profit)#209])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (22)","description":"WholeStageCodegen (22)","metadata":{},"metrics":[{"metricName":"duration","value":2}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#196, o_year#197], functions=[sum(amount#198)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14385},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(nation#196, o_year#197, 200), ENSURE_REQUIREMENTS, [plan_id=4207]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":175},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11600410},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":175},{"metricName":"local bytes read","value":13378},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13378}],"children":[{"nodeName":"WholeStageCodegen (21)","description":"WholeStageCodegen (21)","metadata":{},"metrics":[{"metricName":"duration","value":1934}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#196, o_year#197], functions=[partial_sum(amount#198)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1913},{"metricName":"peak memory","value":786432},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS nation#196, year(o_orderdate#28) AS o_year#197, ((l_extendedprice#95 * (1.0 - l_discount#96)) - (ps_supplycost#63 * l_quantity#94)) AS amount#198]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_nationkey#79], [n_nationkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":8824573},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (19)","description":"WholeStageCodegen (19)","metadata":{},"metrics":[{"metricName":"duration","value":1924}],"children":[{"nodeName":"Sort","description":"Sort [s_nationkey#79 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":113},{"metricName":"peak memory","value":1207959552},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":153914701},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_nationkey#79, 200), ENSURE_REQUIREMENTS, [plan_id=4123]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7230964},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":207524755},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9148292},{"metricName":"local bytes read","value":205225007},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":404933984},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":155608783}],"children":[{"nodeName":"WholeStageCodegen (18)","description":"WholeStageCodegen (18)","metadata":{},"metrics":[{"metricName":"duration","value":11042}],"children":[{"nodeName":"Project","description":"Project [l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":7230964},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":11018}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":191},{"metricName":"peak memory","value":905969664},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":186926546},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=4014]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6521328},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":262438376},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7369452},{"metricName":"local bytes read","value":202033241},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":63},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":365194368},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":178782973}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":14845}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92, l_partkey#91], [ps_suppkey#61, ps_partkey#60], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":14828}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST, l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":598},{"metricName":"peak memory","value":922746880},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":165648994},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=3878]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6521328},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":209293376},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7505262},{"metricName":"local bytes read","value":182176014},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":24},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":417364992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":158297378}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":3659}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92], [s_suppkey#76], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":3663}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":137},{"metricName":"peak memory","value":771751936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":149946546},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=3431]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6673865},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":781901903},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8807018},{"metricName":"local bytes read","value":205840178},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":268},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":373736440},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":142903996}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":38364}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#42], [l_partkey#91], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6673885},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":38157}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#42 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":4774035456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1252168},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=3075]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":217392},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":30291750},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":230289},{"metricName":"local bytes read","value":1266729},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":142},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3478272},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1195295}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":937}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_name#43) AND Contains(p_name#43, green)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":217392}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":370},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2300}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2395},{"metricName":"peak memory","value":14092861440},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":3505499400},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=3092]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":376582547},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":8331579478},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":126152536},{"metricName":"local bytes read","value":3476050223},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":71},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":21088622744},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10086429092}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":39076}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":376794608},{"metricName":"number of input batches","value":3768}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":376794608},{"metricName":"time spent in job init","value":71939335},{"metricName":"time spent in decode_batch","value":4469267873},{"metricName":"time spent loading native vectors","value":312832768}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3636}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#76 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":210763776},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1887530},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=3110]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":29085529},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2586816},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1795314}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":128}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":24},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":1259}],"children":[{"nodeName":"Sort","description":"Sort [ps_suppkey#61 ASC NULLS FIRST, ps_partkey#60 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":6657},{"metricName":"peak memory","value":1342177280},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":268030461},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=3131]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":17710687},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":366328698},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18400182},{"metricName":"local bytes read","value":292376697},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":56},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":566741984},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":254238854}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":4322}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(ps_suppkey#61) AND isnotnull(ps_partkey#60))","metadata":{},"metrics":[{"metricName":"number of output rows","value":17710688}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":17713039},{"metricName":"number of input batches","value":4406}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_supplycost#63] Batched: true, DataFilters: [isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_suppkey), IsNotNull(ps_partkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_suppkey), IsNotNull(ps_partkey)]","DataFilters":"[isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":408},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":17713039}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (17)","description":"WholeStageCodegen (17)","metadata":{},"metrics":[{"metricName":"duration","value":2888}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1094},{"metricName":"peak memory","value":2415919104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":310939069},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=3152]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":415904530},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":33900403},{"metricName":"local bytes read","value":331869308},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":90},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":720000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":293684544}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":5725}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(o_orderkey#24)","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":398},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (20)","description":"WholeStageCodegen (20)","metadata":{},"metrics":[{"metricName":"duration","value":1819}],"children":[{"nodeName":"Sort","description":"Sort [n_nationkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":268697600},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1756},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_nationkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=3173]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":25},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":2666082},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":35},{"metricName":"local bytes read","value":2414},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1732}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":25}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":9},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":126500,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[nation#340 ASC NULLS FIRST,o_year#341 DESC NULLS LAST], output=[toprettystring(nation)#351,toprettystring(o_year)#352,toprettystring(sum_profit)#353])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (22)","description":"WholeStageCodegen (22)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#340, o_year#341], functions=[sum(amount#342)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14385},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(nation#340, o_year#341, 200), ENSURE_REQUIREMENTS, [plan_id=9831]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":175},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11963584},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":175},{"metricName":"local bytes read","value":13378},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13378}],"children":[{"nodeName":"WholeStageCodegen (21)","description":"WholeStageCodegen (21)","metadata":{},"metrics":[{"metricName":"duration","value":1935}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#340, o_year#341], functions=[partial_sum(amount#342)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1923},{"metricName":"peak memory","value":786432},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS nation#340, year(o_orderdate#28) AS o_year#341, ((l_extendedprice#95 * (1.0 - l_discount#96)) - (ps_supplycost#63 * l_quantity#94)) AS amount#342]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_nationkey#79], [n_nationkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (19)","description":"WholeStageCodegen (19)","metadata":{},"metrics":[{"metricName":"duration","value":1929}],"children":[{"nodeName":"Sort","description":"Sort [s_nationkey#79 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":86},{"metricName":"peak memory","value":872415232},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":153914701},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_nationkey#79, 200), ENSURE_REQUIREMENTS, [plan_id=9747]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6521328},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":266094825},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9110996},{"metricName":"local bytes read","value":204400406},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":32},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":365194368},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":146229313}],"children":[{"nodeName":"WholeStageCodegen (18)","description":"WholeStageCodegen (18)","metadata":{},"metrics":[{"metricName":"duration","value":10963}],"children":[{"nodeName":"Project","description":"Project [l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":10939}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":191},{"metricName":"peak memory","value":905969664},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":186926546},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=9638]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7499825},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":373687189},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7369452},{"metricName":"local bytes read","value":202033241},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":63},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":419990200},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":205593512}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":16749}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92, l_partkey#91], [ps_suppkey#61, ps_partkey#60], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":7499825},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":16720}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST, l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":539},{"metricName":"peak memory","value":922746880},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":165648994},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=9502]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7029443},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":292957922},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7499825},{"metricName":"local bytes read","value":182048268},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":24},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":449884416},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":158297378}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":3715}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92], [s_suppkey#76], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":7029444},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":3721}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":197},{"metricName":"peak memory","value":1107296256},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":149946546},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=9055]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6590147},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":867271355},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9400806},{"metricName":"local bytes read","value":206000410},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":268},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":369048232},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":142903996}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":38084}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#42], [l_partkey#91], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6590147},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":37784}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#42 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":4774035456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1252168},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=8699]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":217392},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22020783},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":230449},{"metricName":"local bytes read","value":1267534},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":142},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3478272},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1195295}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":827}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_name#43) AND Contains(p_name#43, green)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":217392}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":282},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2273}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2339},{"metricName":"peak memory","value":13690208256},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":3505499400},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=8716]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":353845151},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":10524356071},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":125369682},{"metricName":"local bytes read","value":3476508979},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":71},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":19815328680},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":9453310442}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":39405}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":354094608},{"metricName":"number of input batches","value":3541}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":354094608},{"metricName":"time spent in job init","value":39780810},{"metricName":"time spent in decode_batch","value":4291787625},{"metricName":"time spent loading native vectors","value":272731042}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3693}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#76 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3},{"metricName":"peak memory","value":282066944},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1887530},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=8734]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":26282237},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":288130},{"metricName":"local bytes read","value":2586127},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1795314}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":116}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":12},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":1239}],"children":[{"nodeName":"Sort","description":"Sort [ps_suppkey#61 ASC NULLS FIRST, ps_partkey#60 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":7687},{"metricName":"peak memory","value":1543503872},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":268030461},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=8755]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":17255174},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":475238712},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":18400424},{"metricName":"local bytes read","value":292383987},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":56},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":552165568},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":254238854}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":3949}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(ps_suppkey#61) AND isnotnull(ps_partkey#60))","metadata":{},"metrics":[{"metricName":"number of output rows","value":17255175}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":17257394},{"metricName":"number of input batches","value":4292}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_supplycost#63] Batched: true, DataFilters: [isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_suppkey), IsNotNull(ps_partkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_suppkey), IsNotNull(ps_partkey)]","DataFilters":"[isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":242},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":17257394}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (17)","description":"WholeStageCodegen (17)","metadata":{},"metrics":[{"metricName":"duration","value":2855}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":964},{"metricName":"peak memory","value":2147483648},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":310939069},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=8776]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":30000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":558568241},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":30875880},{"metricName":"local bytes read","value":331869308},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":90},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":720000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":293684544}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":5607}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(o_orderkey#24)","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":30000000},{"metricName":"number of input batches","value":7449}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":254},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":30000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (20)","description":"WholeStageCodegen (20)","metadata":{},"metrics":[{"metricName":"duration","value":1824}],"children":[{"nodeName":"Sort","description":"Sort [n_nationkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":201523200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1756},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_nationkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=8797]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":25},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":8444078},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":25},{"metricName":"local bytes read","value":2426},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1732}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":10}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":7},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":127234,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[nation#304 ASC NULLS FIRST,o_year#305 DESC NULLS LAST], output=[toprettystring(nation)#315,toprettystring(o_year)#316,toprettystring(sum_profit)#317])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (22)","description":"WholeStageCodegen (22)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#304, o_year#305], functions=[sum(amount#306)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14385},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(nation#304, o_year#305, 200), ENSURE_REQUIREMENTS, [plan_id=8425]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":175},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12238028},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":175},{"metricName":"local bytes read","value":13378},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13378}],"children":[{"nodeName":"WholeStageCodegen (21)","description":"WholeStageCodegen (21)","metadata":{},"metrics":[{"metricName":"duration","value":1900}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#304, o_year#305], functions=[partial_sum(amount#306)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1887},{"metricName":"peak memory","value":786432},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS nation#304, year(o_orderdate#28) AS o_year#305, ((l_extendedprice#95 * (1.0 - l_discount#96)) - (ps_supplycost#63 * l_quantity#94)) AS amount#306]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_nationkey#79], [n_nationkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (19)","description":"WholeStageCodegen (19)","metadata":{},"metrics":[{"metricName":"duration","value":1892}],"children":[{"nodeName":"Sort","description":"Sort [s_nationkey#79 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":78},{"metricName":"peak memory","value":872415232},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":153914701},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_nationkey#79, 200), ENSURE_REQUIREMENTS, [plan_id=8341]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6976667},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":276123159},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":6521328},{"metricName":"local bytes read","value":146229313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":24},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":390693408},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":154849318}],"children":[{"nodeName":"WholeStageCodegen (18)","description":"WholeStageCodegen (18)","metadata":{},"metrics":[{"metricName":"duration","value":11111}],"children":[{"nodeName":"Project","description":"Project [l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6976668},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":11087}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":200},{"metricName":"peak memory","value":905969664},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":186926546},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=8232]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7533336},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":368942441},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7368768},{"metricName":"local bytes read","value":202012972},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":63},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":421866816},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":178782973}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":14605}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92, l_partkey#91], [ps_suppkey#61, ps_partkey#60], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":7533336},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":14582}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST, l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":617},{"metricName":"peak memory","value":1157627904},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":165648994},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=8096]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6521328},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":286481313},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8542189},{"metricName":"local bytes read","value":207353309},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":27},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":417364992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":158297378}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":3654}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92], [s_suppkey#76], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":3657}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":136},{"metricName":"peak memory","value":771751936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":149946546},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=7649]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6699764},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":968276362},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":6521328},{"metricName":"local bytes read","value":142903996},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":201},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":375186784},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":142903996}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":38313}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#42], [l_partkey#91], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6699792},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":38030}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#42 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":4774035456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1252168},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=7293]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":217392},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":21146544},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":230449},{"metricName":"local bytes read","value":1266965},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":142},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3478272},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1195295}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":805}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_name#43) AND Contains(p_name#43, green)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":217392}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":258},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2267}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2365},{"metricName":"peak memory","value":13891534848},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":3505499400},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=7310]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":441780061},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12783729713},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":126028265},{"metricName":"local bytes read","value":3476213008},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":71},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":24739683528},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":11880217041}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":78848}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":441989216},{"metricName":"number of input batches","value":4420}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":441989216},{"metricName":"time spent in job init","value":58706442},{"metricName":"time spent in decode_batch","value":5171012508},{"metricName":"time spent loading native vectors","value":370813582}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3631}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#76 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":210763776},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1887530},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=7328]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":18388882},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":1795314},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1795314}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":113}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":15},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":1241}],"children":[{"nodeName":"Sort","description":"Sort [ps_suppkey#61 ASC NULLS FIRST, ps_partkey#60 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":7709},{"metricName":"peak memory","value":1543503872},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":268030461},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=7349]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":478775114},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":20957158},{"metricName":"local bytes read","value":333010234},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":63},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":254238854}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":4030}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(ps_suppkey#61) AND isnotnull(ps_partkey#60))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_supplycost#63] Batched: true, DataFilters: [isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_suppkey), IsNotNull(ps_partkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_suppkey), IsNotNull(ps_partkey)]","DataFilters":"[isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":264},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (17)","description":"WholeStageCodegen (17)","metadata":{},"metrics":[{"metricName":"duration","value":2839}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1095},{"metricName":"peak memory","value":2415919104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":310939069},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=7370]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":32997832},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":582015362},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":33903762},{"metricName":"local bytes read","value":331899391},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":90},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":791947968},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":293684544}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":5603}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(o_orderkey#24)","metadata":{},"metrics":[{"metricName":"number of output rows","value":32997833}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":33000672},{"metricName":"number of input batches","value":8193}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":277},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":33000672}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (20)","description":"WholeStageCodegen (20)","metadata":{},"metrics":[{"metricName":"duration","value":1787}],"children":[{"nodeName":"Sort","description":"Sort [n_nationkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":201523200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1756},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_nationkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=7391]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":25},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":8552229},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":25},{"metricName":"local bytes read","value":1732},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1732}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":15}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":13},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":127891,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[nation#268 ASC NULLS FIRST,o_year#269 DESC NULLS LAST], output=[toprettystring(nation)#279,toprettystring(o_year)#280,toprettystring(sum_profit)#281])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (22)","description":"WholeStageCodegen (22)","metadata":{},"metrics":[{"metricName":"duration","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#268, o_year#269], functions=[sum(amount#270)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14385},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(nation#268, o_year#269, 200), ENSURE_REQUIREMENTS, [plan_id=7019]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":175},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11865100},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":175},{"metricName":"local bytes read","value":13378},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13378}],"children":[{"nodeName":"WholeStageCodegen (21)","description":"WholeStageCodegen (21)","metadata":{},"metrics":[{"metricName":"duration","value":1981}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#268, o_year#269], functions=[partial_sum(amount#270)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1966},{"metricName":"peak memory","value":786432},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS nation#268, year(o_orderdate#28) AS o_year#269, ((l_extendedprice#95 * (1.0 - l_discount#96)) - (ps_supplycost#63 * l_quantity#94)) AS amount#270]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_nationkey#79], [n_nationkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (19)","description":"WholeStageCodegen (19)","metadata":{},"metrics":[{"metricName":"duration","value":1975}],"children":[{"nodeName":"Sort","description":"Sort [s_nationkey#79 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":78},{"metricName":"peak memory","value":872415232},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":153914701},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_nationkey#79, 200), ENSURE_REQUIREMENTS, [plan_id=6935]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6521328},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":266239552},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":6521328},{"metricName":"local bytes read","value":146229313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":24},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":365194368},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":146229313}],"children":[{"nodeName":"WholeStageCodegen (18)","description":"WholeStageCodegen (18)","metadata":{},"metrics":[{"metricName":"duration","value":10967}],"children":[{"nodeName":"Project","description":"Project [l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":10940}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":172},{"metricName":"peak memory","value":805306368},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":186926546},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=6826]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":7077171},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":361635029},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7370263},{"metricName":"local bytes read","value":202058280},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":63},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":396321632},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":178782973}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":14618}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92, l_partkey#91], [ps_suppkey#61, ps_partkey#60], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":7077172},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":14601}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST, l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":603},{"metricName":"peak memory","value":1023410176},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":165648994},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=6690]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6521328},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":285540409},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":8475907},{"metricName":"local bytes read","value":205750571},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":27},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":417364992},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":158297378}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":3748}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92], [s_suppkey#76], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":3754}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":139},{"metricName":"peak memory","value":771751936},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":149946546},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=6243]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6649830},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":888099887},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":6521328},{"metricName":"local bytes read","value":142903996},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":201},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":372390480},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":142903996}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":38388}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#42], [l_partkey#91], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6649830},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":38126}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#42 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":4774035456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1252168},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=5887]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":283525},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22439866},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":230541},{"metricName":"local bytes read","value":1267386},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":142},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4536400},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1195295}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":835}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_name#43) AND Contains(p_name#43, green)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":283525}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":5217625},{"metricName":"number of input batches","value":1299}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":485},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":5217625}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2294}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2371},{"metricName":"peak memory","value":13891534848},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":3505499400},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=5904]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":419768037},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12556142666},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":126263817},{"metricName":"local bytes read","value":3476298602},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":71},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":23507010240},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":11313518774}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":78942}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":419889216},{"metricName":"number of input batches","value":4199}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":419889216},{"metricName":"time spent in job init","value":31899735},{"metricName":"time spent in decode_batch","value":4928116681},{"metricName":"time spent loading native vectors","value":346851941}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3726}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#76 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2},{"metricName":"peak memory","value":210763776},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1887530},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=5922]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":23522735},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":1795314},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1795314}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":105}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":22},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":1234}],"children":[{"nodeName":"Sort","description":"Sort [ps_suppkey#61 ASC NULLS FIRST, ps_partkey#60 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":7667},{"metricName":"peak memory","value":1543503872},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":268030461},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=5943]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":466042252},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":20802803},{"metricName":"local bytes read","value":330552280},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":63},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":254238854}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":4005}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(ps_suppkey#61) AND isnotnull(ps_partkey#60))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_supplycost#63] Batched: true, DataFilters: [isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_suppkey), IsNotNull(ps_partkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_suppkey), IsNotNull(ps_partkey)]","DataFilters":"[isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":247},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (17)","description":"WholeStageCodegen (17)","metadata":{},"metrics":[{"metricName":"duration","value":2849}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":968},{"metricName":"peak memory","value":2147483648},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":310939069},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=5964]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":31447127},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":595694118},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":30000000},{"metricName":"local bytes read","value":331841112},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":90},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":754731072},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":293684544}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":5853}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(o_orderkey#24)","metadata":{},"metrics":[{"metricName":"number of output rows","value":31447128}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":31447284},{"metricName":"number of input batches","value":7808}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":366},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":31447284}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (20)","description":"WholeStageCodegen (20)","metadata":{},"metrics":[{"metricName":"duration","value":1869}],"children":[{"nodeName":"Sort","description":"Sort [n_nationkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":201523200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1756},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_nationkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=5985]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":25},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7633361},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":25},{"metricName":"local bytes read","value":1732},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1732}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":16}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":13},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":128517,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[nation#232 ASC NULLS FIRST,o_year#233 DESC NULLS LAST], output=[toprettystring(nation)#243,toprettystring(o_year)#244,toprettystring(sum_profit)#245])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (22)","description":"WholeStageCodegen (22)","metadata":{},"metrics":[{"metricName":"duration","value":5}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#232, o_year#233], functions=[sum(amount#234)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":67371008},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":10}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":14385},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 10","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(nation#232, o_year#233, 200), ENSURE_REQUIREMENTS, [plan_id=5613]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":175},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11738362},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":175},{"metricName":"local bytes read","value":13378},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":7336},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":13378}],"children":[{"nodeName":"WholeStageCodegen (21)","description":"WholeStageCodegen (21)","metadata":{},"metrics":[{"metricName":"duration","value":1913}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[nation#232, o_year#233], functions=[partial_sum(amount#234)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":1900},{"metricName":"peak memory","value":786432},{"metricName":"number of output rows","value":175},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"Project","description":"Project [n_name#17 AS nation#232, year(o_orderdate#28) AS o_year#233, ((l_extendedprice#95 * (1.0 - l_discount#96)) - (ps_supplycost#63 * l_quantity#94)) AS amount#234]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [s_nationkey#79], [n_nationkey#16], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (19)","description":"WholeStageCodegen (19)","metadata":{},"metrics":[{"metricName":"duration","value":1910}],"children":[{"nodeName":"Sort","description":"Sort [s_nationkey#79 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":78},{"metricName":"peak memory","value":872415232},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":153914701},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 9","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_nationkey#79, 200), ENSURE_REQUIREMENTS, [plan_id=5529]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6965107},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":276215085},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":6521328},{"metricName":"local bytes read","value":146229313},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":24},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":390046048},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":154849540}],"children":[{"nodeName":"WholeStageCodegen (18)","description":"WholeStageCodegen (18)","metadata":{},"metrics":[{"metricName":"duration","value":11019}],"children":[{"nodeName":"Project","description":"Project [l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63, o_orderdate#28]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_orderkey#90], [o_orderkey#24], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6965108},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (16)","description":"WholeStageCodegen (16)","metadata":{},"metrics":[{"metricName":"duration","value":10999}],"children":[{"nodeName":"Sort","description":"Sort [l_orderkey#90 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":199},{"metricName":"peak memory","value":905969664},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":186926546},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 8","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_orderkey#90, 200), ENSURE_REQUIREMENTS, [plan_id=5420]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6521328},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":348976044},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":7368789},{"metricName":"local bytes read","value":202017985},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":63},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":365194368},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":178782973}],"children":[{"nodeName":"WholeStageCodegen (15)","description":"WholeStageCodegen (15)","metadata":{},"metrics":[{"metricName":"duration","value":14556}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79, ps_supplycost#63]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92, l_partkey#91], [ps_suppkey#61, ps_partkey#60], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6521328},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (13)","description":"WholeStageCodegen (13)","metadata":{},"metrics":[{"metricName":"duration","value":14534}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST, l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":462},{"metricName":"peak memory","value":822083584},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":165648994},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 7","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=5284]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":9070115},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":333556784},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":6783820},{"metricName":"local bytes read","value":182059758},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":24},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":580487360},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":158297378}],"children":[{"nodeName":"WholeStageCodegen (12)","description":"WholeStageCodegen (12)","metadata":{},"metrics":[{"metricName":"duration","value":3918}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96, s_nationkey#79]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [l_suppkey#92], [s_suppkey#76], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":9070115},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (10)","description":"WholeStageCodegen (10)","metadata":{},"metrics":[{"metricName":"duration","value":3923}],"children":[{"nodeName":"Sort","description":"Sort [l_suppkey#92 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":199},{"metricName":"peak memory","value":1107296256},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":149946546},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 6","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=4837]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":6641924},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":903442069},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":9393495},{"metricName":"local bytes read","value":205840178},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":268},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":371947744},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":143211001}],"children":[{"nodeName":"WholeStageCodegen (9)","description":"WholeStageCodegen (9)","metadata":{},"metrics":[{"metricName":"duration","value":38898}],"children":[{"nodeName":"Project","description":"Project [l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"SortMergeJoin","description":"SortMergeJoin [p_partkey#42], [l_partkey#91], Inner","metadata":{},"metrics":[{"metricName":"number of output rows","value":6641924},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (7)","description":"WholeStageCodegen (7)","metadata":{},"metrics":[{"metricName":"duration","value":38653}],"children":[{"nodeName":"Sort","description":"Sort [p_partkey#42 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":5},{"metricName":"peak memory","value":4774035456},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":1252168},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(p_partkey#42, 200), ENSURE_REQUIREMENTS, [plan_id=4481]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":217392},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":26180668},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":230571},{"metricName":"local bytes read","value":1267784},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":142},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":3478272},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1195295}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":957}],"children":[{"nodeName":"Project","description":"Project [p_partkey#42]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((isnotnull(p_name#43) AND Contains(p_name#43, green)) AND isnotnull(p_partkey#42))","metadata":{},"metrics":[{"metricName":"number of output rows","value":217392}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":4000000},{"metricName":"number of input batches","value":996}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [p_partkey#42,p_name#43] Batched: true, DataFilters: [isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)], ReadSchema: struct<p_partkey:int,p_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/part.parquet]","ReadSchema":"struct<p_partkey:int,p_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(p_name), StringContains(p_name,green), IsNotNull(p_partkey)]","DataFilters":"[isnotnull(p_name#43), Contains(p_name#43, green), isnotnull(p_partkey#42)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":376},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":138880646},{"metricName":"number of output rows","value":4000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (8)","description":"WholeStageCodegen (8)","metadata":{},"metrics":[{"metricName":"duration","value":2288}],"children":[{"nodeName":"Sort","description":"Sort [l_partkey#91 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":2363},{"metricName":"peak memory","value":13891534848},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":67},{"metricName":"partition data size","value":3505499400},{"metricName":"number of coalesced partitions","value":67}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_partkey#91, 200), ENSURE_REQUIREMENTS, [plan_id=4498]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":404072163},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":11722528619},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":125843440},{"metricName":"local bytes read","value":3476708482},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":71},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":22628041352},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":10840965221}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":39786}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":404294608},{"metricName":"number of input batches","value":4043}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_orderkey#90, l_partkey#91, l_suppkey#92, l_quantity#94, l_extendedprice#95, l_discount#96] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":404294608},{"metricName":"time spent in job init","value":46997320},{"metricName":"time spent in decode_batch","value":4835649645},{"metricName":"time spent loading native vectors","value":340267670}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (11)","description":"WholeStageCodegen (11)","metadata":{},"metrics":[{"metricName":"duration","value":3896}],"children":[{"nodeName":"Sort","description":"Sort [s_suppkey#76 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":3},{"metricName":"peak memory","value":282066944},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1887530},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 2","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(s_suppkey#76, 200), ENSURE_REQUIREMENTS, [plan_id=4516]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":33687289},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":288172},{"metricName":"local bytes read","value":2586816},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":4},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1795314}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":125}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(s_suppkey#76) AND isnotnull(s_nationkey#79))","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_nationkey#79] Batched: true, DataFilters: [isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey), IsNotNull(s_nationkey)], ReadSchema: struct<s_suppkey:int,s_nationkey:int>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_nationkey:int>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey), IsNotNull(s_nationkey)]","DataFilters":"[isnotnull(s_suppkey#76), isnotnull(s_nationkey#79)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":18},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (14)","description":"WholeStageCodegen (14)","metadata":{},"metrics":[{"metricName":"duration","value":1239}],"children":[{"nodeName":"Sort","description":"Sort [ps_suppkey#61 ASC NULLS FIRST, ps_partkey#60 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":6670},{"metricName":"peak memory","value":1342177280},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":7},{"metricName":"partition data size","value":268030461},{"metricName":"number of coalesced partitions","value":7}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 3","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(ps_suppkey#61, ps_partkey#60, 200), ENSURE_REQUIREMENTS, [plan_id=4537]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":16000000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":481185394},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":16000000},{"metricName":"local bytes read","value":292430022},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":56},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":512000000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":254238854}],"children":[{"nodeName":"WholeStageCodegen (4)","description":"WholeStageCodegen (4)","metadata":{},"metrics":[{"metricName":"duration","value":4208}],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(ps_suppkey#61) AND isnotnull(ps_partkey#60))","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":16000000},{"metricName":"number of input batches","value":3980}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [ps_partkey#60,ps_suppkey#61,ps_supplycost#63] Batched: true, DataFilters: [isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ps_suppkey), IsNotNull(ps_partkey)], ReadSchema: struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/partsupp.parquet]","ReadSchema":"struct<ps_partkey:int,ps_suppkey:int,ps_supplycost:double>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(ps_suppkey), IsNotNull(ps_partkey)]","DataFilters":"[isnotnull(ps_suppkey#61), isnotnull(ps_partkey#60)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":270},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":912170209},{"metricName":"number of output rows","value":16000000}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (17)","description":"WholeStageCodegen (17)","metadata":{},"metrics":[{"metricName":"duration","value":2884}],"children":[{"nodeName":"Sort","description":"Sort [o_orderkey#24 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":1097},{"metricName":"peak memory","value":2415919104},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":8},{"metricName":"partition data size","value":310939069},{"metricName":"number of coalesced partitions","value":8}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 4","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(o_orderkey#24, 200), ENSURE_REQUIREMENTS, [plan_id=4558]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":32021876},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":570948835},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":33898226},{"metricName":"local bytes read","value":331847637},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":90},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":768525024},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":293684544}],"children":[{"nodeName":"WholeStageCodegen (5)","description":"WholeStageCodegen (5)","metadata":{},"metrics":[{"metricName":"duration","value":5752}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(o_orderkey#24)","metadata":{},"metrics":[{"metricName":"number of output rows","value":32021877}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":32024782},{"metricName":"number of input batches","value":7953}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [o_orderkey#24,o_orderdate#28] Batched: true, DataFilters: [isnotnull(o_orderkey#24)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(o_orderkey)], ReadSchema: struct<o_orderkey:int,o_orderdate:date>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/orders.parquet]","ReadSchema":"struct<o_orderkey:int,o_orderdate:date>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(o_orderkey)]","DataFilters":"[isnotnull(o_orderkey#24)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":372},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":1272535306},{"metricName":"number of output rows","value":32024782}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (20)","description":"WholeStageCodegen (20)","metadata":{},"metrics":[{"metricName":"duration","value":1806}],"children":[{"nodeName":"Sort","description":"Sort [n_nationkey#16 ASC NULLS FIRST], false, 0","metadata":{},"metrics":[{"metricName":"sort time","value":0},{"metricName":"peak memory","value":201523200},{"metricName":"spill size","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":3},{"metricName":"partition data size","value":1756},{"metricName":"number of coalesced partitions","value":3}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 5","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(n_nationkey#16, 200), ENSURE_REQUIREMENTS, [plan_id=4579]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":25},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":7784073},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":25},{"metricName":"local bytes read","value":1732},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":3},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":848},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":1732}],"children":[{"nodeName":"WholeStageCodegen (6)","description":"WholeStageCodegen (6)","metadata":{},"metrics":[{"metricName":"duration","value":12}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(n_nationkey#16)","metadata":{},"metrics":[{"metricName":"number of output rows","value":25}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":25},{"metricName":"number of input batches","value":1}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [n_nationkey#16,n_name#17] Batched: true, DataFilters: [isnotnull(n_nationkey#16)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(n_nationkey)], ReadSchema: struct<n_nationkey:int,n_name:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/nation.parquet]","ReadSchema":"struct<n_nationkey:int,n_name:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(n_nationkey)]","DataFilters":"[isnotnull(n_nationkey#16)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":10},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":2360},{"metricName":"number of output rows","value":25}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]