[{"totalTime":7066,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#431,toprettystring(s_name)#432,toprettystring(s_address)#433,toprettystring(s_phone)#434,toprettystring(total_revenue)#435])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":176}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#398]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#397], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":65},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=821]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":7},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":3625},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":129}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#397, sum((l_extendedprice * (1 - l_discount)))#396 AS total_revenue#398]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#396) AND (sum((l_extendedprice * (1 - l_discount)))#396 = Subquery subquery#394, [id=#694]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":114},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=752]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":15116014},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":3043}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2995},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":7620835}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":201794608},{"metricName":"number of input batches","value":2018}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":201794608},{"metricName":"time spent in job init","value":4705042},{"metricName":"time spent in decode_batch","value":2189730803},{"metricName":"time spent loading native vectors","value":239895315}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#394, [id=#694]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":3406}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#400)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=891]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":269103},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":127}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#400)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":122},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#479], functions=[sum((l_extendedprice#482 * (1.0 - l_discount#483)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":113},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#479, 200), ENSURE_REQUIREMENTS, [plan_id=854]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24644467},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2995}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#479], functions=[partial_sum((l_extendedprice#482 * (1.0 - l_discount#483)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2911},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#479, l_extendedprice#482, l_discount#483]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#487 >= 1996-01-01) AND (l_shipdate#487 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#479, l_extendedprice#482, l_discount#483, l_shipdate#487] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":9556675},{"metricName":"time spent in decode_batch","value":1214362663},{"metricName":"time spent loading native vectors","value":132371514}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":5881,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#971,toprettystring(s_name)#972,toprettystring(s_address)#973,toprettystring(s_phone)#974,toprettystring(total_revenue)#975])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":100}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#938]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#937], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":33},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=2037]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":1},{"metricName":"time to collect","value":2994},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":80}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#937, sum((l_extendedprice * (1 - l_discount)))#936 AS total_revenue#938]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#936) AND (sum((l_extendedprice * (1 - l_discount)))#936 = Subquery subquery#934, [id=#1910]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":76},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=1968]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":25932024},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":222016},{"metricName":"local bytes read","value":5501776},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":2},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2586}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2505},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":2356600},{"metricName":"time spent in decode_batch","value":1061313809},{"metricName":"time spent loading native vectors","value":84800759}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#934, [id=#1910]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":2828}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#940)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=2107]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":210920},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":116}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#940)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":116},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#1019], functions=[sum((l_extendedprice#1022 * (1.0 - l_discount#1023)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":102},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#1019, 200), ENSURE_REQUIREMENTS, [plan_id=2070]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":22049376},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2511}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#1019], functions=[partial_sum((l_extendedprice#1022 * (1.0 - l_discount#1023)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2463},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#1019, l_extendedprice#1022, l_discount#1023]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#1027 >= 1996-01-01) AND (l_shipdate#1027 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#1019, l_extendedprice#1022, l_discount#1023, l_shipdate#1027] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":6809115},{"metricName":"time spent in decode_batch","value":1026542539},{"metricName":"time spent loading native vectors","value":83671001}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6117,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#836,toprettystring(s_name)#837,toprettystring(s_address)#838,toprettystring(s_phone)#839,toprettystring(total_revenue)#840])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":110}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#803]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#802], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":37},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1733]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":6},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":3026},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":135}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#802, sum((l_extendedprice * (1 - l_discount)))#801 AS total_revenue#803]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#801) AND (sum((l_extendedprice * (1 - l_discount)))#801 = Subquery subquery#799, [id=#1606]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":126},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=1664]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":14787814},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2770}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2734},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":7521968}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":199194608},{"metricName":"number of input batches","value":1992}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":199194608},{"metricName":"time spent in job init","value":12729478},{"metricName":"time spent in decode_batch","value":1864660506},{"metricName":"time spent loading native vectors","value":137954671}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#799, [id=#1606]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":2785}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#805)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1803]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":181219},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":85}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#805)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":85},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#884], functions=[sum((l_extendedprice#887 * (1.0 - l_discount#888)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":79},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#884, 200), ENSURE_REQUIREMENTS, [plan_id=1766]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":14551756},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2520}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#884], functions=[partial_sum((l_extendedprice#887 * (1.0 - l_discount#888)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2474},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#884, l_extendedprice#887, l_discount#888]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#892 >= 1996-01-01) AND (l_shipdate#892 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#884, l_extendedprice#887, l_discount#888, l_shipdate#892] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":7358276},{"metricName":"time spent in decode_batch","value":1041477837},{"metricName":"time spent loading native vectors","value":90093274}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6232,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#701,toprettystring(s_name)#702,toprettystring(s_address)#703,toprettystring(s_phone)#704,toprettystring(total_revenue)#705])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":172}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#668]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#667], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":65},{"metricName":"metadata time","value":1},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1429]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":5},{"metricName":"time to build","value":2},{"metricName":"time to collect","value":3260},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":107}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#667, sum((l_extendedprice * (1 - l_discount)))#666 AS total_revenue#668]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#666) AND (sum((l_extendedprice * (1 - l_discount)))#666 = Subquery subquery#664, [id=#1302]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":103},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=1360]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":14583487},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2600}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2538},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":8722128},{"metricName":"time spent in decode_batch","value":1063341825},{"metricName":"time spent loading native vectors","value":92678367}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#664, [id=#1302]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":3057}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#670)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1499]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":195588},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":112}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#670)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":112},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#749], functions=[sum((l_extendedprice#752 * (1.0 - l_discount#753)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":103},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#749, 200), ENSURE_REQUIREMENTS, [plan_id=1462]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":12611088},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2744}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#749], functions=[partial_sum((l_extendedprice#752 * (1.0 - l_discount#753)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2703},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#749, l_extendedprice#752, l_discount#753]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#757 >= 1996-01-01) AND (l_shipdate#757 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#749, l_extendedprice#752, l_discount#753, l_shipdate#757] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":2711796},{"metricName":"time spent in decode_batch","value":1169342779},{"metricName":"time spent loading native vectors","value":91589666}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}},{"totalTime":6281,"plan":{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"TakeOrderedAndProject","description":"TakeOrderedAndProject(limit=21, orderBy=[s_suppkey#76 ASC NULLS FIRST], output=[toprettystring(s_suppkey)#566,toprettystring(s_name)#567,toprettystring(s_address)#568,toprettystring(s_phone)#569,toprettystring(total_revenue)#570])","metadata":{},"metrics":[{"metricName":"shuffle records written","value":0},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":0},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":0},{"metricName":"local bytes read","value":0},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":0},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"local merged bytes read","value":0},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":0}],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":182}],"children":[{"nodeName":"Project","description":"Project [s_suppkey#76, s_name#77, s_address#78, s_phone#80, total_revenue#533]","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastHashJoin","description":"BroadcastHashJoin [s_suppkey#76], [supplier_no#532], Inner, BuildRight, false","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"Filter","description":"Filter isnotnull(s_suppkey#76)","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":200000},{"metricName":"number of input batches","value":50}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"Scan parquet ","description":"FileScan parquet [s_suppkey#76,s_name#77,s_address#78,s_phone#80] Batched: true, DataFilters: [isnotnull(s_suppkey#76)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_suppkey)], ReadSchema: struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","metadata":{"Location":"InMemoryFileIndex(1 paths)[file:/data/tpch-data/supplier.parquet]","ReadSchema":"struct<s_suppkey:int,s_name:string,s_address:string,s_phone:string>","Format":"Parquet","Batched":"true","PartitionFilters":"[]","PushedFilters":"[IsNotNull(s_suppkey)]","DataFilters":"[isnotnull(s_suppkey#76)]"},"metrics":[{"metricName":"number of files read","value":1},{"metricName":"scan time","value":68},{"metricName":"metadata time","value":0},{"metricName":"size of files read","value":16203518},{"metricName":"number of output rows","value":200000}],"children":[]}]}]}]},{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastQueryStage","description":"BroadcastQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"BroadcastExchange","description":"BroadcastExchange HashedRelationBroadcastMode(List(cast(input[0, int, false] as bigint)),false), [plan_id=1125]","metadata":{},"metrics":[{"metricName":"time to broadcast","value":1},{"metricName":"time to build","value":5},{"metricName":"time to collect","value":3077},{"metricName":"number of output rows","value":1},{"metricName":"data size","value":1048584}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":95}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92 AS supplier_no#532, sum((l_extendedprice * (1 - l_discount)))#531 AS total_revenue#533]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter (isnotnull(sum((l_extendedprice * (1 - l_discount)))#531) AND (sum((l_extendedprice * (1 - l_discount)))#531 = Subquery subquery#529, [id=#998]))","metadata":{},"metrics":[{"metricName":"number of output rows","value":1}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":86},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#92, 200), ENSURE_REQUIREMENTS, [plan_id=1056]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":24761116},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2802}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#92], functions=[partial_sum((l_extendedprice#95 * (1.0 - l_discount#96)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2749},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#92, l_extendedprice#95, l_discount#96]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#100 >= 1996-01-01) AND (l_shipdate#100 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":4532314}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"number of input batches","value":1200}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#92, l_extendedprice#95, l_discount#96, l_shipdate#100] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":119994608},{"metricName":"time spent in job init","value":2371137},{"metricName":"time spent in decode_batch","value":1213995183},{"metricName":"time spent loading native vectors","value":99144282}],"children":[]}]}]}]}]}]}]}]}]}]}]}]},{"nodeName":"Subquery","description":"Subquery subquery#529, [id=#998]","metadata":{},"metrics":[{"metricName":"data size","value":16},{"metricName":"time to collect","value":2888}],"children":[{"nodeName":"AdaptiveSparkPlan","description":"AdaptiveSparkPlan isFinalPlan=true","metadata":{},"metrics":[],"children":[{"nodeName":"WholeStageCodegen (3)","description":"WholeStageCodegen (3)","metadata":{},"metrics":[{"metricName":"duration","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[max(total_revenue#535)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":0},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 1","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [plan_id=1195]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":1},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":203857},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":1},{"metricName":"local bytes read","value":59},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":16},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":1},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":59}],"children":[{"nodeName":"WholeStageCodegen (2)","description":"WholeStageCodegen (2)","metadata":{},"metrics":[{"metricName":"duration","value":112}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[], functions=[partial_max(total_revenue#535)])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":112},{"metricName":"peak memory","value":0},{"metricName":"number of output rows","value":1},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":0}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#614], functions=[sum((l_extendedprice#617 * (1.0 - l_discount#618)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":103},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":16}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"AQEShuffleRead","description":"AQEShuffleRead coalesced","metadata":{},"metrics":[{"metricName":"number of partitions","value":1},{"metricName":"partition data size","value":2889666},{"metricName":"number of coalesced partitions","value":1}],"children":[{"nodeName":"ShuffleQueryStage","description":"ShuffleQueryStage 0","metadata":{},"metrics":[],"children":[{"nodeName":"Exchange","description":"Exchange hashpartitioning(l_suppkey#614, 200), ENSURE_REQUIREMENTS, [plan_id=1158]","metadata":{},"metrics":[{"metricName":"shuffle records written","value":200000},{"metricName":"local merged chunks fetched","value":0},{"metricName":"shuffle write time","value":13628240},{"metricName":"remote merged bytes read","value":0},{"metricName":"local merged blocks fetched","value":0},{"metricName":"corrupt merged block chunks","value":0},{"metricName":"remote merged reqs duration","value":0},{"metricName":"remote merged blocks fetched","value":0},{"metricName":"records read","value":200000},{"metricName":"local bytes read","value":2750888},{"metricName":"fetch wait time","value":0},{"metricName":"remote bytes read","value":0},{"metricName":"merged fetch fallback count","value":0},{"metricName":"local blocks read","value":1},{"metricName":"remote merged chunks fetched","value":0},{"metricName":"remote blocks read","value":0},{"metricName":"data size","value":4800000},{"metricName":"local merged bytes read","value":0},{"metricName":"number of partitions","value":200},{"metricName":"remote reqs duration","value":0},{"metricName":"remote bytes read to disk","value":0},{"metricName":"shuffle bytes written","value":2750888}],"children":[{"nodeName":"WholeStageCodegen (1)","description":"WholeStageCodegen (1)","metadata":{},"metrics":[{"metricName":"duration","value":2550}],"children":[{"nodeName":"HashAggregate","description":"HashAggregate(keys=[l_suppkey#614], functions=[partial_sum((l_extendedprice#617 * (1.0 - l_discount#618)))])","metadata":{},"metrics":[{"metricName":"spill size","value":0},{"metricName":"time in aggregation build","value":2506},{"metricName":"peak memory","value":75497472},{"metricName":"number of output rows","value":200000},{"metricName":"number of sort fallback tasks","value":0},{"metricName":"avg hash probes per key","value":12}],"children":[{"nodeName":"Project","description":"Project [l_suppkey#614, l_extendedprice#617, l_discount#618]","metadata":{},"metrics":[],"children":[{"nodeName":"Filter","description":"Filter ((l_shipdate#622 >= 1996-01-01) AND (l_shipdate#622 < 1996-04-01))","metadata":{},"metrics":[{"metricName":"number of output rows","value":7996656}],"children":[{"nodeName":"ColumnarToRow","description":"ColumnarToRow","metadata":{},"metrics":[{"metricName":"number of output rows","value":211794608},{"metricName":"number of input batches","value":2118}],"children":[{"nodeName":"InputAdapter","description":"InputAdapter","metadata":{},"metrics":[],"children":[{"nodeName":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)","description":"BatchScan ignition-sc(/data/tpch-vortex-s20.ignition)[l_suppkey#614, l_extendedprice#617, l_discount#618, l_shipdate#622] class org.ignition.spark.IgnitionScan RuntimeFilters: []","metadata":{},"metrics":[{"metricName":"number of output rows","value":211794608},{"metricName":"time spent in job init","value":14715692},{"metricName":"time spent in decode_batch","value":1834232393},{"metricName":"time spent loading native vectors","value":163220849}],"children":[]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}}]